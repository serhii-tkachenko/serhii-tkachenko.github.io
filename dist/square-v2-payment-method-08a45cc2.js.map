{"version":3,"file":"square-v2-payment-method-08a45cc2.js","mappings":"8IAEYA,ECFAC,EDEAD,E,gEEKG,MAAeE,UAAsBC,MAIhD,WAAAC,CAAYC,GCXD,IAAqCC,EDY5CC,MAAMF,GAAW,qCAJrB,KAAAG,KAAO,gBACP,KAAAC,KAAO,WCTyCH,aDcZA,UCbhCI,OAAOC,eACPD,OAAOC,eDYQC,KCZeN,GDYfM,KCVRC,UAAYP,EDYoB,mBAA5BH,MAAMW,kBACbX,MAAMW,kBAAkBF,iBAExBA,KAAKG,MAAQ,IAAIZ,MAAMS,KAAKP,SAASU,KAE7C,EEhBW,MAAMC,UAA4Bd,EAI7C,WAAAE,CAAYa,EAAiBT,EAAcH,GACvCE,MAAMF,GAPV,oFAGA,KAAAI,KAAO,gCAMHG,KAAKJ,KAAOA,EACZI,KAAKK,QAAUA,CACnB,ECdW,SAASC,EAASC,EAAUC,GACvC,GAAID,MAAAA,EACA,MAAMC,EAAeA,IAAiB,IAAIjB,MAAM,qCAGpD,OAAOgB,CACX,ELJYnB,EAAAA,IAAAA,EAAuB,KAC/B,EAAAqB,6BAAA,kCACA,IAAAC,uBAAA,4BACA,IAAAC,sBAAA,2BACA,IAAAC,uBAAA,4BACA,IAAAC,6BAAA,kCAQW,MAAMC,UAA4BxB,EAC7C,WAAAE,CAAmBa,GACfV,MAOR,SAAyBE,GACrB,OAAQA,GACJ,KAAKT,EAAwBsB,uBACzB,MAAO,oFAEX,KAAKtB,EAAwBuB,sBACzB,MAAO,mFAEX,KAAKvB,EAAwBwB,uBACzB,MAAO,oFAEX,KAAKxB,EAAwByB,6BACzB,MAAO,mFAEX,QACI,MAAO,6EAEnB,CAjBA,CAP8BR,IADP,KAAAA,QAAAA,EAGfL,KAAKJ,KAAO,sBACZI,KAAKH,KAAO,iBAChB,GCrBJ,SAAYR,GACR,EAAA0B,OAAA,SACA,EAAAC,MAAA,OACH,CAHD,CAAY3B,IAAAA,EAAY,K,0SKgCT,MAAM4B,EAKjB,WAAAzB,CACY0B,EACAC,GADA,KAAAD,cAAAA,EACA,KAAAC,2BAAAA,CACT,CAEG,UAAAC,EAAW,SACbC,EAAQ,cACRC,EAAa,WACbC,I,yCAEA,MAAMC,QAAexB,KAAKkB,cAAcO,KAAKJ,GAE7CrB,KAAK0B,UAAYF,EAAOG,SAASL,EAAeC,EACpD,G,CAEM,YAAAK,G,yCACE5B,KAAK6B,6BACL7B,KAAK6B,4BAA4BC,cAGjC9B,KAAK+B,cACC/B,KAAK+B,MAAMC,WAGrBhC,KAAK6B,iCAAAA,EACL7B,KAAK+B,WAAAA,EACL/B,KAAK0B,eAAAA,CACT,G,CAEM,cAAAO,EAAe,YACjBC,EAAW,MACXC,EAAK,mBACLC,I,yCAEA,MAAM,WAAEC,GAAerC,KAAKmB,2BAA2BmB,WAAWC,qBAAuB,CAAC,EAE1FvC,KAAK+B,YAAc/B,KAAKwC,eAAeC,aACjCzC,KAAK+B,MAAMW,OAAO,IAAIR,KAE5B,UACUlC,KAAK+B,MAAMY,UAAU,CAAEN,WAAAA,EAAYF,MAAAA,G,CAC3C,MAAOS,G,CAILR,IACApC,KAAK6B,4BAA8B7B,KAAK6C,2BACpC7C,KAAK+B,MACLK,GAGZ,G,CAEM,QAAAU,G,yCACF,MAAMC,QAAe/C,KAAKgD,WAAWF,WAErC,GAAsB,OAAlBC,EAAOE,SAAoBF,EAAOG,MAAO,CACzC,IAAIC,EAAe,oCAAoCJ,EAAOE,SAM9D,MAJIF,EAAOK,SACPD,GAAgB,gBAAgBE,KAAKC,UAAUP,EAAOK,WAGpD,IAAIhD,EACN,4BACA,4BACA+C,E,CAIR,OAAOJ,EAAOG,KAClB,G,CAEM,WAAAK,CAAYL,EAAeM,G,yCAC7B,OAAOA,IAAWnE,EAAa0B,OACzBf,KAAKyD,mBAAmBP,GACxBlD,KAAK0D,kBAAkBR,EACjC,G,CAEQ,YAAAV,GACJ,OAAOlC,EACHN,KAAK0B,WACL,IAAM,IAAIZ,EAAoB1B,EAAwBuB,wBAE9D,CAEQ,0BAAAkC,CACJJ,EACAkB,GAEA,MAAMC,EAAY,CAAC,aAAc,OAC3BC,EAAgB,IAAIC,IAAYF,GAChCG,EAAmB,CACrB,kBACA,oBACA,kBACA,oBACA,mBACA,qBACFC,KAAKC,IAAcC,EAAAA,EAAAA,GAAUzB,EAAMwB,KAErC,OAAOE,EAAAA,EAAAA,MAASJ,GACXK,MACGJ,EAAAA,EAAAA,IAAKK,IACD,MACIC,QAAQ,MACJC,EACAC,cAAc,kBAAEC,KAEpBJ,EAMJ,OAJIT,EAAUc,SAASH,IACnBV,EAAcY,EAAoB,SAAW,OAAOF,GAG1B,IAAvBV,EAAcc,SAEzBC,EAAAA,EAAAA,MAEHC,UAAUlB,EACnB,CAEQ,QAAAX,GACJ,OAAO1C,EACHN,KAAK+B,OACL,IAAM,IAAIjB,EAAoB1B,EAAwBuB,wBAE9D,CAEQ,0BAAAmE,EACJC,UAAWC,EACXC,SAAUC,EAAU,SACpBC,EAAQ,SACRC,EAAQ,KACRC,EACAC,oBAAqBC,EAAK,WAC1BlD,EAAU,YACVmD,EAAW,MACXC,EAAK,MACLC,IAEA,MAAO,CACHV,UAAAA,EACAE,WAAAA,EACAS,aAAc,CAACR,EAAUC,GACzBC,KAAAA,EACAE,MAAAA,EACAlD,WAAAA,EACAmD,YAAAA,EACAC,MAAAA,EACAC,MAAAA,EAER,CAEc,kBAAAjC,CAAmBP,G,yCAC7B,MAAM,mBAAE0C,EAAkB,yBAAEC,GACxB7F,KAAKmB,2BAA2BmB,YAC9B,mBAAEwD,EAAkB,KAAEC,GAASH,IAE/BI,EAAoC,CACtCC,OAAQH,EAAmBI,WAC3BC,eAAgBnG,KAAK8E,2BAA2Be,KAChDO,aAAcL,EAAKM,SAASC,KAC5B9C,OAAQnE,EAAa0B,QAGnBwF,QAAiBvG,KAAKwC,eAAee,YAAYL,EAAO8C,GAE9D,OAAOO,EAAWA,EAASrD,MAAQ,EACvC,G,CAEc,iBAAAQ,CAAkBR,G,yCAC5B,MAAM,yBAAE2C,GAA6B7F,KAAKmB,2BAA2BmB,WAE/D0D,EAAmC,CACrCG,eAAgBnG,KAAK8E,2BAA2Be,KAChDrC,OAAQnE,EAAa2B,OAGnBuF,QAAiBvG,KAAKwC,eAAee,YAAYL,EAAO8C,GAE9D,OAAOO,EAAWA,EAASrD,MAAQ,EACvC,G,ECpNW,MAAMsD,UAA6BlH,EAC9C,WAAAE,CAAYC,GACRE,MAAMF,GAAW,yCAEjBO,KAAKJ,KAAO,uBACZI,KAAKH,KAAO,kBAChB,ECTJ,MAAM4G,EAAmB,CACrBC,KAAM,CAAC,EACPC,QAAS,CAAC,EACV1D,OAAQ,GAOG,MAAM2D,UAAkCtH,EAMnD,WAAAE,CACI+G,GACA,QACI9G,EAAO,OACP2D,GAIA,CAAC,GAEL,MAAM,KAAEsD,EAAI,QAAEC,EAAO,OAAE1D,GAAWsD,GAAYE,EAE9C9G,MAAMF,GAAW,qCAEjBO,KAAKJ,KAAO,eACZI,KAAKH,KAAO,UACZG,KAAK0G,KAAOA,EACZ1G,KAAK2G,QAAUA,EACf3G,KAAKiD,OAASA,EACdjD,KAAKoD,OAASA,GAAU,EAC5B,EC/BW,MAAMyD,UAA2CD,EAC5D,WAAApH,CAAY+G,GACR5G,MAAM4G,EAAU,CACZ9G,QAAS,wEAGbO,KAAKJ,KAAO,4BACZI,KAAKH,KAAO,wBAChB,ECVW,MAAMiH,UAAoCN,EACrD,WAAAhH,CAAYqE,GACR,IAAIpE,EAAU,yEAEVoE,IACApE,EAAU,GAAGA,4DAAkEoE,EAAckD,KACzF,UAIRpH,MAAMF,GAENO,KAAKJ,KAAO,6BAChB,ECdW,MAAMoH,UAA0C1H,EAC3D,WAAAE,GACIG,MAAM,kEAENK,KAAKJ,KAAO,oCACZI,KAAKH,KAAO,iCAChB,E,ICPQoH,E,sSCmBG,MAAMC,EACjB,WAAA1H,CACY2B,EACAgG,GADA,KAAAhG,2BAAAA,EACA,KAAAgG,0BAAAA,CACT,CAEG,UAAA/F,CACFgG,G,+CAEA,KAAsB,QAAjB,EAAAA,MAAAA,OAAAA,EAAAA,EAASC,gBAAAA,IAAQ,WAAEnF,aACpB,MAAM,IAAIsE,EACN,qEAIR,MAAM,SAAEc,EAAQ,SAAED,GAAaD,GAE3BG,QAAQ,SAAElG,GAAU,mBACpBmG,GACAxH,KAAKmB,2BACJmB,WACAmF,wBAA+DH,IAC9D,cAAEhG,EAAa,WAAEC,GAAeiG,GAAsB,CAAC,EAE7D,IAAKlG,EACD,MAAM,IAAIuF,QAGR7G,KAAKmH,0BAA0B/F,WAAW,CAC5CE,cAAAA,EACAC,WAAAA,EACAF,SAAAA,UAEErB,KAAKmH,0BAA0BlF,eAAeoF,E,IAGlD,OAAAK,EAAQ,QAAEC,I,yCACZ,IAAKA,EACD,MAAM,IAAIb,EAA4B,CAAC,YAG3C,MAAM,SAAEQ,EAAQ,YAAEM,GAAgBD,GAC5B,qBAAEE,EAAoB,6BAAEC,GC5DR,iBAH1BC,EDgEQH,IC5DW,OAAfG,QAAAA,IACSA,EAAgCF,sBAC4B,kBAAzDE,EAAgCF,2BAAAA,IACnCE,EAAgCD,8BACoC,kBAAjEC,EAAgCD,6BD2DtC,CAAED,sBAAqB,EAAQC,8BAA6B,GAD5DF,ECnEC,IACXG,QDqEU/H,KAAKmB,2BAA2B6G,cAEtC,MAAMC,EACFL,GEnEG,SACXG,GAEA,OAAOG,QAASH,EAAiCI,aACrD,CAJe,CFmEgCP,SACvB5H,KAAKoI,6BAA6Bd,EAAUM,SAC5C5H,KAAKqI,gBAAgBf,EAAUO,SAEzC7H,KAAKmB,2BAA2BmH,cAAc,OAAD,wBAC5CX,GAAO,CACVC,YAAa,CACTW,iBAAkB,OAAF,wBACTN,GAAoB,CACvBO,yBAA0BX,IAAAA,EAC1BY,iCAAkCX,IAAAA,OAIlD,G,CAEA,QAAAY,GACI,OAAOC,QAAQC,OAAO,IAAI5B,EAC9B,CAEA,YAAApF,GACI,OAAO5B,KAAKmH,0BAA0BvF,cAC1C,CAEQ,YAAAiH,GACJ,MAAM,SAAEC,GAAa9I,KAAKmB,2BACrBmB,WACAyG,wBAAwBC,iBAE7B,OAAOF,EAAS,2CACpB,CAEc,eAAAT,CAAgBf,EAAkBO,G,yCAC5C,MAAM,wBAAEJ,GAA4BzH,KAAKmB,2BAA2BmB,YAC9D,mBAAEkF,GAAuBC,EAAkDH,GAE3E2B,QAA+BjJ,KAAKmH,0BAA0BrE,WAEpE,GACI0E,GAAsB,2BAA4BA,GAC3CA,EAAmB0B,wBACnBlJ,KAAK6I,eAEZ,MAAO,CACHM,kBAAmB,CACfjG,MAAO+F,IAKnB,IAAIG,EAAoC,CACpCC,MAAOJ,EACP/F,YAAalD,KAAKmH,0BAA0B5D,YACxC0F,EACA5J,EAAa0B,SAIrB,GAAI8G,EAAsB,CAGtB,MAAMyB,QAA2BtJ,KAAKmH,0BAA0BrE,WAEhEsG,EAAY,OAAH,wBACFA,GAAS,CACZG,iBAAkBD,EAClBE,uBAAwBxJ,KAAKmH,0BAA0B5D,YACnD+F,EACAjK,EAAa2B,Q,CAKzB,MAAO,CACHmI,kBAAmB,CACfjG,MAAOG,KAAKC,UAAU8F,IAGlC,G,CAEc,4BAAAhB,CACVd,EACAM,G,yCAEA,MAAM,wBAAEH,GAA4BzH,KAAKmB,2BAA2BmB,YAC9D,mBAAEkF,GAAuBC,EAAkDH,IAE3E,aAAEa,GAAiBP,EAKnB6B,GAHFjC,GAAsB,2BAA4BA,EAC5CA,EAAmB0B,uBACnBlJ,KAAK6I,sBAEH7I,KAAKmH,0BAA0B5D,kBAC3BvD,KAAK0J,wBAAwBpC,EAAUa,GAC7C9I,EAAa0B,aAAAA,EAIvB,MAAO,CACH4I,aAAc,OAAF,QACRzG,MAAOiF,GACHsB,GAAqB,CAAEG,eAAgB,CAAE1G,MAAOuG,KAGhE,G,CAEc,uBAAAC,CAAwBpC,EAAkBa,G,yCACpD,MAAM5C,QAAcvF,KAAKmB,2BAA2B0I,kBAAkBvC,EAAU,CAC5EwC,OAAQ,CAAEC,OAAQzC,EAAU0C,YAAa7B,MAGvC,mBAAEX,GACJjC,EAAMkC,wBAAkDH,IACtD,OAAE2C,GAAWzC,GAAsB,CAAC,EAE1C,IAAKyC,EACD,MAAM,IAAInD,EAA4B,CAAC,WAG3C,OAAOmD,CACX,G,EG9LW,MAAMC,UAA4C5K,EAC7D,WAAAE,CAAYC,GACRE,MACIF,GACI,uGAGRO,KAAKJ,KAAO,sCACZI,KAAKH,KAAO,mCAChB,GJVJ,SAAYoH,GACR,EAAAkD,KAAA,yCACA,EAAAC,QAAA,gDACH,CAHD,CAAYnD,IAAAA,EAAyB,KAKtB,MAAMoD,EACjB,WAAA7K,CAAoB0B,GAAA,KAAAA,cAAAA,CAA8B,CAE5C,IAAAO,CAAKJ,GAAAA,G,4BAOP,aANMrB,KAAKkB,cAAcoJ,WACrBjJ,EAAW4F,EAA0BmD,QAAUnD,EAA0BkD,MKHtE,WACX,IALJ,SAA0BI,GACtB,MAAO,WAAYA,CACvB,CAFA,CLU6BA,QKJrB,MAAM,IAAIL,CAElB,CAJe,GLQAK,OAAOC,MAClB,E,2RMTJ,MAYA,GCrBIC,EDUAC,GAEO,IAAIxD,EACPwD,EACA,IAAIzJ,EACA,IAAIoJ,GAAqBM,EAAAA,EAAAA,OACzBD,ICfRE,EDoB6D,CAAC,CAAEC,GAAI,aClB7D/K,OAAOgL,OAAOL,EAAQ,CAAEG,WAAAA,KAJpB,IACXH,EACAG,E,2GCqBJ,MA2IA,EA3I2D,EACvDG,kBACAC,gBACA9I,cACA+I,sBACAC,oBACAnB,a,MAEA,MAAOoB,EAAiBC,IAAsB,IAAAC,WAAS,IAChDC,EAAsBC,IAA2B,IAAAF,eAA6BG,IAE/E,YAAEC,EAAW,eAAEC,GAAmBV,EAAcW,KAEhDC,IAD0B,QAAb,EAAAH,WAAa,eAAEI,UACkB3D,QAAQ6B,EAAOxC,OAAOuE,oBAE1E,IAAAC,YAAU,KACFH,GACKb,EAAgBiB,oBAE1B,CAACjB,EAAiBa,IAErB,MAAMK,GAAc,IAAAC,UAAQ,IAAMR,EAAe3B,IAAW,IAAI,CAAC2B,EAAgB3B,IAC3EoC,EAA+BP,GAAgCK,EAAYG,OAAS,EACpFC,GAAgCF,GAAgChB,EAEhEmB,GAAyB,IAAAC,cAAY,KACvC,IAAIpB,GAIAc,EAAYG,OAAS,EAAG,CAIxB,OAFIH,EAAYO,MAAMzE,GAAeA,EAAW0E,qBAAsBR,EAAY,IAEzDjC,WAC7B,IACD,CAACiC,EAAad,KAEjB,IAAAY,YAAU,KACN,MAAMW,EAAsBJ,UAA4Bd,EAExDD,EAAwBmB,KACzB,CAACJ,EAAwBL,IAE5B,MAAM,cAAEU,IAAkB,SAAwBC,aAqD5C,qBAAEC,GAAyB7B,EAAc8B,SAE/C,OACI,gBAACC,EAAA,EAAc,aACD,2BACVC,wBAAsB,EACtBC,UAAWJ,KAEX,uBAAKK,UAAU,yBACVf,GACG,gBAACgB,EAAA,E,CAEGlB,YAAaA,EACbmB,mBA3DkCvC,IACvB,IAAvBoB,EAAYG,QACZhB,GAAmB,GACnBG,OAAwBC,GAExBmB,EAAc,eAAgB,KACvBrB,IAAyBT,IAChCU,EAAwBe,KAExBK,EAAc,eAAgBL,OAmDlBe,mBAjEkCxC,IAClDO,GAAmB,GACnBG,EAAwBV,IAgERyC,mBAhDiB,KACjClC,GAAmB,GACnBG,OAAwBC,GAEnBP,IAEAC,KA2CWI,qBAAsBA,GAAwBgB,MAGtD,uBACIY,UAAW,IAAW,SAAU,WAAWnD,EAAOc,KAAM,kBAAiB,YAC9D3I,EACXC,MAAO,CACHoL,QAAUlB,OAAwCb,EAAT,QAE7CgC,UAAW,GA/CnB,mCAAe,4BAA4BrL,MAAO,CAAEoL,QAAS,SACzD,uBAAKL,UAAU,cACX,uBACIA,UAAU,0CACVrC,GAAG,qBAEP,uBAAKqC,UAAU,0CAA0CrC,GAAG,oBAEhE,uBAAKqC,UAAU,cACX,uBACIA,UAAU,gGACVrC,GAAG,kBAGX,uBAAKqC,UAAU,gCACX,uBAAKA,UAAU,qBAAqBrC,GAAG,mBACvC,uBAAKqC,UAAU,0CAA0CrC,GAAG,mBAkC5D,uBAAKA,GAAI3I,KAGZ0J,GACG,gBAAC6B,EAAA,EAAuB,CACpBtF,aAAcmD,EACdW,YAAaA,OCcrC,GAAe,EAAAyB,EAAA,IA7JsD,EACjE3D,SACAgB,kBACAC,oBAEA,MAAM2C,EAAuB,CAAC9C,EAAY+C,KACtC,MAAMC,EAAYC,SAASC,cAA8B,IAAIlD,KAE7D,IAAKgD,EACD,MAAM,IAAItO,MACN,iEAAiEsL,oBAIzE,OAAO,EAAAmD,EAAA,GAAiBH,EAAWD,IAGjCK,GAAgC,IAAA1B,cAAY,KAC9C,MAAM2B,EAAa,CACf,kBACA,cACA,eACA,cACA,QACA,WACA,cAGJ,MAAO,CACHC,QAAS,CACL1O,QAASkO,EAAqB,mBAAoB,CAAC,UACnDS,MAAOT,EAAqB,iBAAkBO,IAElDG,MAAO,CACHD,MAAOT,EACH,gBACA,IAAAW,YAAWJ,EAAY,CAAC,mBAGhCK,MAAO,CACH9O,QAASkO,EAAqB,iBAAkB,CAAC,UACjDS,MAAOT,EAAqB,eAAgB,CACxC,cACA,cACA,cAIb,IAEGa,GAAoB,IAAAjC,cACrBkC,IACG,MAAM,EAAuDA,EAAON,QAAQC,OAAtE,YAAEM,EAAW,aAAEC,EAAY,YAAEC,GAAW,EAAKR,GAAK,cAAlD,8CACA,EAIFK,EAAOJ,MAAMD,OAHbM,YAAaG,EACbD,YAAaE,GAAkB,EAC5BC,GAAY,cAHb,gCAMFL,YAAaM,EACbJ,YAAaK,EACbC,MAAOC,GACPV,EAAOF,MAAMH,MAEjB,MAAO,CACHA,QACA,iBAAkB,OAAF,UACTW,GAEP,iBAAkB,CACdG,MAAOC,GAEX,mBAAoB,CAChBT,cACAC,eACAC,eAEJ,4BAA6B,CACzBF,YAAaG,EACbD,YAAaE,GAEjB,4BAA6B,CACzBJ,YAAaM,EACbJ,YAAaK,GAEjB,gBAAiB,CACbC,MAAOT,EAAON,QAAQ1O,QAAQyP,OAElC,gBAAiB,CACbA,MAAOT,EAAON,QAAQ1O,QAAQyP,OAElC,yBAA0B,CACtBA,MAAOT,EAAOF,MAAM9O,QAAQyP,OAEhC,yBAA0B,CACtBA,MAAOT,EAAOF,MAAM9O,QAAQyP,UAIxC,IAGEhN,EAAc,qCAEdgJ,GAAoB,IAAAqB,cAAY,KAAY,iDAC9C,IAAIpK,EAEJ,IACIA,EAAQqM,EAAkBP,IAC9B,CAAE,SAEF,OAEMlD,EAAgBG,kBAAkB,CACpCkE,UAAWrF,EAAOsF,QAClB/H,SAAUyC,EAAOc,GACjByE,aAAc,CAAC,GACfjI,SAAU,CACNnF,cACAC,UAGZ,KAAG,CACC4I,EACAkD,EACAO,EACAzE,EAAOsF,QACPtF,EAAOc,KAGLI,GAAsB,IAAAsB,cAAY,KAAY,uDAC1CxB,EAAgBE,oBAAoB,CACtCmE,UAAWrF,EAAOsF,QAClB/H,SAAUyC,EAAOc,IAEzB,KAAG,CAACE,EAAiBhB,EAAOsF,QAAStF,EAAOc,KAU5C,OARA,IAAAkB,YAAU,KACDb,IAEE,KACED,OAEV,CAACA,EAAqBC,IAGrB,gBAAC,EAAY,CACTH,gBAAiBA,EACjBC,cAAeA,EACf9I,YAAaA,EACb+I,oBAAqBA,EACrBC,kBAAmBA,EACnBnB,OAAQA,MAOhB,CAAC,CAAEc,GAAI,a,kBC5KI,SAAS0E,EAA0B1P,GAC9C,OAAQA,GACJ,IAAK,OACL,IAAK,mBACD,MAAO,mBAEX,IAAK,SACL,IAAK,cACD,MAAO,cAEX,QACI,OAAOA,EAEnB,C,uNCoBA,MAAM2P,EAAiE,EACnEtC,YACAnF,aACA0H,SACAC,wBAAuB,EACvBC,c,MAEA,MAAMC,GAAW,EAAAL,EAAA,GAA0BxH,EAAW8H,OAChDC,EAAW,gBAA2BF,GACtCG,IAAa,IAAAC,gBAAe,CAC9BC,MAAOlI,EAAWmI,YAClBC,KAAMpI,EAAWqI,aAClBC,QAEH,OACI,0BAAQnD,UAAWA,EAAS,YAAauC,EAAQE,QAASA,EAAS9P,KAAK,UACpE,uBACIqN,UAAW,IAAW,2BAA4B,CAC9C,oCAAqC6C,KAGzC,gBAACO,EAAA,EAAc,CAACV,SAAUA,IAE1B,uBAAK1C,UAAU,wBAAuB,YAAY,GAAGuC,QAAAA,EAAU,YAC1DK,EACG,gBAACS,EAAA,EAAgB,CACb5E,KAAM,CACF6E,UAA4B,QAAjB,EAAAV,EAASW,gBAAQ,QAAI,GAChCC,SAAU3I,EAAW4I,OAEzB9F,GAAG,sCAGP,gBAAC0F,EAAA,EAAgB,CACb5E,KAAM,CAAE+E,SAAU3I,EAAW4I,OAC7B9F,GAAG,gDAKb6E,GACE,uBACIxC,UAAW,IAAW,0BAA2B,CAC7C,mCAAoC6C,IACtC,YACS,GAAGN,GAAU,aAEvBM,EACG,gBAACQ,EAAA,EAAgB,CACb5E,KAAM,CACFiF,WAAY,GAAG7I,EAAWmI,eAAenI,EAAWqI,cAExDvF,GAAG,oCAGP,gBAAC0F,EAAA,EAAgB,CACb5E,KAAM,CACFiF,WAAY,GAAG7I,EAAWmI,eAAenI,EAAWqI,cAExDvF,GAAG,wCAiB7BgG,EAA6D,EAC/D9I,aACA2H,wBAAuB,EACvBC,UAAU,EAAAmB,SAEV,MAAMC,GAAc,IAAAxE,cAAY,KAC5BoD,EAAQ5H,EAAWiC,eACpB,CAAC2F,EAAS5H,IAEb,OACI,gBAACyH,EAAkB,CACfzH,WAAYA,EACZ4H,QAASoB,EACTrB,qBAAsBA,EACtBD,OAAO,8BAWbuB,EAAyE,EAC3E9D,YACAuC,SACAE,UAAU,EAAAmB,QAEV,0BAAQ5D,UAAWA,EAAS,YAAauC,EAAQE,QAASA,EAAS9P,KAAK,UACpE,uBAAKqN,UAAU,6DACX,gBAACoD,EAAA,EAAc,MAEf,uBAAKpD,UAAU,yBACX,gBAACqD,EAAA,EAAgB,CAAC1F,GAAG,0CAc/BoG,EAAyD,EAC3DhF,cACAX,uBACAoE,wBAAuB,EACvBrC,qBACAC,wBAGI,sBACIJ,UAAU,gFAA+E,YAC/E,0BAETjB,EAAYjI,KAAK+D,GACd,sBACImF,UAAW,IAAW,6CAA8C,CAChE,oCACInF,EAAWiC,cAAgBsB,IAEnC4F,IAAKnJ,EAAWiC,aAEhB,gBAAC6G,EAAgB,CACb9I,WAAYA,EACZ4H,QAAStC,EACTqC,qBAAsBA,EACtBD,OAAO,gCAKnB,sBAAIvC,UAAU,8EACV,gBAAC8D,EAAsB,CACnBrB,QAASrC,EACTmC,OAAO,uCAcrB0B,EAAyE,EAC3EpJ,aACA2H,wBAAuB,EACvBD,SACAE,aAEK5H,EAUD,gBAACyH,EAAkB,CACftC,UAAU,mFACVnF,WAAYA,EACZ4H,QAASA,EACTD,qBAAsBA,EACtBD,OAAQA,IAbR,gBAACuB,EAAsB,CACnB9D,UAAU,mFACVuC,OAAQA,IAsFxB,EAtEmE,EAC/DlL,QACA6M,OACAnF,cACAoB,qBACAC,qBACAhC,uBACAoE,wBAAuB,MAEvB,MAAM2B,GAA8B,IAAAC,QAAOhG,GAErCiG,GAAmB,IAAAhF,cACrB,CAACpE,EAAe,MACPiJ,EAAKzE,cAAcpI,EAAM3E,KAAMuI,KAExC,CAACiJ,EAAM7M,EAAM3E,QAGjB,IAAAmM,YAAU,KAINyF,YAAW,IAAMD,EAAiBjG,KAE3B,KACiB,KAAhB/G,EAAMhE,YAAyCiL,IAAzBF,GACtBiG,OAIT,KAEH,IAAAxF,YAAU,KACFsF,EAA4BI,UAAYnG,GAIxCkG,YAAW,IAAMD,EAAiBjG,KAGtC+F,EAA4BI,QAAUnG,IACvC,CAACA,EAAsBiG,IAE1B,MAAMG,GAAqB,IAAAlF,MAAKP,EAAa,CAAEjC,YAAasB,IAE5D,OACI,uBAAK4B,UAAU,oBACX,gBAACyE,EAAA,EAAe,CACZC,SACI,gBAACX,EAAc,CACXhF,YAAaA,EACboB,mBAAoBA,EACpBC,mBAAoBA,EACpBhC,qBAAsBA,EACtBoE,qBAAsBA,KAI9B,gBAACyB,EAAsB,CACnBpJ,WAAY2J,EACZhC,qBAAsBA,EACtBD,OAAO,sBAGX,uCAAO5P,KAAK,UAAa0E,O,cC5QzC,MAkEA,GAAe,IAAAsN,OAlEgE,EAC3E5F,cACAmB,qBACAC,qBACAC,qBACAhC,uBACAoE,wBAAuB,EACvBoC,qBAAqB,SAErB,MAAMC,GAAc,IAAAxF,cACfhI,GACG,gBAAC,EAAgB,iBACTA,EAAK,CACT0H,YAAaA,EACboB,mBAAoBA,EACpBC,mBAAoBA,EACpBhC,qBAAsBA,EACtBoE,qBAAsBA,MAG9B,CACIzD,EACAoB,EACAC,EACAhC,EACAoE,IAIFsC,GAAc,IAAAzF,cACf0F,GACG,gBAACC,EAAA,EAAsB,eACnBjG,YAAaA,EACbmB,mBAAoBA,GAChB6E,KAGZ,CAAChG,EAAamB,IAGlB,OACI,gBAAC+E,EAAA,EAAQ,CACLC,oBAAoB,qBACpBC,OACI,gBAACC,EAAA,EAAM,CAACC,QAAM,GACV,gBAAChC,EAAA,EAAgB,CAAC1F,GAAG,8BAI7B,gBAAC2H,EAAA,EAAY,CAACC,MAAOT,IAChB,EAAGrC,aACA,0BAAQzC,UAAU,0BAA0ByC,QAASA,EAAS9P,KAAK,UAC/D,gBAAC0Q,EAAA,EAAgB,CAAC1F,GAAG,wCAKjC,gBAAC6H,EAAA,EAAc,CAAC9S,KAAK,eAAe+S,OAAQZ,IAE5C,uBAAK5P,MAAO,CAAEoL,QAASjC,OAAuBE,EAAY,SACrDsG,M","sources":["webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/errors/not-initialized-error.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/squarev2-integration/src/enums.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/errors/standard-error.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/errors/set-prototype-of.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/errors/payment-execute-error.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/util-types/guard.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/squarev2-integration/src/squarev2-payment-processor.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/errors/invalid-argument-error.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/errors/request-error.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/errors/payment-method-invalid-error.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/errors/payment-argument-invalid-error.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/errors/order-finalization-not-required-error.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/squarev2-integration/src/squarev2-script-loader.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/squarev2-integration/src/squarev2-payment-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/payment/is-hosted-intrument-like.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/payment/is-vaulted-instrument.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/errors/payment-method-client-unavailable-error.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/squarev2-integration/src/is-squarev2-window.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/squarev2-integration/src/create-squarev2-payment-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/to-resolvable-module.ts","webpack://checkout/./packages/squarev2-integration/src/SquareV2Form.tsx","webpack://checkout/./packages/squarev2-integration/src/SquareV2PaymentMethod.tsx","webpack://checkout/./packages/instrument-utils/src/storedInstrument/mapFromInstrumentCardType/mapFromInstrumentCardType.ts","webpack://checkout/./packages/instrument-utils/src/storedInstrument/InstrumentSelect/InstrumentSelect.tsx","webpack://checkout/./packages/instrument-utils/src/storedInstrument/CardInstrumentFieldset/CardInstrumentFieldset.tsx"],"sourcesContent":["import StandardError from './standard-error';\n\nexport enum NotInitializedErrorType {\n    CheckoutButtonNotInitialized,\n    CustomerNotInitialized,\n    PaymentNotInitialized,\n    ShippingNotInitialized,\n    SpamProtectionNotInitialized,\n}\n\n/**\n * Throw this error if a method requires a certain initialization call to be\n * made first. Some objects can be constructed but they cannot be used until a\n * separate initialization call is made.\n */\nexport default class NotInitializedError extends StandardError {\n    constructor(public subtype: NotInitializedErrorType) {\n        super(getErrorMessage(subtype));\n\n        this.name = 'NotInitializedError';\n        this.type = 'not_initialized';\n    }\n}\n\nfunction getErrorMessage(type: NotInitializedErrorType): string {\n    switch (type) {\n        case NotInitializedErrorType.CustomerNotInitialized:\n            return 'Unable to proceed because the customer step of checkout has not been initialized.';\n\n        case NotInitializedErrorType.PaymentNotInitialized:\n            return 'Unable to proceed because the payment step of checkout has not been initialized.';\n\n        case NotInitializedErrorType.ShippingNotInitialized:\n            return 'Unable to proceed because the shipping step of checkout has not been initialized.';\n\n        case NotInitializedErrorType.SpamProtectionNotInitialized:\n            return 'Unable to proceed because the checkout spam protection has not been initialized.';\n\n        default:\n            return 'Unable to proceed because the required component has not been initialized.';\n    }\n}\n","export enum SquareIntent {\n    CHARGE = 'CHARGE',\n    STORE = 'STORE',\n}\n","import CustomError from './custom-error';\nimport setPrototypeOf from './set-prototype-of';\n\n/**\n * This error type should not be constructed directly. It is a base class for\n * all custom errors thrown in this library.\n */\nexport default abstract class StandardError extends Error implements CustomError {\n    name = 'StandardError';\n    type = 'standard';\n\n    constructor(message?: string) {\n        super(message || 'An unexpected error has occurred.');\n\n        setPrototypeOf(this, new.target.prototype);\n\n        if (typeof Error.captureStackTrace === 'function') {\n            Error.captureStackTrace(this, new.target);\n        } else {\n            this.stack = new Error(this.message).stack;\n        }\n    }\n}\n","export default function setPrototypeOf(object: any, prototype: object) {\n    if (Object.setPrototypeOf) {\n        Object.setPrototypeOf(object, prototype);\n    } else {\n        object.__proto__ = prototype;\n    }\n\n    return object;\n}\n","import StandardError from './standard-error';\n\nconst defaultMessage =\n    'Payment cannot be processed for this order, please select another payment method';\n\nexport default class PaymentExecuteError extends StandardError {\n    type = 'custom_provider_execute_error';\n    subtype: string;\n\n    constructor(subtype: string, name: string, message?: string) {\n        super(message || defaultMessage);\n\n        this.name = name;\n        this.subtype = subtype;\n    }\n}\n","export default function guard<T>(value: T, errorFactory?: () => Error): NonNullable<T> {\n    if (value === undefined || value === null) {\n        throw errorFactory ? errorFactory() : new Error('An unexpected error has occurred.');\n    }\n\n    return value as NonNullable<T>;\n}\n","import { fromEvent, merge, Subscription } from 'rxjs';\nimport { distinctUntilChanged, map } from 'rxjs/operators';\n\nimport {\n    BillingAddress,\n    guard,\n    NotInitializedError,\n    NotInitializedErrorType,\n    PaymentExecuteError,\n    PaymentIntegrationService,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport { SquareIntent } from './enums';\nimport SquareV2PaymentInitializeOptions from './squarev2-payment-initialize-options';\nimport SquareV2ScriptLoader from './squarev2-script-loader';\nimport {\n    BillingContact,\n    Card,\n    CardInputEvent,\n    CardInputEventTypes,\n    ChargeVerifyBuyerDetails,\n    Payments,\n    SqEvent,\n    StoreVerifyBuyerDetails,\n} from './types';\n\nexport interface SquareV2PaymentProcessorOptions {\n    applicationId: string;\n    locationId?: string;\n    testMode?: boolean;\n}\n\nexport default class SquareV2PaymentProcessor {\n    private _payments?: Payments;\n    private _card?: Card;\n    private _formValidationSubscription?: Subscription;\n\n    constructor(\n        private _scriptLoader: SquareV2ScriptLoader,\n        private _paymentIntegrationService: PaymentIntegrationService,\n    ) {}\n\n    async initialize({\n        testMode,\n        applicationId,\n        locationId,\n    }: SquareV2PaymentProcessorOptions): Promise<void> {\n        const square = await this._scriptLoader.load(testMode);\n\n        this._payments = square.payments(applicationId, locationId);\n    }\n\n    async deinitialize(): Promise<void> {\n        if (this._formValidationSubscription) {\n            this._formValidationSubscription.unsubscribe();\n        }\n\n        if (this._card) {\n            await this._card.destroy();\n        }\n\n        this._formValidationSubscription = undefined;\n        this._card = undefined;\n        this._payments = undefined;\n    }\n\n    async initializeCard({\n        containerId,\n        style,\n        onValidationChange,\n    }: SquareV2PaymentInitializeOptions): Promise<void> {\n        const { postalCode } = this._paymentIntegrationService.getState().getBillingAddress() || {};\n\n        this._card = await this._getPayments().card();\n        await this._card.attach(`#${containerId}`);\n\n        try {\n            await this._card.configure({ postalCode, style });\n        } catch (_error) {\n            /* Do nothing: we should not block shoppers from buying. */\n        }\n\n        if (onValidationChange) {\n            this._formValidationSubscription = this._subscribeToFormValidation(\n                this._card,\n                onValidationChange,\n            );\n        }\n    }\n\n    async tokenize(): Promise<string> {\n        const result = await this._getCard().tokenize();\n\n        if (result.status !== 'OK' || !result.token) {\n            let errorMessage = `Tokenization failed with status: ${result.status}`;\n\n            if (result.errors) {\n                errorMessage += ` and errors: ${JSON.stringify(result.errors)}`;\n            }\n\n            throw new PaymentExecuteError(\n                'payment.errors.card_error',\n                'SquareV2TokenizationError',\n                errorMessage,\n            );\n        }\n\n        return result.token;\n    }\n\n    async verifyBuyer(token: string, intent: SquareIntent): Promise<string> {\n        return intent === SquareIntent.CHARGE\n            ? this._chargeVerifyBuyer(token)\n            : this._storeVerifyBuyer(token);\n    }\n\n    private _getPayments(): Payments {\n        return guard(\n            this._payments,\n            () => new NotInitializedError(NotInitializedErrorType.PaymentNotInitialized),\n        );\n    }\n\n    private _subscribeToFormValidation(\n        card: Card,\n        observer: Required<SquareV2PaymentInitializeOptions>['onValidationChange'],\n    ): Subscription {\n        const blacklist = ['cardNumber', 'cvv'];\n        const invalidFields = new Set<string>(blacklist);\n        const eventObservables = [\n            'focusClassAdded',\n            'focusClassRemoved',\n            'errorClassAdded',\n            'errorClassRemoved',\n            'cardBrandChanged',\n            'postalCodeChanged',\n        ].map((eventType) => fromEvent(card, eventType as CardInputEventTypes));\n\n        return merge(...eventObservables)\n            .pipe(\n                map((event: SqEvent<CardInputEvent>): boolean => {\n                    const {\n                        detail: {\n                            field,\n                            currentState: { isCompletelyValid },\n                        },\n                    } = event;\n\n                    if (blacklist.includes(field)) {\n                        invalidFields[isCompletelyValid ? 'delete' : 'add'](field);\n                    }\n\n                    return invalidFields.size === 0;\n                }),\n                distinctUntilChanged(),\n            )\n            .subscribe(observer);\n    }\n\n    private _getCard(): Card {\n        return guard(\n            this._card,\n            () => new NotInitializedError(NotInitializedErrorType.PaymentNotInitialized),\n        );\n    }\n\n    private _mapToSquareBillingContact({\n        firstName: givenName,\n        lastName: familyName,\n        address1,\n        address2,\n        city,\n        stateOrProvinceCode: state,\n        postalCode,\n        countryCode,\n        email,\n        phone,\n    }: BillingAddress): BillingContact {\n        return {\n            givenName,\n            familyName,\n            addressLines: [address1, address2],\n            city,\n            state,\n            postalCode,\n            countryCode,\n            email,\n            phone,\n        };\n    }\n\n    private async _chargeVerifyBuyer(token: string): Promise<string> {\n        const { getCheckoutOrThrow, getBillingAddressOrThrow } =\n            this._paymentIntegrationService.getState();\n        const { outstandingBalance, cart } = getCheckoutOrThrow();\n\n        const details: ChargeVerifyBuyerDetails = {\n            amount: outstandingBalance.toString(),\n            billingContact: this._mapToSquareBillingContact(getBillingAddressOrThrow()),\n            currencyCode: cart.currency.code,\n            intent: SquareIntent.CHARGE,\n        };\n\n        const response = await this._getPayments().verifyBuyer(token, details);\n\n        return response ? response.token : '';\n    }\n\n    private async _storeVerifyBuyer(token: string): Promise<string> {\n        const { getBillingAddressOrThrow } = this._paymentIntegrationService.getState();\n\n        const details: StoreVerifyBuyerDetails = {\n            billingContact: this._mapToSquareBillingContact(getBillingAddressOrThrow()),\n            intent: SquareIntent.STORE,\n        };\n\n        const response = await this._getPayments().verifyBuyer(token, details);\n\n        return response ? response.token : '';\n    }\n}\n","import StandardError from './standard-error';\n\n/**\n * This error should be thrown when a method is unable to proceed because the\n * caller has not provided all the arguments according to their requirements,\n * i.e.: if an argument is missing or it is not the expected data type.\n */\nexport default class InvalidArgumentError extends StandardError {\n    constructor(message?: string) {\n        super(message || 'Invalid arguments have been provided.');\n\n        this.name = 'InvalidArgumentError';\n        this.type = 'invalid_argument';\n    }\n}\n","import { Response } from '@bigcommerce/request-sender';\n\nimport StandardError from './standard-error';\n\nconst DEFAULT_RESPONSE = {\n    body: {},\n    headers: {},\n    status: 0,\n};\n\n/**\n * Throw this error if we are unable to make a request to the server. It wraps\n * any server response into a JS error object.\n */\nexport default class RequestError<TBody = any> extends StandardError {\n    body: TBody | {};\n    headers: { [key: string]: any };\n    errors: Array<{ code: string; message?: string }>;\n    status: number;\n\n    constructor(\n        response?: Response<TBody | {}>,\n        {\n            message,\n            errors,\n        }: {\n            message?: string;\n            errors?: Array<{ code: string; message?: string }>;\n        } = {},\n    ) {\n        const { body, headers, status } = response || DEFAULT_RESPONSE;\n\n        super(message || 'An unexpected error has occurred.');\n\n        this.name = 'RequestError';\n        this.type = 'request';\n        this.body = body;\n        this.headers = headers;\n        this.status = status;\n        this.errors = errors || [];\n    }\n}\n","import { Response } from '@bigcommerce/request-sender';\n\nimport RequestError from './request-error';\n\n/**\n * Throw this error if we are unable to successfully submit a server request\n * using a payment method because the method has invalid configuration or is in\n * an invalid state.\n */\nexport default class PaymentMethodInvalidError<T = any> extends RequestError<T> {\n    constructor(response?: Response<T>) {\n        super(response, {\n            message: 'There is a problem processing your payment. Please try again later.',\n        });\n\n        this.name = 'PaymentMethodInvalidError';\n        this.type = 'payment_method_invalid';\n    }\n}\n","import InvalidArgumentError from './invalid-argument-error';\n\n/**\n * This error should be thrown when we are unable to submit a payment because\n * the caller has not provided all the required fields, i.e.: if an argument is\n * missing or it is not the expected data type.\n */\nexport default class PaymentArgumentInvalidError extends InvalidArgumentError {\n    constructor(invalidFields?: string[]) {\n        let message = 'Unable to submit payment for the order because the payload is invalid.';\n\n        if (invalidFields) {\n            message = `${message} Make sure the following fields are provided correctly: ${invalidFields.join(\n                ', ',\n            )}.`;\n        }\n\n        super(message);\n\n        this.name = 'PaymentArgumentInvalidError';\n    }\n}\n","import StandardError from './standard-error';\n\n/**\n * Throw this error if we are trying to make an order finalization request for a\n * payment method that does not require such procedure.\n */\nexport default class OrderFinalizationNotRequiredError extends StandardError {\n    constructor() {\n        super('The current order does not need to be finalized at this stage.');\n\n        this.name = 'OrderFinalizationNotRequiredError';\n        this.type = 'order_finalization_not_required';\n    }\n}\n","import { ScriptLoader } from '@bigcommerce/script-loader';\n\nimport assertSquareV2Window from './is-squarev2-window';\nimport { Square } from './types';\n\nexport enum SquareV2WebPaymentsSdkEnv {\n    LIVE = 'https://web.squarecdn.com/v1/square.js',\n    SANDBOX = 'https://sandbox.web.squarecdn.com/v1/square.js',\n}\n\nexport default class SquareV2ScriptLoader {\n    constructor(private _scriptLoader: ScriptLoader) {}\n\n    async load(testMode = false): Promise<Square> {\n        await this._scriptLoader.loadScript(\n            testMode ? SquareV2WebPaymentsSdkEnv.SANDBOX : SquareV2WebPaymentsSdkEnv.LIVE,\n        );\n\n        assertSquareV2Window(window);\n\n        return window.Square;\n    }\n}\n","import {\n    InvalidArgumentError,\n    isHostedInstrumentLike,\n    isVaultedInstrument,\n    OrderFinalizationNotRequiredError,\n    OrderRequestBody,\n    PaymentArgumentInvalidError,\n    PaymentInitializeOptions,\n    PaymentIntegrationService,\n    PaymentMethodInvalidError,\n    PaymentStrategy,\n    VaultedInstrument,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport { SquareIntent } from './enums';\nimport { WithSquareV2PaymentInitializeOptions } from './squarev2-payment-initialize-options';\nimport SquareV2PaymentProcessor from './squarev2-payment-processor';\nimport {\n    SquareCreditCardTokens,\n    SquareFormattedVaultedInstrument,\n    SquareInitializationData,\n    SquarePaymentMethodInitializationData,\n} from './types';\n\nexport default class SquareV2PaymentStrategy implements PaymentStrategy {\n    constructor(\n        private _paymentIntegrationService: PaymentIntegrationService,\n        private _squareV2PaymentProcessor: SquareV2PaymentProcessor,\n    ) {}\n\n    async initialize(\n        options?: PaymentInitializeOptions & WithSquareV2PaymentInitializeOptions,\n    ): Promise<void> {\n        if (!options?.squarev2?.containerId) {\n            throw new InvalidArgumentError(\n                'Unable to proceed because \"containerId\" argument is not provided.',\n            );\n        }\n\n        const { methodId, squarev2 } = options;\n        const {\n            config: { testMode },\n            initializationData,\n        } = this._paymentIntegrationService\n            .getState()\n            .getPaymentMethodOrThrow<SquarePaymentMethodInitializationData>(methodId);\n        const { applicationId, locationId } = initializationData || {};\n\n        if (!applicationId) {\n            throw new PaymentMethodInvalidError();\n        }\n\n        await this._squareV2PaymentProcessor.initialize({\n            applicationId,\n            locationId,\n            testMode,\n        });\n        await this._squareV2PaymentProcessor.initializeCard(squarev2);\n    }\n\n    async execute({ payment }: OrderRequestBody): Promise<void> {\n        if (!payment) {\n            throw new PaymentArgumentInvalidError(['payment']);\n        }\n\n        const { methodId, paymentData } = payment;\n        const { shouldSaveInstrument, shouldSetAsDefaultInstrument } = isHostedInstrumentLike(\n            paymentData,\n        )\n            ? paymentData\n            : { shouldSaveInstrument: false, shouldSetAsDefaultInstrument: false };\n\n        await this._paymentIntegrationService.submitOrder();\n\n        const submitPaymentPayload =\n            paymentData && isVaultedInstrument(paymentData)\n                ? await this._getVaultedInstrumentPayload(methodId, paymentData)\n                : await this._getCardPayload(methodId, shouldSaveInstrument);\n\n        await this._paymentIntegrationService.submitPayment({\n            ...payment,\n            paymentData: {\n                formattedPayload: {\n                    ...submitPaymentPayload,\n                    vault_payment_instrument: shouldSaveInstrument || false,\n                    set_as_default_stored_instrument: shouldSetAsDefaultInstrument || false,\n                },\n            },\n        });\n    }\n\n    finalize(): Promise<void> {\n        return Promise.reject(new OrderFinalizationNotRequiredError());\n    }\n\n    deinitialize(): Promise<void> {\n        return this._squareV2PaymentProcessor.deinitialize();\n    }\n\n    private shouldVerify(): boolean {\n        const { features } = this._paymentIntegrationService\n            .getState()\n            .getStoreConfigOrThrow().checkoutSettings;\n\n        return features['PROJECT-3828.add_3ds_support_on_squarev2'];\n    }\n\n    private async _getCardPayload(methodId: string, shouldSaveInstrument?: boolean) {\n        const { getPaymentMethodOrThrow } = this._paymentIntegrationService.getState();\n        const { initializationData } = getPaymentMethodOrThrow<SquareInitializationData>(methodId);\n\n        const cardTokenizationResult = await this._squareV2PaymentProcessor.tokenize();\n\n        if (\n            initializationData && 'isSquareV2ApiV2Enabled' in initializationData\n                ? !initializationData.isSquareV2ApiV2Enabled\n                : !this.shouldVerify()\n        ) {\n            return {\n                credit_card_token: {\n                    token: cardTokenizationResult,\n                },\n            };\n        }\n\n        let tokenData: SquareCreditCardTokens = {\n            nonce: cardTokenizationResult,\n            token: await this._squareV2PaymentProcessor.verifyBuyer(\n                cardTokenizationResult,\n                SquareIntent.CHARGE,\n            ),\n        };\n\n        if (shouldSaveInstrument) {\n            // INFO: additional 'tokenize' is required to verify and save the card\n            // for each 'verifyBuyer' we need to generate new token\n            const tokenForSavingCard = await this._squareV2PaymentProcessor.tokenize();\n\n            tokenData = {\n                ...tokenData,\n                store_card_nonce: tokenForSavingCard,\n                store_card_token: await this._squareV2PaymentProcessor.verifyBuyer(\n                    tokenForSavingCard,\n                    SquareIntent.STORE,\n                ),\n            };\n        }\n\n        return {\n            credit_card_token: {\n                token: JSON.stringify(tokenData),\n            },\n        };\n    }\n\n    private async _getVaultedInstrumentPayload(\n        methodId: string,\n        paymentData: VaultedInstrument,\n    ): Promise<SquareFormattedVaultedInstrument> {\n        const { getPaymentMethodOrThrow } = this._paymentIntegrationService.getState();\n        const { initializationData } = getPaymentMethodOrThrow<SquareInitializationData>(methodId);\n\n        const { instrumentId } = paymentData;\n        const shouldVerify =\n            initializationData && 'isSquareV2ApiV2Enabled' in initializationData\n                ? initializationData.isSquareV2ApiV2Enabled\n                : this.shouldVerify();\n        const verificationToken = shouldVerify\n            ? await this._squareV2PaymentProcessor.verifyBuyer(\n                  await this._getSquareCardIdOrThrow(methodId, instrumentId),\n                  SquareIntent.CHARGE,\n              )\n            : undefined;\n\n        return {\n            bigpay_token: {\n                token: instrumentId,\n                ...(verificationToken && { three_d_secure: { token: verificationToken } }),\n            },\n        };\n    }\n\n    private async _getSquareCardIdOrThrow(methodId: string, instrumentId: string): Promise<string> {\n        const state = await this._paymentIntegrationService.loadPaymentMethod(methodId, {\n            params: { method: methodId, bigpayToken: instrumentId },\n        });\n\n        const { initializationData } =\n            state.getPaymentMethodOrThrow<SquareInitializationData>(methodId);\n        const { cardId } = initializationData || {};\n\n        if (!cardId) {\n            throw new PaymentArgumentInvalidError(['cardId']);\n        }\n\n        return cardId;\n    }\n}\n","import { HostedInstrument } from './payment';\n\nexport default function isHostedInstrumentLike(\n    instrument: unknown,\n): instrument is HostedInstrument {\n    return (\n        typeof instrument === 'object' &&\n        instrument !== null &&\n        (typeof (instrument as HostedInstrument).shouldSaveInstrument === 'undefined' ||\n            typeof (instrument as HostedInstrument).shouldSaveInstrument === 'boolean') &&\n        (typeof (instrument as HostedInstrument).shouldSetAsDefaultInstrument === 'undefined' ||\n            typeof (instrument as HostedInstrument).shouldSetAsDefaultInstrument === 'boolean')\n    );\n}\n","import {\n    FormattedPayload,\n    FormattedVaultedInstrument,\n    HostedVaultedInstrument,\n    PaymentInstrumentPayload,\n    VaultedInstrument,\n} from './payment';\n\nexport default function isVaultedInstrument(\n    instrument: PaymentInstrumentPayload,\n): instrument is VaultedInstrument {\n    return Boolean((instrument as VaultedInstrument).instrumentId);\n}\n\nexport function isHostedVaultedInstrument(\n    instrument: PaymentInstrumentPayload,\n): instrument is HostedVaultedInstrument {\n    return (\n        Boolean((instrument as HostedVaultedInstrument).instrumentId) &&\n        !Object.prototype.hasOwnProperty.call(instrument, 'ccNumber') &&\n        !Object.prototype.hasOwnProperty.call(instrument, 'ccCvv')\n    );\n}\n\nexport function isFormattedVaultedInstrument(\n    instrument: PaymentInstrumentPayload,\n): instrument is FormattedPayload<FormattedVaultedInstrument> {\n    const formattedInstrument = (instrument as FormattedPayload<FormattedVaultedInstrument>)\n        .formattedPayload;\n\n    if (!formattedInstrument) {\n        return false;\n    }\n\n    return (\n        typeof formattedInstrument.bigpay_token === 'string' ||\n        Boolean(formattedInstrument.bigpay_token && formattedInstrument.bigpay_token.token)\n    );\n}\n","import StandardError from './standard-error';\n\n/**\n * This error should be thrown when the client library of a payment method fails\n * to load, or for some reason, it is inaccessible.\n */\nexport default class PaymentMethodClientUnavailableError extends StandardError {\n    constructor(message?: string) {\n        super(\n            message ||\n                'Unable to proceed because the client library of a payment method is not loaded or ready to be used.',\n        );\n\n        this.name = 'PaymentMethodClientUnavailableError';\n        this.type = 'payment_method_client_unavailable';\n    }\n}\n","import { PaymentMethodClientUnavailableError } from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport type { Square } from './types';\n\ninterface SquareV2HostWindow extends Window {\n    Square: Square;\n}\n\nfunction isSquareV2Window(window: Window): window is SquareV2HostWindow {\n    return 'Square' in window;\n}\n\nexport default function assertSquareV2Window(window: Window): asserts window is SquareV2HostWindow {\n    if (!isSquareV2Window(window)) {\n        throw new PaymentMethodClientUnavailableError();\n    }\n}\n","import { getScriptLoader } from '@bigcommerce/script-loader';\n\nimport {\n    PaymentStrategy,\n    PaymentStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport SquareV2PaymentProcessor from './squarev2-payment-processor';\nimport SquareV2PaymentStrategy from './squarev2-payment-strategy';\nimport SquareV2ScriptLoader from './squarev2-script-loader';\n\nconst createSquareV2PaymentStrategy: PaymentStrategyFactory<PaymentStrategy> = (\n    paymentIntegrationService,\n) => {\n    return new SquareV2PaymentStrategy(\n        paymentIntegrationService,\n        new SquareV2PaymentProcessor(\n            new SquareV2ScriptLoader(getScriptLoader()),\n            paymentIntegrationService,\n        ),\n    );\n};\n\nexport default toResolvableModule(createSquareV2PaymentStrategy, [{ id: 'squarev2' }]);\n","import ResolvableModule from './resolvable-module';\n\nexport default function toResolvableModule<TModule, TIdentifier>(\n    module: TModule,\n    resolveIds: TIdentifier[],\n): ResolvableModule<TModule, TIdentifier> {\n    return Object.assign(module, { resolveIds });\n}\n","import {\n    type CardInstrument,\n    type CheckoutSelectors,\n    type CheckoutService,\n    type PaymentMethod,\n} from '@bigcommerce/checkout-sdk';\nimport classNames from 'classnames';\nimport React, { type FunctionComponent, useCallback, useEffect, useMemo, useState } from 'react';\n\nimport {\n    CardInstrumentFieldset,\n    StoreInstrumentFieldset,\n} from '@bigcommerce/checkout/instrument-utils';\nimport { usePaymentFormContext } from '@bigcommerce/checkout/payment-integration-api';\nimport { LoadingOverlay } from '@bigcommerce/checkout/ui';\n\nexport interface SquareV2FormProps {\n    checkoutService: CheckoutService;\n    checkoutState: CheckoutSelectors;\n    containerId: string;\n    deinitializePayment: () => Promise<void>;\n    initializePayment: () => Promise<void>;\n    method: PaymentMethod;\n}\n\nconst SquareV2Form: FunctionComponent<SquareV2FormProps> = ({\n    checkoutService,\n    checkoutState,\n    containerId,\n    deinitializePayment,\n    initializePayment,\n    method,\n}) => {\n    const [isAddingNewCard, setIsAddingNewCard] = useState(false);\n    const [selectedInstrumentId, setSelectedInstrumentId] = useState<string | undefined>(undefined);\n\n    const { getCustomer, getInstruments } = checkoutState.data;\n    const isSignedIn = getCustomer()?.isGuest;\n    const isInstrumentFeatureAvailable = !isSignedIn && Boolean(method.config.isVaultingEnabled);\n\n    useEffect(() => {\n        if (isInstrumentFeatureAvailable) {\n            void checkoutService.loadInstruments();\n        }\n    }, [checkoutService, isInstrumentFeatureAvailable]);\n\n    const instruments = useMemo(() => getInstruments(method) || [], [getInstruments, method]);\n    const shouldShowInstrumentFieldset = isInstrumentFeatureAvailable && instruments.length > 0;\n    const shouldShowCreditCardFieldset = !shouldShowInstrumentFieldset || isAddingNewCard;\n\n    const getDefaultInstrumentId = useCallback(() => {\n        if (isAddingNewCard) {\n            return;\n        }\n\n        if (instruments.length > 0) {\n            const defaultInstrument =\n                instruments.find((instrument) => instrument.defaultInstrument) || instruments[0];\n\n            return defaultInstrument.bigpayToken;\n        }\n    }, [instruments, isAddingNewCard]);\n\n    useEffect(() => {\n        const defaultInstrumentId = getDefaultInstrumentId() || undefined;\n\n        setSelectedInstrumentId(defaultInstrumentId);\n    }, [getDefaultInstrumentId, instruments]);\n\n    const { setFieldValue } = usePaymentFormContext().paymentForm;\n\n    const handleSelectInstrument: (id: string) => void = (id) => {\n        setIsAddingNewCard(false);\n        setSelectedInstrumentId(id);\n    };\n\n    const handleDeleteInstrument: (id: string) => void = (id) => {\n        if (instruments.length === 0) {\n            setIsAddingNewCard(true);\n            setSelectedInstrumentId(undefined);\n\n            setFieldValue('instrumentId', '');\n        } else if (selectedInstrumentId === id) {\n            setSelectedInstrumentId(getDefaultInstrumentId());\n\n            setFieldValue('instrumentId', getDefaultInstrumentId());\n        }\n    };\n\n    const handleUseNewCard: () => void = () => {\n        setIsAddingNewCard(true);\n        setSelectedInstrumentId(undefined);\n\n        void deinitializePayment();\n\n        void initializePayment();\n    };\n\n    const renderPlaceholderFields = () => {\n        return (\n            <div data-test=\"squarev2_placeholder_form\" style={{ display: 'none' }}>\n                <div className=\"form-field\">\n                    <div\n                        className=\"form-label optimizedCheckout-form-label\"\n                        id=\"messageIsDefault\"\n                    />\n                    <div className=\"form-input optimizedCheckout-form-input\" id=\"inputIsDefault\" />\n                </div>\n                <div className=\"form-field\">\n                    <div\n                        className=\"form-input optimizedCheckout-form-input form-input--focus optimizedCheckout-form-input--focus\"\n                        id=\"inputIsFocus\"\n                    />\n                </div>\n                <div className=\"form-field form-field--error\">\n                    <div className=\"form-inlineMessage\" id=\"messageIsError\" />\n                    <div className=\"form-input optimizedCheckout-form-input\" id=\"inputIsError\" />\n                </div>\n            </div>\n        );\n    };\n\n    const { isLoadingInstruments } = checkoutState.statuses;\n\n    return (\n        <LoadingOverlay\n            data-test=\"squarev2_loading_overlay\"\n            hideContentWhenLoading\n            isLoading={isLoadingInstruments()}\n        >\n            <div className=\"paymentMethod--hosted\">\n                {shouldShowInstrumentFieldset && (\n                    <CardInstrumentFieldset\n                        // eslint-disable-next-line @typescript-eslint/consistent-type-assertions\n                        instruments={instruments as CardInstrument[]}\n                        onDeleteInstrument={handleDeleteInstrument}\n                        onSelectInstrument={handleSelectInstrument}\n                        onUseNewInstrument={handleUseNewCard}\n                        selectedInstrumentId={selectedInstrumentId || getDefaultInstrumentId()}\n                    />\n                )}\n                <div\n                    className={classNames('widget', `widget--${method.id}`, 'payment-widget')}\n                    data-test={containerId}\n                    style={{\n                        display: !shouldShowCreditCardFieldset ? 'none' : undefined,\n                    }}\n                    tabIndex={-1}\n                >\n                    {renderPlaceholderFields()}\n                    <div id={containerId} />\n                </div>\n\n                {isInstrumentFeatureAvailable && (\n                    <StoreInstrumentFieldset\n                        instrumentId={selectedInstrumentId}\n                        instruments={instruments}\n                    />\n                )}\n            </div>\n        </LoadingOverlay>\n    );\n};\n\nexport default SquareV2Form;\n","import { createSquareV2PaymentStrategy } from '@bigcommerce/checkout-sdk/integrations/squarev2';\nimport { difference } from 'lodash';\nimport React, { type FunctionComponent, useCallback, useEffect } from 'react';\n\nimport { getAppliedStyles } from '@bigcommerce/checkout/dom-utils';\nimport {\n    type PaymentMethodProps,\n    type PaymentMethodResolveId,\n    toResolvableComponent,\n} from '@bigcommerce/checkout/payment-integration-api';\n\nimport SquareV2Form from './SquareV2Form';\n\nconst SquareV2PaymentMethod: FunctionComponent<PaymentMethodProps> = ({\n    method,\n    checkoutService,\n    checkoutState,\n}) => {\n    const getStylesFromElement = (id: string, properties: string[]) => {\n        const container = document.querySelector<HTMLDivElement>(`#${id}`);\n\n        if (!container) {\n            throw new Error(\n                `Unable to retrieve input styles as the provided container ID \"${id}\" is not valid.`,\n            );\n        }\n\n        return getAppliedStyles(container, properties);\n    };\n\n    const copyStylesFromDummyFormFields = useCallback(() => {\n        const styleProps = [\n            'backgroundColor',\n            'borderColor',\n            'borderRadius',\n            'borderWidth',\n            'color',\n            'fontSize',\n            'fontWeight',\n        ];\n\n        return {\n            default: {\n                message: getStylesFromElement('messageIsDefault', ['color']),\n                input: getStylesFromElement('inputIsDefault', styleProps),\n            },\n            focus: {\n                input: getStylesFromElement(\n                    'inputIsFocus',\n                    difference(styleProps, ['borderRadius']),\n                ),\n            },\n            error: {\n                message: getStylesFromElement('messageIsError', ['color']),\n                input: getStylesFromElement('inputIsError', [\n                    'borderColor',\n                    'borderWidth',\n                    'color',\n                ]),\n            },\n        };\n    }, []);\n\n    const mapToSquareStyles = useCallback(\n        (styles: ReturnType<typeof copyStylesFromDummyFormFields>) => {\n            const { borderColor, borderRadius, borderWidth, ...input } = styles.default.input;\n            const {\n                borderColor: borderColorIsFocus,\n                borderWidth: borderWidthIsFocus,\n                ...inputIsFocus\n            } = styles.focus.input;\n            const {\n                borderColor: borderColorIsError,\n                borderWidth: borderWidthIsError,\n                color: colorIsError,\n            } = styles.error.input;\n\n            return {\n                input,\n                'input.is-focus': {\n                    ...inputIsFocus,\n                },\n                'input.is-error': {\n                    color: colorIsError,\n                },\n                '.input-container': {\n                    borderColor,\n                    borderRadius,\n                    borderWidth,\n                },\n                '.input-container.is-focus': {\n                    borderColor: borderColorIsFocus,\n                    borderWidth: borderWidthIsFocus,\n                },\n                '.input-container.is-error': {\n                    borderColor: borderColorIsError,\n                    borderWidth: borderWidthIsError,\n                },\n                '.message-text': {\n                    color: styles.default.message.color,\n                },\n                '.message-icon': {\n                    color: styles.default.message.color,\n                },\n                '.message-text.is-error': {\n                    color: styles.error.message.color,\n                },\n                '.message-icon.is-error': {\n                    color: styles.error.message.color,\n                },\n            };\n        },\n        [],\n    );\n\n    const containerId = 'squarev2_payment_element_container';\n\n    const initializePayment = useCallback(async () => {\n        let style;\n\n        try {\n            style = mapToSquareStyles(copyStylesFromDummyFormFields());\n        } catch {\n            /* Do nothing: we should not block shoppers from buying. */\n        }\n\n        await checkoutService.initializePayment({\n            gatewayId: method.gateway,\n            methodId: method.id,\n            integrations: [createSquareV2PaymentStrategy],\n            squarev2: {\n                containerId,\n                style,\n            },\n        });\n    }, [\n        checkoutService,\n        copyStylesFromDummyFormFields,\n        mapToSquareStyles,\n        method.gateway,\n        method.id,\n    ]);\n\n    const deinitializePayment = useCallback(async () => {\n        await checkoutService.deinitializePayment({\n            gatewayId: method.gateway,\n            methodId: method.id,\n        });\n    }, [checkoutService, method.gateway, method.id]);\n\n    useEffect(() => {\n        void initializePayment();\n\n        return () => {\n            void deinitializePayment();\n        };\n    }, [deinitializePayment, initializePayment]);\n\n    return (\n        <SquareV2Form\n            checkoutService={checkoutService}\n            checkoutState={checkoutState}\n            containerId={containerId}\n            deinitializePayment={deinitializePayment}\n            initializePayment={initializePayment}\n            method={method}\n        />\n    );\n};\n\nexport default toResolvableComponent<PaymentMethodProps, PaymentMethodResolveId>(\n    SquareV2PaymentMethod,\n    [{ id: 'squarev2' }],\n);\n","export default function mapFromInstrumentCardType(type: string): string {\n    switch (type) {\n        case 'amex':\n        case 'american_express':\n            return 'american-express';\n\n        case 'diners':\n        case 'diners_club':\n            return 'diners-club';\n\n        default:\n            return type;\n    }\n}\n","import { type CardInstrument } from '@bigcommerce/checkout-sdk';\nimport { expirationDate } from 'card-validator';\nimport classNames from 'classnames';\nimport creditCardType from 'credit-card-type';\nimport { type FieldProps } from 'formik';\nimport { find, noop } from 'lodash';\nimport React, { type FunctionComponent, useCallback, useEffect, useRef } from 'react';\n\nimport { TranslatedString } from '@bigcommerce/checkout/locale';\nimport { CreditCardIcon, DropdownTrigger } from '@bigcommerce/checkout/ui';\n\nimport { mapFromInstrumentCardType } from '../mapFromInstrumentCardType';\n\nexport interface InstrumentSelectProps extends FieldProps<string> {\n    instruments: CardInstrument[];\n    selectedInstrumentId?: string;\n    shouldHideExpiryDate?: boolean;\n    onSelectInstrument(id: string): void;\n    onUseNewInstrument(): void;\n}\n\nexport interface InstrumentSelectValues {\n    instrumentId: string;\n}\n\ninterface InstrumentMenuItemProps {\n    className?: string;\n    instrument: CardInstrument;\n    testId?: string;\n    shouldHideExpiryDate?: boolean;\n    onClick?(): void;\n}\n\nconst InstrumentMenuItem: FunctionComponent<InstrumentMenuItemProps> = ({\n    className,\n    instrument,\n    testId,\n    shouldHideExpiryDate = false,\n    onClick,\n}) => {\n    const cardType = mapFromInstrumentCardType(instrument.brand);\n    const cardInfo = creditCardType.getTypeInfo(cardType);\n    const isExpired = !expirationDate({\n        month: instrument.expiryMonth,\n        year: instrument.expiryYear,\n    }).isValid;\n\n    return (\n        <button className={className} data-test={testId} onClick={onClick} type=\"button\">\n            <div\n                className={classNames('instrumentSelect-details', {\n                    'instrumentSelect-details--expired': isExpired,\n                })}\n            >\n                <CreditCardIcon cardType={cardType} />\n\n                <div className=\"instrumentSelect-card\" data-test={`${testId ?? ''}-last4`}>\n                    {cardInfo ? (\n                        <TranslatedString\n                            data={{\n                                cardTitle: cardInfo.niceType ?? '',\n                                endingIn: instrument.last4,\n                            }}\n                            id=\"payment.instrument_ending_in_text\"\n                        />\n                    ) : (\n                        <TranslatedString\n                            data={{ endingIn: instrument.last4 }}\n                            id=\"payment.instrument_default_ending_in_text\"\n                        />\n                    )}\n                </div>\n\n                {!shouldHideExpiryDate && (\n                    <div\n                        className={classNames('instrumentSelect-expiry', {\n                            'instrumentSelect-expiry--expired': isExpired,\n                        })}\n                        data-test={`${testId || ''}-expiry`}\n                    >\n                        {isExpired ? (\n                            <TranslatedString\n                                data={{\n                                    expiryDate: `${instrument.expiryMonth}/${instrument.expiryYear}`,\n                                }}\n                                id=\"payment.instrument_expired_text\"\n                            />\n                        ) : (\n                            <TranslatedString\n                                data={{\n                                    expiryDate: `${instrument.expiryMonth}/${instrument.expiryYear}`,\n                                }}\n                                id=\"payment.instrument_expires_text\"\n                            />\n                        )}\n                    </div>\n                )}\n            </div>\n        </button>\n    );\n};\n\ninterface InstrumentOptionProps {\n    instrument: CardInstrument;\n    testId?: string;\n    shouldHideExpiryDate?: boolean;\n    onClick?(token: string): void;\n}\n\nconst InstrumentOption: FunctionComponent<InstrumentOptionProps> = ({\n    instrument,\n    shouldHideExpiryDate = false,\n    onClick = noop,\n}) => {\n    const handleClick = useCallback(() => {\n        onClick(instrument.bigpayToken);\n    }, [onClick, instrument]);\n\n    return (\n        <InstrumentMenuItem\n            instrument={instrument}\n            onClick={handleClick}\n            shouldHideExpiryDate={shouldHideExpiryDate}\n            testId=\"instrument-select-option\"\n        />\n    );\n};\n\ninterface InstrumentUseNewButtonProps {\n    className?: string;\n    testId?: string;\n    onClick?(): void;\n}\n\nconst InstrumentUseNewButton: FunctionComponent<InstrumentUseNewButtonProps> = ({\n    className,\n    testId,\n    onClick = noop,\n}) => (\n    <button className={className} data-test={testId} onClick={onClick} type=\"button\">\n        <div className=\"instrumentSelect-details instrumentSelect-details--addNew\">\n            <CreditCardIcon />\n\n            <div className=\"instrumentSelect-card\">\n                <TranslatedString id=\"payment.instrument_add_card_action\" />\n            </div>\n        </div>\n    </button>\n);\n\ninterface InstrumentMenuProps {\n    instruments: CardInstrument[];\n    selectedInstrumentId?: string;\n    shouldHideExpiryDate?: boolean;\n    onSelectInstrument(id: string): void;\n    onUseNewInstrument(): void;\n}\n\nconst InstrumentMenu: FunctionComponent<InstrumentMenuProps> = ({\n    instruments,\n    selectedInstrumentId,\n    shouldHideExpiryDate = false,\n    onSelectInstrument,\n    onUseNewInstrument,\n}) => {\n    return (\n        <ul\n            className=\"instrumentSelect-dropdownMenu instrumentSelect-dropdownMenuNext dropdown-menu\"\n            data-test=\"instrument-select-menu\"\n        >\n            {instruments.map((instrument) => (\n                <li\n                    className={classNames('instrumentSelect-option dropdown-menu-item', {\n                        'instrumentSelect-option--selected':\n                            instrument.bigpayToken === selectedInstrumentId,\n                    })}\n                    key={instrument.bigpayToken}\n                >\n                    <InstrumentOption\n                        instrument={instrument}\n                        onClick={onSelectInstrument}\n                        shouldHideExpiryDate={shouldHideExpiryDate}\n                        testId=\"instrument-select-option\"\n                    />\n                </li>\n            ))}\n\n            <li className=\"instrumentSelect-option instrumentSelect-option--addNew dropdown-menu-item\">\n                <InstrumentUseNewButton\n                    onClick={onUseNewInstrument}\n                    testId=\"instrument-select-option-use-new\"\n                />\n            </li>\n        </ul>\n    );\n};\n\ninterface InstrumentSelectButtonProps {\n    instrument?: CardInstrument;\n    shouldHideExpiryDate?: boolean;\n    testId?: string;\n    onClick?(): void;\n}\n\nconst InstrumentSelectButton: FunctionComponent<InstrumentSelectButtonProps> = ({\n    instrument,\n    shouldHideExpiryDate = false,\n    testId,\n    onClick,\n}) => {\n    if (!instrument) {\n        return (\n            <InstrumentUseNewButton\n                className=\"instrumentSelect-button optimizedCheckout-form-select dropdown-button form-input\"\n                testId={testId}\n            />\n        );\n    }\n\n    return (\n        <InstrumentMenuItem\n            className=\"instrumentSelect-button optimizedCheckout-form-select dropdown-button form-input\"\n            instrument={instrument}\n            onClick={onClick}\n            shouldHideExpiryDate={shouldHideExpiryDate}\n            testId={testId}\n        />\n    );\n};\n\nconst InstrumentSelect: FunctionComponent<InstrumentSelectProps> = ({\n    field,\n    form,\n    instruments,\n    onSelectInstrument,\n    onUseNewInstrument,\n    selectedInstrumentId,\n    shouldHideExpiryDate = false,\n}) => {\n    const prevSelectedInstrumentIdRef = useRef(selectedInstrumentId);\n\n    const updateFieldValue = useCallback(\n        (instrumentId = '') => {\n            void form.setFieldValue(field.name, instrumentId);\n        },\n        [form, field.name],\n    );\n\n    useEffect(() => {\n        // FIXME: Used setTimeout here because setFieldValue call doesnot set value if called before formik is properly mounted.\n        //        This ensures that update Field value is called after formik has mounted.\n        // See GitHub issue: https://github.com/jaredpalmer/formik/issues/930\n        setTimeout(() => updateFieldValue(selectedInstrumentId));\n\n        return () => {\n            if (field.value === '' && selectedInstrumentId !== undefined) {\n                updateFieldValue();\n            }\n        };\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, []);\n\n    useEffect(() => {\n        if (prevSelectedInstrumentIdRef.current !== selectedInstrumentId) {\n            // FIXME: Used setTimeout here because setFieldValue call doesnot set value if called before formik is properly mounted.\n            //        This ensures that update Field value is called after formik has mounted.\n            // See GitHub issue: https://github.com/jaredpalmer/formik/issues/930\n            setTimeout(() => updateFieldValue(selectedInstrumentId));\n        }\n\n        prevSelectedInstrumentIdRef.current = selectedInstrumentId;\n    }, [selectedInstrumentId, updateFieldValue]);\n\n    const selectedInstrument = find(instruments, { bigpayToken: selectedInstrumentId });\n\n    return (\n        <div className=\"instrumentSelect\">\n            <DropdownTrigger\n                dropdown={\n                    <InstrumentMenu\n                        instruments={instruments}\n                        onSelectInstrument={onSelectInstrument}\n                        onUseNewInstrument={onUseNewInstrument}\n                        selectedInstrumentId={selectedInstrumentId}\n                        shouldHideExpiryDate={shouldHideExpiryDate}\n                    />\n                }\n            >\n                <InstrumentSelectButton\n                    instrument={selectedInstrument}\n                    shouldHideExpiryDate={shouldHideExpiryDate}\n                    testId=\"instrument-select\"\n                />\n\n                <input type=\"hidden\" {...field} />\n            </DropdownTrigger>\n        </div>\n    );\n};\n\nexport default InstrumentSelect;\n","import { type CardInstrument } from '@bigcommerce/checkout-sdk';\nimport { type FieldProps } from 'formik';\nimport React, { type FunctionComponent, memo, useCallback } from 'react';\n\nimport { TranslatedString } from '@bigcommerce/checkout/locale';\nimport {\n    BasicFormField,\n    Fieldset,\n    Legend,\n    ModalTrigger,\n    type ModalTriggerModalProps,\n} from '@bigcommerce/checkout/ui';\n\nimport { InstrumentSelect } from '../InstrumentSelect';\nimport { ManageInstrumentsModal } from '../ManageInstrumentsModal';\n\nexport interface CardInstrumentFieldsetProps {\n    instruments: CardInstrument[];\n    selectedInstrumentId?: string;\n    shouldHideExpiryDate?: boolean;\n    validateInstrument?: React.ReactNode;\n    onDeleteInstrument?(instrumentId: string): void;\n    onSelectInstrument(id: string): void;\n    onUseNewInstrument(): void;\n}\n\nconst CardInstrumentFieldset: FunctionComponent<CardInstrumentFieldsetProps> = ({\n    instruments,\n    onDeleteInstrument,\n    onSelectInstrument,\n    onUseNewInstrument,\n    selectedInstrumentId,\n    shouldHideExpiryDate = false,\n    validateInstrument = null,\n}) => {\n    const renderInput = useCallback(\n        (field: FieldProps<string>) => (\n            <InstrumentSelect\n                {...field}\n                instruments={instruments}\n                onSelectInstrument={onSelectInstrument}\n                onUseNewInstrument={onUseNewInstrument}\n                selectedInstrumentId={selectedInstrumentId}\n                shouldHideExpiryDate={shouldHideExpiryDate}\n            />\n        ),\n        [\n            instruments,\n            onSelectInstrument,\n            onUseNewInstrument,\n            selectedInstrumentId,\n            shouldHideExpiryDate,\n        ],\n    );\n\n    const renderModal = useCallback(\n        (props: ModalTriggerModalProps) => (\n            <ManageInstrumentsModal\n                instruments={instruments}\n                onDeleteInstrument={onDeleteInstrument}\n                {...props}\n            />\n        ),\n        [instruments, onDeleteInstrument],\n    );\n\n    return (\n        <Fieldset\n            additionalClassName=\"instrumentFieldset\"\n            legend={\n                <Legend hidden>\n                    <TranslatedString id=\"payment.instrument_text\" />\n                </Legend>\n            }\n        >\n            <ModalTrigger modal={renderModal}>\n                {({ onClick }) => (\n                    <button className=\"instrumentModal-trigger\" onClick={onClick} type=\"button\">\n                        <TranslatedString id=\"payment.instrument_manage_button\" />\n                    </button>\n                )}\n            </ModalTrigger>\n\n            <BasicFormField name=\"instrumentId\" render={renderInput} />\n\n            <div style={{ display: selectedInstrumentId ? undefined : 'none' }}>\n                {validateInstrument}\n            </div>\n        </Fieldset>\n    );\n};\n\nexport default memo(CardInstrumentFieldset);\n"],"names":["NotInitializedErrorType","SquareIntent","StandardError","Error","constructor","message","prototype","super","name","type","Object","setPrototypeOf","this","__proto__","captureStackTrace","stack","PaymentExecuteError","subtype","guard","value","errorFactory","CheckoutButtonNotInitialized","CustomerNotInitialized","PaymentNotInitialized","ShippingNotInitialized","SpamProtectionNotInitialized","NotInitializedError","CHARGE","STORE","SquareV2PaymentProcessor","_scriptLoader","_paymentIntegrationService","initialize","testMode","applicationId","locationId","square","load","_payments","payments","deinitialize","_formValidationSubscription","unsubscribe","_card","destroy","initializeCard","containerId","style","onValidationChange","postalCode","getState","getBillingAddress","_getPayments","card","attach","configure","_error","_subscribeToFormValidation","tokenize","result","_getCard","status","token","errorMessage","errors","JSON","stringify","verifyBuyer","intent","_chargeVerifyBuyer","_storeVerifyBuyer","observer","blacklist","invalidFields","Set","eventObservables","map","eventType","fromEvent","merge","pipe","event","detail","field","currentState","isCompletelyValid","includes","size","distinctUntilChanged","subscribe","_mapToSquareBillingContact","firstName","givenName","lastName","familyName","address1","address2","city","stateOrProvinceCode","state","countryCode","email","phone","addressLines","getCheckoutOrThrow","getBillingAddressOrThrow","outstandingBalance","cart","details","amount","toString","billingContact","currencyCode","currency","code","response","InvalidArgumentError","DEFAULT_RESPONSE","body","headers","RequestError","PaymentMethodInvalidError","PaymentArgumentInvalidError","join","OrderFinalizationNotRequiredError","SquareV2WebPaymentsSdkEnv","SquareV2PaymentStrategy","_squareV2PaymentProcessor","options","squarev2","methodId","config","initializationData","getPaymentMethodOrThrow","execute","payment","paymentData","shouldSaveInstrument","shouldSetAsDefaultInstrument","instrument","submitOrder","submitPaymentPayload","Boolean","instrumentId","_getVaultedInstrumentPayload","_getCardPayload","submitPayment","formattedPayload","vault_payment_instrument","set_as_default_stored_instrument","finalize","Promise","reject","shouldVerify","features","getStoreConfigOrThrow","checkoutSettings","cardTokenizationResult","isSquareV2ApiV2Enabled","credit_card_token","tokenData","nonce","tokenForSavingCard","store_card_nonce","store_card_token","verificationToken","_getSquareCardIdOrThrow","bigpay_token","three_d_secure","loadPaymentMethod","params","method","bigpayToken","cardId","PaymentMethodClientUnavailableError","LIVE","SANDBOX","SquareV2ScriptLoader","loadScript","window","Square","module","paymentIntegrationService","getScriptLoader","resolveIds","id","assign","checkoutService","checkoutState","deinitializePayment","initializePayment","isAddingNewCard","setIsAddingNewCard","useState","selectedInstrumentId","setSelectedInstrumentId","undefined","getCustomer","getInstruments","data","isInstrumentFeatureAvailable","isGuest","isVaultingEnabled","useEffect","loadInstruments","instruments","useMemo","shouldShowInstrumentFieldset","length","shouldShowCreditCardFieldset","getDefaultInstrumentId","useCallback","find","defaultInstrument","defaultInstrumentId","setFieldValue","paymentForm","isLoadingInstruments","statuses","LoadingOverlay","hideContentWhenLoading","isLoading","className","CardInstrumentFieldset","onDeleteInstrument","onSelectInstrument","onUseNewInstrument","display","tabIndex","StoreInstrumentFieldset","toResolvableComponent","getStylesFromElement","properties","container","document","querySelector","getAppliedStyles","copyStylesFromDummyFormFields","styleProps","default","input","focus","difference","error","mapToSquareStyles","styles","borderColor","borderRadius","borderWidth","borderColorIsFocus","borderWidthIsFocus","inputIsFocus","borderColorIsError","borderWidthIsError","color","colorIsError","gatewayId","gateway","integrations","mapFromInstrumentCardType","InstrumentMenuItem","testId","shouldHideExpiryDate","onClick","cardType","brand","cardInfo","isExpired","expirationDate","month","expiryMonth","year","expiryYear","isValid","CreditCardIcon","TranslatedString","cardTitle","niceType","endingIn","last4","expiryDate","InstrumentOption","noop","handleClick","InstrumentUseNewButton","InstrumentMenu","key","InstrumentSelectButton","form","prevSelectedInstrumentIdRef","useRef","updateFieldValue","setTimeout","current","selectedInstrument","DropdownTrigger","dropdown","memo","validateInstrument","renderInput","renderModal","props","ManageInstrumentsModal","Fieldset","additionalClassName","legend","Legend","hidden","ModalTrigger","modal","BasicFormField","render"],"sourceRoot":""}