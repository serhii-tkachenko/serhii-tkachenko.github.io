"use strict";(self.webpackJsonpCheckout=self.webpackJsonpCheckout||[]).push([[8964],{44713:(e,t,s)=>{s.r(t),s.d(t,{default:()=>U});var a=s(31635),i=s(70355),n=s(49655),d=s(39981),o=s(69022),r=s(17986),l=s(39886),c=s(95108),u=s(43586),m=s(69462),g=s(94202),A=s(68512),h=s(38989),v=s(91182),f=s(87650),p=s(49102),E=s(62562),y=s(38546),b=s(22011),C=s(33515),k=s(10685),S=s(69070),F=s(74027),w=s(46487),_=s(4899),B=s(60833),N=s(74302);const V=(0,A.A)((0,m.bk)({handleSubmit:(e,{props:{onSubmit:t}})=>{t(e)},mapPropsToValues:({getFields:e,customerMessage:t,billingAddress:s})=>Object.assign(Object.assign({},(0,b.A)(e(s&&s.countryCode),s)),{orderComment:t}),isInitialValid:({billingAddress:e,getFields:t,language:s})=>!!e&&(0,C.A)({language:s,formFields:t(e.countryCode)}).isValidSync(e),validationSchema:({language:e,getFields:t,methodId:s})=>"amazonpay"===s?(0,g.RZ)((s=>(0,k.A)({translate:(0,C.X)(e),formFields:t(s&&s.countryCode)}))):(0,g.RZ)((s=>(0,C.A)({language:e,formFields:t(s&&s.countryCode)}))),enableReinitialize:!0})((({methodId:e,getFields:t,billingAddress:s,setFieldValue:l,values:c,onUnhandledError:u})=>{const[m,g]=(0,i.useState)(!1),A=(0,i.useRef)(null),{isPayPalFastlaneEnabled:b,paypalFastlaneAddresses:C}=(0,h.A)(),{themeV2:k}=(0,o.w)(),{checkoutService:V,checkoutState:I}=(0,d.Q)(),{data:{getCustomer:U,getConfig:L,getCart:P},statuses:{isUpdatingBillingAddress:R,isUpdatingCheckout:z}}=I,M=U(),O=L(),j=P();if(!O||!M||!j)throw new Error("checkout data is not available");const x=M.isGuest,J=M.addresses,Q="amazonpay"===e,Z=t(c.countryCode),G=Z.filter((({custom:e})=>e)),T=G.length>0,X=Q&&T?G:Z,q=x&&b?C:J,D=(null==q?void 0:q.length)>0,H=s&&(0,f.A)(s,q,t(s.countryCode)),K=R()||z(),{enableOrderComments:W}=O.checkoutSettings,Y=W&&(0,F.A)(j)<1,$=e=>(0,a.__awaiter)(void 0,void 0,void 0,(function*(){g(!0);try{yield V.updateBillingAddress(e)}catch(e){e instanceof Error&&u(e)}finally{g(!1)}}));return i.createElement(_.A,{autoComplete:"on"},Q&&s&&i.createElement("div",{className:"form-fieldset"},i.createElement(N.A,{address:s})),i.createElement(B.A,{id:"checkoutBillingAddress",ref:A},D&&!Q&&i.createElement(B.A,{id:"billingAddresses"},i.createElement(v.A,{isLoading:m},i.createElement(p.A,{addresses:q,onSelectAddress:$,onUseNewAddress:()=>{$({})},selectedAddress:H?s:void 0,type:E.A.Billing}))),!H&&i.createElement(r.A,{isLoading:m},i.createElement(y.A,{countryCode:c.countryCode,formFields:X,setFieldValue:l,shouldShowSaveAddress:!x,type:E.A.Billing}))),Y&&i.createElement(S.A,null),i.createElement("div",{className:"form-actions"},i.createElement(w.Ay,{className:k?"body-bold":"",disabled:K||m,id:"checkout-billing-continue",isLoading:K||m,type:"submit",variant:w.Ak.Primary},i.createElement(n.A,{id:"common.continue_action"}))))})));var I=s(21106);const U=({navigateNextStep:e,onReady:t,onUnhandledError:s})=>{const{checkoutService:m,checkoutState:g}=(0,d.Q)(),{themeV2:A}=(0,o.w)(),{data:{getCheckout:h,getConfig:v,getCart:f,getCustomer:p,getBillingAddress:E,getBillingAddressFields:y},statuses:{isLoadingBillingCountries:b}}=g,C=v(),k=p(),S=h(),F=f();if(!(C&&k&&S&&F))throw new Error("Unable to access checkout data");const w=b(),_=S.customerMessage,B=function(e){const t=(0,I.A)(e);return t&&["amazonpay"].includes(t.providerId)?t.providerId:void 0}(S),N=E(),U=y;return(0,i.useEffect)((()=>{(0,a.__awaiter)(void 0,void 0,void 0,(function*(){try{yield m.loadBillingAddressFields(),t()}catch(e){e instanceof Error&&s(e)}}))}),[]),i.createElement(r.A,{isLoading:w},i.createElement("div",{className:"checkout-form"},i.createElement("div",{className:"form-legend-container"},i.createElement(u.A,{testId:"billing-address-heading",themeV2:A},i.createElement(n.A,{id:"billing.billing_address_heading"}))),i.createElement(V,{billingAddress:N,customerMessage:_,getFields:U,methodId:B,navigateNextStep:e,onSubmit:t=>(0,a.__awaiter)(void 0,void 0,void 0,(function*(){var{orderComment:i}=t,n=(0,a.__rest)(t,["orderComment"]);const d=m.updateBillingAddress,o=m.updateCheckout,r=E(),u=[],g=(0,l.A)(n);g&&!(0,c.A)(g,r)&&u.push(d(g)),_!==i&&u.push(o({customerMessage:i}));try{yield Promise.all(u),e()}catch(e){e instanceof Error&&s(e)}})),onUnhandledError:s})))}}}]);
//# sourceMappingURL=billing-54c77a77.js.map