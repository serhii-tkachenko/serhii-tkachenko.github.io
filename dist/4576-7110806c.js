"use strict";(self.webpackJsonpCheckout=self.webpackJsonpCheckout||[]).push([[4576],{4576:(e,t,n)=>{n.d(t,{GooglePayButton:()=>Kt,GooglePayPaymentMethod:()=>en});var i=n(58636),o=n(91195),a=n(38589),r=n(58002),s={};function c(e,t,n=!0){var i;return null!==(i=e[t])&&void 0!==i?i:n}s.d=(e,t)=>{for(var n in t)s.o(t,n)&&!s.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);const d="3.128.0",l="3.123.2",u="3.106.0";class h{constructor(e){this.paymentIntegrationService=e,this.braintreeWindow=window}getSDKVersion(){const e=this.paymentIntegrationService.getState().getStoreConfig(),t=(null==e?void 0:e.checkoutSettings.features)||{};return this.getPreloadedSDKVersion()||(c(t,"PAYPAL-5809.braintree_hosted_fields_fix_version")?d:c(t,"PAYPAL-5636.update_braintree_sdk_version")?l:u)}getPreloadedSDKVersion(){const e=this.braintreeWindow.braintree;if(e){const t=(0,r.find)(Object.values(e),(e=>!!e.VERSION));return null==t?void 0:t.VERSION}}}class y extends Error{constructor(e){var t;super(e||"An unexpected error has occurred."),this.name="StandardError",this.type="standard",t=new.target.prototype,Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,"function"==typeof Error.captureStackTrace?Error.captureStackTrace(this,new.target):this.stack=new Error(this.message).stack}}class g extends y{constructor(e){super(e||"Unsupported browser error"),this.name="UnsupportedBrowserError",this.type="unsupported_browser"}}var p,m,f,w,P,v,_,b,C;(C=p||(p={}))[C.CheckoutButtonNotInitialized=0]="CheckoutButtonNotInitialized",C[C.CustomerNotInitialized=1]="CustomerNotInitialized",C[C.PaymentNotInitialized=2]="PaymentNotInitialized",C[C.ShippingNotInitialized=3]="ShippingNotInitialized",C[C.SpamProtectionNotInitialized=4]="SpamProtectionNotInitialized";class S extends y{constructor(e){super(function(e){switch(e){case p.CustomerNotInitialized:return"Unable to proceed because the customer step of checkout has not been initialized.";case p.PaymentNotInitialized:return"Unable to proceed because the payment step of checkout has not been initialized.";case p.ShippingNotInitialized:return"Unable to proceed because the shipping step of checkout has not been initialized.";case p.SpamProtectionNotInitialized:return"Unable to proceed because the checkout spam protection has not been initialized.";default:return"Unable to proceed because the required component has not been initialized."}}(e)),this.subtype=e,this.name="NotInitializedError",this.type="not_initialized"}}!function(e){e.ESTIMATED="ESTIMATED",e.FINAL="FINAL",e.NOT_CURRENTLY_KNOWN="NOT_CURRENTLY_KNOWN"}(m||(m={})),function(e){e.Completed="COMPLETED",e.Pending="PENDING",e.Failed="FAILED"}(f||(f={})),function(e){e.TRUSTLY="trustly"}(w||(w={})),function(e){e.SUCCEEDED="succeeded",e.FAILED="failed",e.CANCELED="cancelled",e.UNRECOGNIZED="unrecognized"}(P||(P={})),function(e){e.Customer="CUSTOMER",e.Merchant="MERCHANT",e.Network="NETWORK",e.Internal="INTERNAL",e.Unknown="UNKNOWN"}(v||(v={})),function(e){e.KountNotEnabled="DATA_COLLECTOR_KOUNT_NOT_ENABLED"}(_||(_={})),function(e){e.Visa="visa",e.Mastercard="mastercard",e.AmericanExpress="american-express",e.DinersClub="diners-club",e.Discover="discover",e.Jcb="jcb",e.UnionPay="union-pay",e.Maestro="maestro",e.Elo="elo",e.Mir="mir",e.Hiper="hiper",e.Hipercard="hipercard"}(b||(b={}));var I,O,k,A=function(e,t,n,i){return new(n||(n=Promise))((function(o,a){function r(e){try{c(i.next(e))}catch(e){a(e)}}function s(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,s)}c((i=i.apply(e,t||[])).next())}))};class T{constructor(e){this.braintreeScriptLoader=e}initialize(e){this.setClientToken(e)}deinitialize(){return A(this,void 0,void 0,(function*(){yield this.teardownModule(this.dataCollector),this.dataCollector=void 0}))}getClient(){return A(this,void 0,void 0,(function*(){if(!this.client){const e=this.getClientTokenOrThrow(),t=yield this.braintreeScriptLoader.loadClient();this.client=yield t.create({authorization:e})}return this.client}))}getDataCollectorOrThrow(e){return A(this,void 0,void 0,(function*(){const t={deviceData:void 0,teardown:()=>Promise.resolve()};if(!this.dataCollector)try{const t=yield this.getClient(),n=yield this.braintreeScriptLoader.loadDataCollector(),i=Object.assign({client:t,kount:!0},e);this.dataCollector=yield n.create(i)}catch(e){if(function(e){return Boolean("object"==typeof e&&null!==e&&("type"in e||"message"in e||"code"in e))}(e)&&e.code===_.KountNotEnabled)return t;throw e}return this.dataCollector}))}getBraintreeGooglePayment(){return A(this,void 0,void 0,(function*(){if(!this.googlePayment){const[e,t]=yield Promise.all([this.getClient(),this.braintreeScriptLoader.loadGooglePayment()]);this.googlePayment=yield t.create({client:e})}return this.googlePayment}))}getBraintreeThreeDS(){return A(this,void 0,void 0,(function*(){if(!this.threeDS){const[e,t]=yield Promise.all([this.getClient(),this.braintreeScriptLoader.load3DS()]);this.threeDS=yield t.create({client:e,version:2})}return this.threeDS}))}getBraintreeLocalPayment(e){return A(this,void 0,void 0,(function*(){if(!this.braintreeLocalPayment){const[t,n]=yield Promise.all([this.getClient(),this.braintreeScriptLoader.loadLocalPayment()]);this.braintreeLocalPayment=yield new Promise(((i,o)=>{n.create({client:t,merchantAccountId:e},((e,t)=>{e&&o(e),i(t)}))}))}return this.braintreeLocalPayment}))}getUsBankAccount(){return A(this,void 0,void 0,(function*(){if(!this.usBankAccount){const e=yield this.getClient(),t=yield this.braintreeScriptLoader.loadUsBankAccount();this.usBankAccount=yield t.create({client:e})}return this.usBankAccount}))}getBraintreeVisaCheckout(){return this.visaCheckout||(this.visaCheckout=Promise.all([this.getClient(),this.braintreeScriptLoader.loadVisaCheckout()]).then((([e,t])=>t.create({client:e})))),this.visaCheckout}getVisaCheckoutSdk(e){return A(this,void 0,void 0,(function*(){return this.visaCheckoutSDK||(this.visaCheckoutSDK=yield this.braintreeScriptLoader.loadVisaCheckoutSdk(e)),this.visaCheckoutSDK}))}getVenmoCheckoutOrThrow(){return A(this,void 0,void 0,(function*(){if(!this.braintreeVenmo){const e=yield this.getClient(),t=yield this.braintreeScriptLoader.loadVenmoCheckout(),n={client:e,allowDesktop:!0,paymentMethodUsage:"multi_use"},i=yield t.create(n);if(!i.isBrowserSupported())throw new g;this.braintreeVenmo=i}return this.braintreeVenmo}))}setClientToken(e){this.clientToken=e}getClientTokenOrThrow(){if(!this.clientToken)throw new S(p.PaymentNotInitialized);return this.clientToken}teardownModule(e){return e?e.teardown():Promise.resolve()}}class E extends y{constructor(e){super(e||"Unable to proceed because the client library of a payment method is not loaded or ready to be used."),this.name="PaymentMethodClientUnavailableError",this.type="payment_method_client_unavailable"}}!function(e){e.Sandbox="sandbox",e.Production="production"}(I||(I={})),function(e){e.Client="client",e.DataCollector="dataCollector",e.Fastlane="fastlane",e.GooglePayment="googlePayment",e.HostedFields="hostedFields",e.LocalPayment="localPayment",e.Paypal="paypal",e.PaypalCheckout="paypalCheckout",e.ThreeDSecure="threeDSecure",e.UsBankAccount="usBankAccount",e.Venmo="venmo",e.VisaCheckout="visaCheckout"}(O||(O={})),function(e){e.CardCode="cardCode",e.CardCodeVerification="cardCodeVerification",e.CardExpiry="cardExpiry",e.CardName="cardName",e.CardNumber="cardNumber",e.CardNumberVerification="cardNumberVerification"}(k||(k={}));const M={[u]:{[O.Client]:"sha384-26BXDNnJI23JYRyFBj4xe4sVNrUSSiSSu11kxVXNM/vEPONm4LuL00w6ZaTgQewt",[O.PaypalCheckout]:"sha384-B+vzbZwnQtzWBthpkT4TXKUibO65tyeK7eCxSvpblgprTep2+IAXB2Cxxjrn710O",[O.Paypal]:"sha384-uyAGL1/3+XJAHnGoNy4eCoXdzJ4f7Ilzp+6w9PNnEjs6DCCz9WMyJjMN1gzc78U+",[O.LocalPayment]:"sha384-LIvOEMkIVEwVuYBdVOQc1AC5YbGGlwyfUheS0ACK218D2STuVYQlZ4FyEPowAEfT",[O.DataCollector]:"sha384-1bo9JDz+Kscthc085cCKWur8CLwUoBpoNyxsDi7932mCl0zFq3A5mv+FQLw9GHpV",[O.UsBankAccount]:"sha384-xmHBVaU+w74V+OebD3AaPONFxHUGMf+QRs8G/JxVPXNNP7MDa2jL0ICWHIe2tTfJ",[O.GooglePayment]:"sha384-WKDJl8mqoP82qZpMGH6AbZxnvXnSW8ILV4M64CyMLiugGMwu7LyP89wjCkHqsiBe",[O.ThreeDSecure]:"sha384-VQUlpGHzsGvs5XeiGFip7EXRsvoHWEXDVmgCacfbyieZI9mdBOqq3NSoyo28OCOB",[O.VisaCheckout]:"sha384-yx7mADfzTN0T43Q6rlH49LIg1EJ0iUZgBp/EczX9LXsUGkySgxrD+nWHQRBkyfoT",[O.Venmo]:"sha384-QX4rPjoj1ZDhuG0aSyKs56lEKDqTMTcjYxUHY1SzO5VZDsqIE2NTkqot7KNSCyov",[O.HostedFields]:"sha384-VvYBACfSu0Cr/J32uKmxG7AXcNOJE1AzIIL3kbikyS7YKp5fz5Is+NzNP/lyauNy",[O.Fastlane]:"sha384-9oGsZMRZwpGtDEDYa/dFt76dECqj1xAni9gIKgc3KfMIiRnR73nEeeUDLiBzxhFa"},[l]:{[O.Client]:"sha384-o+nbQGcwNNxIBeXeu3+XmbSq+Cg8R3EN3N0l5hXCgMMU2RGY0t1z0LroSEIAbfAO",[O.PaypalCheckout]:"sha384-WrfbWPBS4mH86GAoycPSgiH8hQ8KH7A67C93Hjhunv/xhNk2YpBn3wbFA4Fhg9U/",[O.Paypal]:"sha384-VF389nvvrRUgDsTXMxTYORDtVegB9IQa3Cxr//DyJnLYnz8/X8VCzEvck2c+Megt",[O.LocalPayment]:"sha384-tZKx2rEQbfmZpoPSY5VPmJEhaq4X75dLvwHMs3VE9U+C8lPyw+hWTIL1+GPvWCIH",[O.DataCollector]:"sha384-E6k3wOpP7syCDDwaRDLF06942Y00NkbwJvWi2OQXwwKzGwG5fd3E7RFUvCCecfvO",[O.UsBankAccount]:"sha384-258FON8LZGG0W9Qaz4Jij83pZHu30YnKjJA7gNulLBh6CclkucgF+tHDQuYFRYfW",[O.GooglePayment]:"sha384-taJ2p/0+n0VH328POAoBiuEbL3tnHUTE9S42hK1V+Txs3X+QYjZOyKW35JgHRFfO",[O.ThreeDSecure]:"sha384-+NSZH4Zj3sO5bdWvPKhU5N16QDxeueTVTnUVeleeESkhLSaz4Ob1hh/5myecc9Ym",[O.VisaCheckout]:"sha384-66DiBjghxk1OmBj8aksN8gbQ+CwoQcx1vPfiXUN08g1iQVM+BwewF0p7toM3i7SS",[O.Venmo]:"sha384-B5UwY42kE4RoLoWbQ7YpqosUlUad2/DlGWiw0HhoZbSPk30CQAaSA10ohyLDTkDU",[O.HostedFields]:"sha384-Aw9EesSaUeWxe36PqEHiOyOyOq8M6CIb1gw7/yHNVPRzGtFXXcd2OQ8qXrIlOj2P",[O.Fastlane]:"sha384-rhBL1hpZ71JqG+2TsT0Dih47mbjx8cjJCpeZjk9tw3df1gFMKfCTmMyZunhr7H4Y"},[d]:{[O.Client]:"sha384-0WNxksIpRP+fYZiIdr12g6DBUQfLDzYCQJZtR/C8KkcwSGhPHfcFp3tTaGcMyFTq",[O.PaypalCheckout]:"sha384-lWM1jk4BOxoDNV6Kop7tVNvQgINlmEVz0c/OwM+HNHK3QC8xqwd54Ovrt2QRDTjh",[O.Paypal]:"sha384-fXUmVxC2EMZBDXZ7eTHSTL/LFBrHej/MSXT/vTBXvra4lzgLNGvREAp+x0GYObuH",[O.LocalPayment]:"sha384-pha1xGuGSkmZH5x9aqHvRaO4xLea7rmQ/79PFj9zxNzxuFcOWZg7gOP7FibygOEC",[O.DataCollector]:"sha384-Q6PI2F9eekWbAxhroybl+aEcvqhdowN/EQlGwBUyJOzPFn9982u9xl6SU6XfGKzc",[O.UsBankAccount]:"sha384-W3RLQSKJL1tQ3+Y7mP6tmkamtZ8bV4Yw/XxL9Jj5JtXHraD8loMF8hAIG5m2zK7F",[O.GooglePayment]:"sha384-TITQMsFWA3elDNGP2mWz2oKBo4qjt+TlqzovcaPoeBiAh/wPBi6nae50ADdgU1/i",[O.ThreeDSecure]:"sha384-YiycYN89ZlL/Evcaq4y1ajW1mhd7JYfZBDuOwHtIn4/Jnm20GL+/XCM+zYAwWD8D",[O.VisaCheckout]:"sha384-/OdaTv9qrkKzjObtUe6yzfDhHozFW/+uXlrSl736sOZRJpjGQETvpYXqMFFg69xv",[O.Venmo]:"sha384-dA+ojdW9vbJS4JavcXyOs9d5uZHJg5dNtYupoPSH2zsXIiYDVS5amLb/u8qmQ6oz",[O.HostedFields]:"sha384-31ZkS58+iaWsW06ftW52zzVZFp43WPd7pNYRiddYynSNg6Oh7WGbSFGorAUH6T1z",[O.Fastlane]:"sha384-jlbrwNvL3HvLAUCtLSmrnQ2GH1udCUrRS/bVmReAS5fuIVvcW8Pko/Gkg82tlgtr"}};var D,N,R=function(e,t,n,i){return new(n||(n=Promise))((function(o,a){function r(e){try{c(i.next(e))}catch(e){a(e)}}function s(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,s)}c((i=i.apply(e,t||[])).next())}))};class x{constructor(e,t,n){this.scriptLoader=e,this.braintreeHostWindow=t,this.braintreeSDKVersionManager=n}loadClient(){return R(this,void 0,void 0,(function*(){return this.loadBraintreeModuleOrThrow(O.Client,"client.min.js")}))}loadFastlane(){return R(this,void 0,void 0,(function*(){return this.loadBraintreeModuleOrThrow(O.Fastlane,"fastlane.min.js")}))}loadPaypalCheckout(){return R(this,void 0,void 0,(function*(){return this.loadBraintreeModuleOrThrow(O.PaypalCheckout,"paypal-checkout.min.js")}))}loadPaypal(){return R(this,void 0,void 0,(function*(){return this.loadBraintreeModuleOrThrow(O.Paypal,"paypal.min.js")}))}loadLocalPayment(){return R(this,void 0,void 0,(function*(){return this.loadBraintreeModuleOrThrow(O.LocalPayment,"local-payment.min.js")}))}loadDataCollector(){return R(this,void 0,void 0,(function*(){return this.loadBraintreeModuleOrThrow(O.DataCollector,"data-collector.min.js")}))}loadUsBankAccount(){return R(this,void 0,void 0,(function*(){return this.loadBraintreeModuleOrThrow(O.UsBankAccount,"us-bank-account.min.js")}))}loadGooglePayment(){return R(this,void 0,void 0,(function*(){return this.loadBraintreeModuleOrThrow(O.GooglePayment,"google-payment.min.js")}))}load3DS(){return R(this,void 0,void 0,(function*(){return this.loadBraintreeModuleOrThrow(O.ThreeDSecure,"three-d-secure.min.js")}))}loadVisaCheckout(){return this.loadBraintreeModuleOrThrow(O.VisaCheckout,"visa-checkout.min.js")}loadVenmoCheckout(){return this.loadBraintreeModuleOrThrow(O.Venmo,"venmo.min.js")}loadHostedFields(){return R(this,void 0,void 0,(function*(){return this.loadBraintreeModuleOrThrow(O.HostedFields,"hosted-fields.min.js")}))}loadVisaCheckoutSdk(e){return R(this,void 0,void 0,(function*(){if(this.braintreeHostWindow.V)return this.braintreeHostWindow.V;const t=e?"sha384-0eu1s1GtqzXlL9DtLgmwzC5WWlEH/ADRM0n38cVQkvtT+W/gey96rcb1LwuUOPDm":"sha384-1f1csvP3ZFxg4dILH1GaY4LHlZ0oX7Rk83rxmLlwbnIi4TM0NYzXoev1VoEiVDS6";return this.scriptLoader.loadScript(`//${e?"sandbox-":""}assets.secure.checkout.visa.com/checkout-widget/resources/js/integration/v1/sdk.js`,{async:!0,attributes:{integrity:t,crossorigin:"anonymous"}}).then((()=>{if(!this.braintreeHostWindow.V)throw new E;return this.braintreeHostWindow.V}))}))}loadBraintreeModuleOrThrow(e,t){return R(this,void 0,void 0,(function*(){let n=this.getBraintreeModule(e);if(n)return n;const i=this.braintreeSDKVersionManager.getSDKVersion(),o=`//js.braintreegateway.com/web/${i}/js/${t}`,a=i in M?this.getIntegrityValuesByModuleName(e,i):void 0;if(yield this.scriptLoader.loadScript(o,a?{async:!0,attributes:{integrity:a,crossorigin:"anonymous"}}:void 0),n=this.getBraintreeModule(e),!n)throw new E;return n}))}getBraintreeModule(e){var t;return null===(t=this.braintreeHostWindow.braintree)||void 0===t?void 0:t[e]}getIntegrityValuesByModuleName(e,t){const n=M[t][e];if(!n)throw new Error("Unexpected fileName value");return n}}function B(e,t){return Object.assign(e,{resolveIds:t})}!function(e){e[e.MissingBillingAddress=0]="MissingBillingAddress",e[e.MissingCart=1]="MissingCart",e[e.MissingCheckout=2]="MissingCheckout",e[e.MissingConsignments=3]="MissingConsignments",e[e.MissingCustomer=4]="MissingCustomer",e[e.MissingCheckoutConfig=5]="MissingCheckoutConfig",e[e.MissingOrder=6]="MissingOrder",e[e.MissingOrderConfig=7]="MissingOrderConfig",e[e.MissingOrderId=8]="MissingOrderId",e[e.MissingPayment=9]="MissingPayment",e[e.MissingPaymentId=10]="MissingPaymentId",e[e.MissingPaymentInstrument=11]="MissingPaymentInstrument",e[e.MissingPaymentMethod=12]="MissingPaymentMethod",e[e.MissingPaymentRedirectUrl=13]="MissingPaymentRedirectUrl",e[e.MissingPaymentStatus=14]="MissingPaymentStatus",e[e.MissingPaymentToken=15]="MissingPaymentToken",e[e.MissingShippingAddress=16]="MissingShippingAddress"}(D||(D={}));class z extends y{constructor(e){super(function(e){switch(e){case D.MissingBillingAddress:return"Unable to proceed because billing address data is unavailable.";case D.MissingCart:return"Unable to proceed because cart data is unavailable.";case D.MissingConsignments:return"Unable to proceed because consignments data is unavailable.";case D.MissingCheckout:return"Unable to proceed because checkout data is unavailable.";case D.MissingCustomer:return"Unable to proceed because customer data is unavailable.";case D.MissingCheckoutConfig:case D.MissingOrderConfig:return"Unable to proceed because configuration data is unavailable.";case D.MissingOrder:return"Unable to proceed because order data is unavailable.";case D.MissingOrderId:return"Unable to proceed because order ID is unavailable or not generated yet.";case D.MissingPayment:return"Unable to proceed because payment data is unavailable.";case D.MissingPaymentToken:return"Unable to proceed because the token required to submit a payment is missing.";case D.MissingPaymentMethod:return"Unable to proceed because payment method data is unavailable or not properly configured.";case D.MissingShippingAddress:return"Unable to proceed because shipping address data is unavailable.";default:return"Unable to proceed because the required data is unavailable."}}(e)),this.subtype=e,this.name="MissingDataError",this.type="missing_data"}}class j extends y{constructor(e){super(e||"Invalid arguments have been provided."),this.name="InvalidArgumentError",this.type="invalid_argument"}}class G{constructor(e){const t=new Promise(((e,t)=>{this.cancel=t}));this.promise=Promise.race([e,t])}}function F(e,t,n){if("function"!=typeof n.value)return n;let i=n.value;return{get(){const e=i.bind(this);return Object.defineProperty(this,t,Object.assign(Object.assign({},n),{value:e})),e},set(e){i=e}}}!function(e){e.ADYEN_V2="googlepayadyenv2",e.ADYEN_V3="googlepayadyenv3",e.AUTHORIZE_NET="googlepayauthorizenet",e.BNZ="googlepaybnz",e.BRAINTREE="googlepaybraintree",e.PAYPAL_COMMERCE="googlepaypaypalcommerce",e.BIGCOMMERCE_PAYMENTS="googlepay_bigcommerce_payments",e.CHECKOUT_COM="googlepaycheckoutcom",e.CYBERSOURCE_V2="googlepaycybersourcev2",e.ORBITAL="googlepayorbital",e.STRIPE="googlepaystripe",e.STRIPE_UPE="googlepaystripeupe",e.STRIPE_OCS="googlepaystripeocs",e.WORLDPAY_ACCESS="googlepayworldpayaccess",e.TD_ONLINE_MART="googlepaytdonlinemart"}(N||(N={}));class L{constructor(e){if(!e)throw new Error("Currency settings missing");const{decimalPlaces:t,symbolLocation:n,symbol:i,thousandsSeparator:o,decimalSeparator:a}=e;if("string"!=typeof n||"string"!=typeof i||"string"!=typeof o||"string"!=typeof a||"string"!=typeof t)throw new j("Invalid currency settings provided");this._decimalPlaces=parseInt(t,10),this._symbolLocation=n,this._symbol=i,this._thousandsSeparator=o,this._decimalSeparator=a}format(e){if("number"!=typeof e)throw new j("Invalid amount provided");const t=this._formatNumber(e),n=this._formatCurrency(t);return e<0?`-${n}`:n}_formatNumber(e){const t=Math.abs(e),[n,i=""]=this._toFixed(t,this._decimalPlaces).split("."),o=n.replace(/\B(?=(\d{3})+(?!\d))/g,this._thousandsSeparator);return this._decimalPlaces<1?o:[o,i].join(this._decimalSeparator)}_formatCurrency(e){return"left"===this._symbolLocation.toLowerCase()?`${this._symbol}${e}`:`${e}${this._symbol}`}_toFixed(e,t){return(+`${Math.round(+`${e}e${t}`)}e${-t}`).toFixed(t)}}let q=class{constructor(e){this._storeConfig=e,this._customerFormatter=new L(this._storeConfig.shopperCurrency),this._storeFormatter=new L(this._storeConfig.currency)}toCustomerCurrency(e){const t=this._storeConfig.shopperCurrency.exchangeRate;return this._customerFormatter.format(e*t)}toStoreCurrency(e){return this._storeFormatter.format(e)}};q=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r}([function(e,t,n){return t&&n?F(0,t,n):function(e){const t=class extends e{};return Object.getOwnPropertyNames(e.prototype).forEach((n=>{const i=Object.getOwnPropertyDescriptor(e.prototype,n);i&&"constructor"!==n&&Object.defineProperty(t.prototype,n,F(e.prototype,n,i))})),t}(e)}],q);const U=q;function V(e,t){if(null==e)throw t?t():new Error("An unexpected error has occurred.");return e}var H,W,Y,J,Q,K,Z,X,$;function ee(e){return e in K}!function(e){e.AUTHORIZE="authorize",e.CAPTURE="capture"}(H||(H={})),function(e){e.paypal="paypal",e.checkout="checkout",e.buynow="buynow",e.pay="pay",e.installment="installment"}(W||(W={})),function(e){e.gold="gold",e.blue="blue",e.silver="silver",e.black="black",e.white="white"}(Y||(Y={})),function(e){e.pill="pill",e.rect="rect"}(J||(J={})),function(e){e.ESTIMATED="ESTIMATED",e.FINAL="FINAL",e.NOT_CURRENTLY_KNOWN="NOT_CURRENTLY_KNOWN"}(Q||(Q={})),function(e){e.AMEX="AMEX",e.DISCOVER="DISCOVER",e.INTERAC="INTERAC",e.JCB="JCB",e.MC="MASTERCARD",e.VISA="VISA"}(K||(K={})),function(e){e.OFFER="OFFER",e.PAYMENT_AUTHORIZATION="PAYMENT_AUTHORIZATION",e.SHIPPING_ADDRESS="SHIPPING_ADDRESS",e.SHIPPING_OPTION="SHIPPING_OPTION"}(Z||(Z={})),function(e){e.OFFER_INVALID="OFFER_INVALID",e.PAYMENT_DATA_INVALID="PAYMENT_DATA_INVALID",e.SHIPPING_ADDRESS_INVALID="SHIPPING_ADDRESS_INVALID",e.SHIPPING_ADDRESS_UNSERVICEABLE="SHIPPING_ADDRESS_UNSERVICEABLE",e.SHIPPING_OPTION_INVALID="SHIPPING_OPTION_INVALID",e.OTHER_ERROR="OTHER_ERROR"}(X||(X={})),function(e){e.INITIALIZE="INITIALIZE",e.SHIPPING_OPTION="SHIPPING_OPTION",e.SHIPPING_ADDRESS="SHIPPING_ADDRESS",e.OFFER="OFFER"}($||($={}));var te=function(e,t,n,i){return new(n||(n=Promise))((function(o,a){function r(e){try{c(i.next(e))}catch(e){a(e)}}function s(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,s)}c((i=i.apply(e,t||[])).next())}))};class ne{constructor(e,t){this._gatewayIdentifier=e,this._paymentIntegrationService=t,this._isBuyNowFlow=!1}mapToShippingAddressRequestBody({shippingAddress:e}){if(!e)return;const{company:t="",phone:n=""}=this._paymentIntegrationService.getState().getShippingAddress()||{};return this._mapToAddressRequestBody(e,t,n)}mapToBillingAddressRequestBody(e){const{billingAddress:t}=e.paymentMethodData.info;if(!t)return;const{company:n="",phone:i="",email:o,customFields:a=[]}=this._paymentIntegrationService.getState().getBillingAddress()||{};return Object.assign(Object.assign({},this._mapToAddressRequestBody(t,n,i,a)),{email:o||e.email})}mapToExternalCheckoutData(e){var t;const{paymentMethodData:{tokenizationData:{token:n},info:{cardNetwork:i,cardDetails:o}}}=e;if(!n)throw new z(D.MissingPaymentToken);return Promise.resolve(Object.assign({nonce:n,card_information:{type:i,number:o}},this._isBuyNowFlow&&{cart_id:null===(t=this._paymentIntegrationService.getState().getCart())||void 0===t?void 0:t.id}))}getRequiredData(){var e;return te(this,void 0,void 0,(function*(){const t={emailRequired:!0};if(!this._isShippingAddressRequired())return t;const n=yield this._paymentIntegrationService.loadShippingCountries(),i=null===(e=n.getShippingCountries())||void 0===e?void 0:e.map((e=>e.code));return Object.assign(Object.assign({},t),{shippingAddressRequired:!0,shippingAddressParameters:Object.assign({phoneNumberRequired:!0},i&&{allowedCountryCodes:i}),shippingOptionRequired:!0})}))}getCallbackIntents(){return this._isShippingAddressRequired()?[Z.OFFER,Z.SHIPPING_ADDRESS,Z.SHIPPING_OPTION]:[Z.OFFER]}getCallbackTriggers(){const e=this._paymentIntegrationService.getState().getStoreConfigOrThrow().checkoutSettings.features["PI-2875.googlepay_coupons_handling"]||!1;return{availableTriggers:[$.INITIALIZE,$.SHIPPING_ADDRESS,$.SHIPPING_OPTION,...e?[$.OFFER]:[]],initializationTrigger:[$.INITIALIZE],addressChangeTriggers:[$.INITIALIZE,$.SHIPPING_ADDRESS],shippingOptionsChangeTriggers:[$.SHIPPING_OPTION],offerChangeTriggers:e?[$.OFFER]:[]}}getNonce(e){var t;const n=null===(t=this._paymentIntegrationService.getState().getPaymentMethodOrThrow(e).initializationData)||void 0===t?void 0:t.nonce;if(!n)throw new z(D.MissingPaymentToken);return Promise.resolve(n)}extraPaymentData(){return Promise.resolve(void 0)}getMerchantInfo(){const{googleMerchantName:e,googleMerchantId:t,platformToken:n}=this.getGooglePayInitializationData();return{merchantName:e,merchantId:t,authJwt:n}}getTransactionInfo(){let e;if(this._isBuyNowFlow)e=this._getCurrencyCodeOrThrow();else{const{getCartOrThrow:t}=this._paymentIntegrationService.getState();e=t().currency.code}const t=this.getGooglePayInitializationData().storeCountry;return Object.assign(Object.assign({},t&&{countryCode:t}),{currencyCode:e,totalPriceStatus:Q.ESTIMATED,totalPrice:"0"})}getPaymentGatewayParameters(){const e=this.getGooglePayInitializationData().gatewayMerchantId;if(!e)throw new j("Unable to proceed, gatewayMerchantId is missing.");return{gateway:this._gatewayIdentifier,gatewayMerchantId:e}}getCardParameters(){return{allowedAuthMethods:["PAN_ONLY","CRYPTOGRAM_3DS"],allowedCardNetworks:this.getPaymentMethod().supportedCards.filter(ee).map((e=>K[e])),billingAddressRequired:!0,billingAddressParameters:{format:"FULL",phoneNumberRequired:!0}}}initialize(e,t,n){return this._getPaymentMethodFn=e,this._isBuyNowFlow=Boolean(t),this._currencyCode=n,this._isBuyNowFlow&&this._getCurrencyCodeOrThrow(),Promise.resolve()}handleShippingAddressChange(e){var t,n,i,o;return te(this,void 0,void 0,(function*(){e&&(e.name=e.name||"",e.address1=e.address1||"");const a=this.mapToShippingAddressRequestBody({shippingAddress:e});a&&(yield this._paymentIntegrationService.updateShippingAddress(a));const r=this._paymentIntegrationService.getState(),s=r.getConsignments();if(!(null==s?void 0:s[0]))return;const c=s[0],d=r.getStoreConfigOrThrow();this._currencyService||(this._currencyService=new U(d));const l=(c.availableShippingOptions||[]).map(this._getGooglePayShippingOption.bind(this)),u=null===(t=c.availableShippingOptions)||void 0===t?void 0:t.find((e=>e.isRecommended));if(l.length){const e=(null===(n=c.selectedShippingOption)||void 0===n?void 0:n.id)||(null==u?void 0:u.id)||(null===(i=l[0])||void 0===i?void 0:i.id);return!(null===(o=c.selectedShippingOption)||void 0===o?void 0:o.id)&&l[0]&&(yield this.handleShippingOptionChange((null==u?void 0:u.id)||l[0].id)),{defaultSelectedOptionId:e,shippingOptions:l}}}))}handleShippingOptionChange(e){return te(this,void 0,void 0,(function*(){if("shipping_option_unselected"!==e)return this._paymentIntegrationService.selectShippingOption(e)}))}getTotalPrice(){const{getCheckoutOrThrow:e,getCartOrThrow:t}=this._paymentIntegrationService.getState(),{decimalPlaces:n}=t().currency;return(0,r.round)(e().outstandingBalance,n).toFixed(n)}handleCoupons(e){return te(this,void 0,void 0,(function*(){const{redemptionCodes:t=[]}=e,{offers:n}=this.getAppliedCoupons();let i;return yield t.reduce(((e,t)=>te(this,void 0,void 0,(function*(){if(yield e,n.some((({redemptionCode:e})=>e===t)))return;const o=yield this.applyCoupon(t);o&&(i=o)}))),Promise.resolve()),yield n.reduce(((e,n)=>te(this,void 0,void 0,(function*(){yield e,t.includes(n.redemptionCode)||(yield this._paymentIntegrationService.removeCoupon(n.redemptionCode))}))),Promise.resolve()),{newOfferInfo:this.getAppliedCoupons(),error:i}}))}getAppliedCoupons(){const e=this._paymentIntegrationService.getState(),{coupons:t}=e.getCheckout()||{};return{offers:(t||[]).map((e=>{const{displayName:t,code:n}=e;return{redemptionCode:n,description:t}}))}}applyCoupon(e){return te(this,void 0,void 0,(function*(){let t;try{yield this._paymentIntegrationService.applyCoupon(e)}catch(e){return e instanceof Error&&(t={reason:X.OFFER_INVALID,message:e.message,intent:$.OFFER}),t}}))}getGooglePayInitializationData(){return V(this.getPaymentMethod().initializationData,(()=>new j("Missing initialization data.")))}getPaymentMethod(){return V(this._getPaymentMethodFn,(()=>new S(p.PaymentNotInitialized)))()}getGatewayIdentifier(){return this._gatewayIdentifier}setGatewayIdentifier(e){this._gatewayIdentifier=e||this.getGatewayIdentifier()}_isShippingAddressRequired(){const{getCartOrThrow:e,getStoreConfig:t,getShippingAddress:n}=this._paymentIntegrationService.getState();return void 0===n()&&(i=e(),o=t(),!!i&&(!!i.lineItems.physicalItems.some((e=>e.isShippingRequired))||!(!o||!i.lineItems.customItems)&&i.lineItems.customItems.length>0));var i,o}_mapToAddressRequestBody(e,t,n,i){const{name:o,address1:a,address2:r,address3:s,locality:c,administrativeArea:d,countryCode:l,postalCode:u,phoneNumber:h}=e,[y,g]=this._getFirstAndLastName(o);return{firstName:y,lastName:g,company:t,address1:a,address2:`${r} ${s}`.trim(),city:c||d,stateOrProvince:d,stateOrProvinceCode:d,countryCode:l,postalCode:u,phone:h||n,customFields:i||[]}}_getFirstAndLastName(e){const t=e.split(" ");return 1===t.length?[e,""]:[t.slice(0,-1).join(" "),t[t.length-1]]}_getCurrencyCodeOrThrow(){return V(this._currencyCode,(()=>new j('Unable to initialize payment because "options.currencyCode" argument is not provided.')))}_getGooglePayShippingOption({id:e,cost:t,description:n,additionalDescription:i}){var o;const a=null===(o=this._currencyService)||void 0===o?void 0:o.toCustomerCurrency(t);return this._paymentIntegrationService.getState().getStoreConfigOrThrow().checkoutSettings.features["PI-3540.googlepay_new_shipping_options_description"]?{id:e,label:`${a||t} ${n}`,description:i}:{id:e,label:n,description:a||t}}}var ie=function(e,t,n,i){return new(n||(n=Promise))((function(o,a){function r(e){try{c(i.next(e))}catch(e){a(e)}}function s(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,s)}c((i=i.apply(e,t||[])).next())}))};class oe extends ne{constructor(e,t){super("braintree",e),this._braintreeSdk=t,this._methodId=N.BRAINTREE,this._service=e}initialize(e,t,n){const i=Object.create(null,{initialize:{get:()=>super.initialize},getPaymentMethod:{get:()=>super.getPaymentMethod}});return ie(this,void 0,void 0,(function*(){yield i.initialize.call(this,e,t,n);let o=i.getPaymentMethod.call(this);if(o.clientToken||(o=(yield this._service.loadPaymentMethod(this._methodId)).getPaymentMethodOrThrow(this._methodId)),!o.clientToken||!o.initializationData)throw new z(D.MissingPaymentMethod);return this._braintreeSdk.initialize(o.clientToken),this._braintreeGooglePayment=yield this._braintreeSdk.getBraintreeGooglePayment(),Promise.resolve()}))}getNonce(e){const t=Object.create(null,{getNonce:{get:()=>super.getNonce},getPaymentMethod:{get:()=>super.getPaymentMethod}});var n;return ie(this,void 0,void 0,(function*(){const i=yield t.getNonce.call(this,e),{clientToken:o,initializationData:a}=t.getPaymentMethod.call(this);if(!o||!a||!(null===(n=a.card_information)||void 0===n?void 0:n.bin))throw new z(D.MissingPaymentMethod);const{isThreeDSecureEnabled:r,card_information:{bin:s,isNetworkTokenized:c}}=a;if(r&&!c){const e=yield this._braintreeSdk.getBraintreeThreeDS(),{orderAmount:t}=this._service.getState().getOrderOrThrow();return(yield this._braintreePresent3DSChallenge(e,t,i,s)).nonce}return i}))}extraPaymentData(){return ie(this,void 0,void 0,(function*(){return{deviceSessionId:yield this._getBraintreeDeviceData()}}))}mapToExternalCheckoutData(e){const t=Object.create(null,{mapToExternalCheckoutData:{get:()=>super.mapToExternalCheckoutData}});return ie(this,void 0,void 0,(function*(){const n=yield t.mapToExternalCheckoutData.call(this,e);let i;try{i=JSON.parse(n.nonce)}catch(e){throw new j("Unable to parse response from Google Pay.")}return function(e){if(!function(e){return"object"==typeof e&&null!==e&&"androidPayCards"in e}(e))throw new z(D.MissingPaymentToken)}(i),n.nonce=i.androidPayCards[0].nonce,n.card_information.bin=i.androidPayCards[0].details.bin,n.card_information.isNetworkTokenized=i.androidPayCards[0].details.isNetworkTokenized,n}))}getCardParameters(){return super.getCardParameters()}getPaymentGatewayParameters(){const e=Object.create(null,{getMerchantInfo:{get:()=>super.getMerchantInfo},getTransactionInfo:{get:()=>super.getTransactionInfo},getRequiredData:{get:()=>super.getRequiredData}});return ie(this,void 0,void 0,(function*(){return this.getBraintreeGooglePayment().createPaymentDataRequest(Object.assign({merchantInfo:e.getMerchantInfo.call(this),transactionInfo:e.getTransactionInfo.call(this),cardRequirements:{billingAddressRequired:!0,billingAddressFormat:"FULL"}},yield e.getRequiredData.call(this))).paymentMethodTokenizationParameters.parameters}))}getBraintreeGooglePayment(){if(!this._braintreeGooglePayment)throw new z(D.MissingPaymentMethod);return this._braintreeGooglePayment}_getBraintreeDeviceData(){return ie(this,void 0,void 0,(function*(){const{deviceData:e}=yield this._braintreeSdk.getDataCollectorOrThrow();return e}))}_braintreePresent3DSChallenge(e,t,n,i){return new G(e.verifyCard({amount:t,bin:i,nonce:n,onLookupComplete:(e,t)=>{t()}})).promise}}class ae extends y{constructor(e){super(e||"Payment process was cancelled."),this.name="PaymentMethodCancelledError",this.type="payment_cancelled"}}class re extends y{constructor(e){super(e||"Unable to proceed because the client library of a payment method has thrown an unexpected error."),this.name="PaymentMethodFailedError",this.type="payment_method_client_invalid"}}class se extends y{constructor(e){super(e||"An unexpected error has occurred during buy now cart creation process. Please try again later."),this.name="BuyNowCartCreationError",this.type="buy_now_cart_creation_error"}}function ce(e){return"object"==typeof e&&null!==e&&"statusCode"in e}function de(e){return Object.values(N).includes(e)}var le=function(e,t,n,i){return new(n||(n=Promise))((function(o,a){function r(e){try{c(i.next(e))}catch(e){a(e)}}function s(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,s)}c((i=i.apply(e,t||[])).next())}))};class ue{constructor(e,t){this._paymentIntegrationService=e,this._googlePayPaymentProcessor=t}initialize(e){var t,n;return le(this,void 0,void 0,(function*(){if(!e.methodId||!de(e.methodId))throw new j('Unable to proceed because "methodId" is not a valid key.');if(this._methodId=e.methodId,!e.containerId)throw new j('Unable to proceed because "containerId" is not a valid key.');const i=e[this._getMethodOrThrow()];if(!i)throw new j("Unable to proceed without valid options.");const{buyNowInitializeOptions:o,currencyCode:a,buttonColor:r,buttonType:s,onError:c}=i;let d,l=this._paymentIntegrationService.getState();try{d=l.getPaymentMethodOrThrow(this._getMethodOrThrow())}catch(e){l=yield this._paymentIntegrationService.loadPaymentMethod(this._getMethodOrThrow()),d=l.getPaymentMethodOrThrow(this._getMethodOrThrow())}if(this._countryCode=null===(t=d.initializationData)||void 0===t?void 0:t.storeCountry,o){if(!a)throw new j('Unable to initialize payment because "options.currencyCode" argument is not provided.');this._currencyCode=a,this._buyNowInitializeOptions=o,yield this._googlePayPaymentProcessor.initialize((()=>d),this._getGooglePayClientOptions(),!!o,a)}else yield this._paymentIntegrationService.loadDefaultCheckout(),yield this._googlePayPaymentProcessor.initialize((()=>d),this._getGooglePayClientOptions());this._paymentButton=null!==(n=this._paymentButton)&&void 0!==n?n:this._googlePayPaymentProcessor.addPaymentButton(e.containerId,{buttonColor:null!=r?r:"default",buttonType:null!=s?s:"plain",onClick:this._handleClick(c)})}))}deinitialize(){var e;return null===(e=this._paymentButton)||void 0===e||e.remove(),this._paymentButton=void 0,this._methodId=void 0,Promise.resolve()}_handleClick(e){return t=>le(this,void 0,void 0,(function*(){t.preventDefault();try{this._buyNowInitializeOptions?yield this._createBuyNowCartOrThrow(this._buyNowInitializeOptions):yield this._paymentIntegrationService.loadDefaultCheckout(),yield this._googlePayPaymentProcessor.initializeWidget(),yield this._interactWithPaymentSheet()}catch(t){let n=t;if(ce(t)){if("CANCELED"===t.statusCode)throw new ae;n=new re(JSON.stringify(t))}throw null==e||e(new re("An error occurred while requesting your Google Pay payment details.")),n}}))}_interactWithPaymentSheet(){var e;return le(this,void 0,void 0,(function*(){const t=yield this._googlePayPaymentProcessor.showPaymentSheet(),n=this._googlePayPaymentProcessor.mapToBillingAddressRequestBody(t),i=this._googlePayPaymentProcessor.mapToShippingAddressRequestBody(t),o="/embedded-checkout"===window.location.pathname?this._paymentIntegrationService.getState().getStoreConfigOrThrow().links.siteLink:void 0;n&&(yield this._paymentIntegrationService.updateBillingAddress(n)),i&&!(null===(e=this._buyNowCart)||void 0===e?void 0:e.lineItems.digitalItems.length)&&(yield this._paymentIntegrationService.updateShippingAddress(i)),yield this._googlePayPaymentProcessor.setExternalCheckoutForm(this._getMethodOrThrow(),t,o)}))}_getGooglePayClientOptions(){return{paymentDataCallbacks:{onPaymentDataChanged:({callbackTrigger:e,shippingAddress:t,shippingOptionData:n,offerData:i})=>le(this,void 0,void 0,(function*(){const{availableTriggers:o,addressChangeTriggers:a,shippingOptionsChangeTriggers:r,offerChangeTriggers:s}=this._googlePayPaymentProcessor.getCallbackTriggers();if(!o.includes(e))return;const c=a.includes(e)?yield this._googlePayPaymentProcessor.handleShippingAddressChange(t):void 0;r.includes(e)&&(yield this._googlePayPaymentProcessor.handleShippingOptionChange(n.id));const{newOfferInfo:d,error:l}=s.includes(e)?yield this._googlePayPaymentProcessor.handleCoupons(i):{},u=l;return this._buyNowInitializeOptions?this._getBuyNowTransactionInfo(c,d,u):this._getTransactionInfo(c,d,u)}))}}}_createBuyNowCartOrThrow(e){return le(this,void 0,void 0,(function*(){if("function"==typeof(null==e?void 0:e.getBuyNowCartRequestBody)){const t=e.getBuyNowCartRequestBody();try{this._buyNowCart=yield this._paymentIntegrationService.createBuyNowCart(t),yield this._paymentIntegrationService.loadCheckout(this._buyNowCart.id)}catch(e){if("string"==typeof e)throw new se(e);throw e}}}))}_getBuyNowTransactionInfo(e,t,n){if(!this._buyNowCart)return;const{cartAmount:i}=this._buyNowCart,o=this._googlePayPaymentProcessor.getTotalPrice();return Object.assign(Object.assign(Object.assign({newTransactionInfo:Object.assign(Object.assign({},this._countryCode&&{countryCode:this._countryCode}),{currencyCode:this._getCurrencyCodeOrThrow(),totalPrice:o||String(i),totalPriceStatus:Q.FINAL})},e&&{newShippingOptionParameters:e}),t&&{newOfferInfo:t}),n&&{error:n})}_getTransactionInfo(e,t,n){return le(this,void 0,void 0,(function*(){yield this._paymentIntegrationService.loadCheckout();const i=this._googlePayPaymentProcessor.getTotalPrice(),{code:o}=this._paymentIntegrationService.getState().getCartOrThrow().currency;return Object.assign(Object.assign(Object.assign({newTransactionInfo:Object.assign(Object.assign({},this._countryCode&&{countryCode:this._countryCode}),{currencyCode:o,totalPriceStatus:Q.FINAL,totalPrice:i})},e&&{newShippingOptionParameters:e}),t&&{newOfferInfo:t}),n&&{error:n})}))}_getMethodOrThrow(){return V(this._methodId,(()=>new S(p.PaymentNotInitialized)))}_getCurrencyCodeOrThrow(){return V(this._currencyCode,(()=>new j('Unable to initialize payment because "options.currencyCode" argument is not provided.')))}}const he={"X-Checkout-SDK-Version":"1.808.0"};var ye=function(e,t,n,i){return new(n||(n=Promise))((function(o,a){function r(e){try{c(i.next(e))}catch(e){a(e)}}function s(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,s)}c((i=i.apply(e,t||[])).next())}))};class ge{constructor(e,t,n,i){this._scriptLoader=e,this._gateway=t,this._requestSender=n,this._formPoster=i,this._baseRequest={apiVersion:2,apiVersionMinor:0}}initialize(e,t,n,i){return ye(this,void 0,void 0,(function*(){this._paymentsClient=yield this._scriptLoader.getGooglePaymentsClient(e().config.testMode,t),yield this._gateway.initialize(e,n,i),this._buildButtonPayloads()}))}initializeWidget(){return ye(this,void 0,void 0,(function*(){yield this._buildWidgetPayloads(),yield this._determineReadinessToPay(),this._prefetchGooglePaymentData()}))}getNonce(e){return this._gateway.getNonce(e)}extraPaymentData(){return ye(this,void 0,void 0,(function*(){return this._gateway.extraPaymentData()}))}addPaymentButton(e,t){const n=document.querySelector(`#${e}`);if(!n)return;const i=this._getPaymentsClient().createButton(Object.assign(Object.assign({},t),{allowedPaymentMethods:[this._getBaseCardPaymentMethod()]}));return n.appendChild(i)}showPaymentSheet(){return ye(this,void 0,void 0,(function*(){const e=this._getPaymentDataRequest();return this._getPaymentsClient().loadPaymentData(e)}))}setExternalCheckoutXhr(e,t){return ye(this,void 0,void 0,(function*(){return this._setExternalCheckout(e,t)}))}setExternalCheckoutForm(e,t,n){return ye(this,void 0,void 0,(function*(){return this._setExternalCheckout(e,t,!0,n)}))}mapToBillingAddressRequestBody(e){return this._gateway.mapToBillingAddressRequestBody(e)}mapToShippingAddressRequestBody(e){return this._gateway.mapToShippingAddressRequestBody(e)}processAdditionalAction(e,t){return"processAdditionalAction"in this._gateway?this._gateway.processAdditionalAction(e,t):Promise.reject(e)}signOut(e){return ye(this,void 0,void 0,(function*(){yield this._requestSender.get(`/remote-checkout/${e}/signout`)}))}getCallbackTriggers(){return this._gateway.getCallbackTriggers()}handleShippingAddressChange(e){return ye(this,void 0,void 0,(function*(){return this._gateway.handleShippingAddressChange(e)}))}handleShippingOptionChange(e){return ye(this,void 0,void 0,(function*(){yield this._gateway.handleShippingOptionChange(e)}))}handleCoupons(e){return ye(this,void 0,void 0,(function*(){return this._gateway.handleCoupons(e)}))}getTotalPrice(){return this._gateway.getTotalPrice()}_setExternalCheckout(e,t,n=!1,i){return ye(this,void 0,void 0,(function*(){const o="/checkout.php",a=Object.assign({action:"set_external_checkout",provider:e},yield this._gateway.mapToExternalCheckoutData(t));if(n)return new Promise((e=>{this._formPoster.postForm(i?`${i}/checkout`:o,Object.assign(Object.assign({},a),{card_information:JSON.stringify(a.card_information)}),e)}));yield this._requestSender.post(o,{headers:Object.assign({Accept:"text/html","Content-Type":"application/x-www-form-urlencoded"},he),body:a})}))}_prefetchGooglePaymentData(){const e=this._getPaymentDataRequest();e.transactionInfo=this._gateway.getTransactionInfo(),this._getPaymentsClient().prefetchPaymentData(e)}_determineReadinessToPay(){return ye(this,void 0,void 0,(function*(){try{const{result:e}=yield this._getPaymentsClient().isReadyToPay(this._getIsReadyToPayRequest());if(!1===e)throw new re("Google Pay is not supported by the current device and browser, please try another payment method.")}catch(e){if(e instanceof re)throw e;throw new re}}))}_buildButtonPayloads(){this._baseCardPaymentMethod={type:"CARD",parameters:this._gateway.getCardParameters()}}_buildWidgetPayloads(){return ye(this,void 0,void 0,(function*(){const e=this._getBaseCardPaymentMethod();this._cardPaymentMethod=Object.assign(Object.assign({},e),{tokenizationSpecification:{type:"PAYMENT_GATEWAY",parameters:yield this._gateway.getPaymentGatewayParameters()}}),this._paymentDataRequest=Object.assign(Object.assign(Object.assign(Object.assign({},this._baseRequest),{allowedPaymentMethods:[this._cardPaymentMethod],transactionInfo:this._gateway.getTransactionInfo(),merchantInfo:this._gateway.getMerchantInfo()}),yield this._gateway.getRequiredData()),{callbackIntents:this._gateway.getCallbackIntents(),offerInfo:this._gateway.getAppliedCoupons()}),this._isReadyToPayRequest=Object.assign(Object.assign({},this._baseRequest),{allowedPaymentMethods:[e]})}))}_getBaseCardPaymentMethod(){return this._getOrThrow(this._baseCardPaymentMethod)}_getPaymentDataRequest(){return this._getOrThrow(this._paymentDataRequest)}_getIsReadyToPayRequest(){return this._getOrThrow(this._isReadyToPayRequest)}_getPaymentsClient(){return this._getOrThrow(this._paymentsClient)}_getOrThrow(e){return V(e,(()=>new S(p.PaymentNotInitialized)))}}class pe{constructor(e){this._scriptLoader=e,this._window=window}getGooglePaymentsClient(e=!1,t){return n=this,o=function*(){if(yield this._scriptLoader.loadScript("https://pay.google.com/gp/p/js/pay.js"),!this._window.google)throw new E;return void 0===this._paymentsClient&&(this._paymentsClient=new this._window.google.payments.api.PaymentsClient(Object.assign({environment:e?"TEST":"PRODUCTION"},null!=t?t:{}))),this._paymentsClient},new((i=void 0)||(i=Promise))((function(e,t){function a(e){try{s(o.next(e))}catch(e){t(e)}}function r(e){try{s(o.throw(e))}catch(e){t(e)}}function s(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(a,r)}s((o=o.apply(n,[])).next())}));var n,i,o}}function me(){return new pe((0,a.vQ)())}B((e=>{const t=(0,o.createRequestSender)(),n=window,r=new h(e),s=new T(new x((0,a.vQ)(),n,r));return new ue(e,new ge(me(),new oe(e,s),t,(0,i.createFormPoster)()))}),[{id:"googlepaybraintree"}]);var fe=function(e,t,n,i){return new(n||(n=Promise))((function(o,a){function r(e){try{c(i.next(e))}catch(e){a(e)}}function s(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,s)}c((i=i.apply(e,t||[])).next())}))};class we{constructor(e){this.scriptLoader=e,this.window=window}getPayPalFastlaneSdk(e,t,n){return fe(this,void 0,void 0,(function*(){if(!this.window.paypalFastlaneSdk){const i=this.getPayPalFastlaneSdkConfiguration(e,t,n);if(yield this.loadPayPalSdk(i),!this.window.paypalFastlaneSdk)throw new E}return this.window.paypalFastlaneSdk}))}getPayPalGooglePaySdk(e,t,n,i){return fe(this,void 0,void 0,(function*(){if(!this.window.paypalGooglePay||i){const i=this.getPayPalGooglePaySdkScriptConfigOrThrow(e,t,n);yield this.loadPayPalSdk(i)}if(!this.window.paypalGooglePay)throw new E;return this.window.paypalGooglePay}))}getPayPalApmsSdk(e,t){return fe(this,void 0,void 0,(function*(){if(!this.window.paypalApms){const n=this.getPayPalApmSdkConfiguration(e,t);if(yield this.loadPayPalSdk(n),!this.window.paypalApms)throw new E}return this.window.paypalApms}))}getPayPalMessages(e,t){return fe(this,void 0,void 0,(function*(){if(!this.window.paypalMessages){const n=this.getPayPalSdkMessagesConfiguration(e,t);yield this.loadPayPalSdk(n)}if(!this.window.paypalMessages)throw new E;return this.window.paypalMessages}))}loadPayPalSdk({options:e,attributes:t}){return fe(this,void 0,void 0,(function*(){const n=this.transformConfig(e),i=this.transformConfig(t),o=`https://www.paypal.com/sdk/js?${new URLSearchParams(n).toString()}`;yield this.scriptLoader.loadScript(o,{async:!0,attributes:i})}))}getPayPalFastlaneSdkConfiguration(e,t,n){const{clientToken:i,initializationData:o}=e;if(!o||!o.clientId)throw new z(D.MissingPaymentMethod);const{intent:a,clientId:r,merchantId:s,attributionId:c}=o;return{options:{"client-id":r,"merchant-id":s,commit:!0,components:["fastlane","buttons","payment-fields","hosted-fields","three-domain-secure"],currency:t,intent:a},attributes:{"data-client-metadata-id":n.replace(/-/g,""),"data-namespace":"paypalFastlaneSdk","data-partner-attribution-id":c,"data-sdk-client-token":i}}}getPayPalGooglePaySdkScriptConfigOrThrow(e,t,n=!0){const{clientToken:i,initializationData:o}=e;if(!o||!o.clientId)throw new z(D.MissingPaymentMethod);const{intent:a,clientId:r,merchantId:s,buyerCountry:c,attributionId:d,isHostedCheckoutEnabled:l,isDeveloperModeApplicable:u}=o,h=l||n;return{options:Object.assign({"client-id":r,"merchant-id":s,commit:h,components:["googlepay"],currency:t,intent:a},u&&{"buyer-country":c}),attributes:{"data-partner-attribution-id":d,"data-client-token":i,"data-namespace":"paypalGooglePay"}}}getPayPalApmSdkConfiguration(e,t){const{initializationData:n}=e;if(!n||!n.clientId)throw new z(D.MissingPaymentMethod);const{intent:i,clientId:o,merchantId:a,buyerCountry:r,attributionId:s,isDeveloperModeApplicable:c,availableAlternativePaymentMethods:d=[],enabledAlternativePaymentMethods:l=[]}=n,u=l,h=d.filter((e=>!l.includes(e)));return{options:Object.assign({"client-id":o,"merchant-id":a,"enable-funding":u.length>0?u:void 0,"disable-funding":h.length>0?h:void 0,commit:!0,components:["buttons","payment-fields"],currency:t,intent:i},c&&{"buyer-country":r}),attributes:{"data-partner-attribution-id":s,"data-namespace":"paypalApms"}}}getPayPalSdkMessagesConfiguration(e,t){const{initializationData:n}=e;if(!n||!n.clientId)throw new z(D.MissingPaymentMethod);const{clientId:i,merchantId:o,attributionId:a,isDeveloperModeApplicable:r,buyerCountry:s}=n;return{options:Object.assign({"client-id":i,"merchant-id":o,components:["messages"],currency:t},r&&{"buyer-country":s}),attributes:{"data-namespace":"paypalMessages","data-partner-attribution-id":a}}}transformConfig(e){let t={};return Object.keys(e).forEach((n=>{const i=e[n];null==i||""===i||Array.isArray(i)&&0===i.length||(t=Object.assign(Object.assign({},t),{[n]:Array.isArray(i)?i.join(","):i}))})),t}}function Pe(e){if(!function(e){return!!e.initializationData&&"attributionId"in e.initializationData&&"isVenmoEnabled"in e.initializationData&&"isGooglePayEnabled"in e.initializationData&&"isPayPalCreditAvailable"in e.initializationData}(e))throw new z(D.MissingPaymentMethod)}var ve=function(e,t,n,i){return new(n||(n=Promise))((function(o,a){function r(e){try{c(i.next(e))}catch(e){a(e)}}function s(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,s)}c((i=i.apply(e,t||[])).next())}))};class _e extends ne{constructor(e,t){super("paypalsb",e),this.payPalCommerceSdk=t,this.service=e}initialize(e,t,n){const i=Object.create(null,{initialize:{get:()=>super.initialize},getPaymentMethod:{get:()=>super.getPaymentMethod}});var o,a,r,s,c;return ve(this,void 0,void 0,(function*(){const d=null!==(a=null===(o=this.service.getState().getStoreConfig())||void 0===o?void 0:o.currency.code)&&void 0!==a?a:n;if(!d)throw new z(D.MissingPaymentMethod);yield i.initialize.call(this,e,t,d);const l=i.getPaymentMethod.call(this);if(!l.initializationData)throw new z(D.MissingPaymentMethod);Pe(l);const u=yield this.payPalCommerceSdk.getPayPalGooglePaySdk(l,d);this.googlepayConfig=yield u.Googlepay().config();const{allowedPaymentMethods:h}=this.googlepayConfig;this.setGatewayIdentifier(null===(c=null===(s=null===(r=h[0])||void 0===r?void 0:r.tokenizationSpecification)||void 0===s?void 0:s.parameters)||void 0===c?void 0:c.gateway)}))}getPaymentGatewayParameters(){if(this.googlepayConfig){const{allowedPaymentMethods:e}=this.googlepayConfig,{gatewayMerchantId:t}=e[0].tokenizationSpecification.parameters;return{gateway:this.getGatewayIdentifier(),gatewayMerchantId:t}}return{gateway:this.getGatewayIdentifier()}}mapToExternalCheckoutData(e){const t=Object.create(null,{mapToExternalCheckoutData:{get:()=>super.mapToExternalCheckoutData}});return ve(this,void 0,void 0,(function*(){const n=yield t.mapToExternalCheckoutData.call(this,e);return n.nonce=btoa(n.nonce),n}))}}B((e=>new ue(e,new ge(me(),new _e(e,new we((0,a.vQ)())),(0,o.createRequestSender)(),(0,i.createFormPoster)()))),[{id:"googlepaypaypalcommerce"}]);var be=function(e,t,n,i){return new(n||(n=Promise))((function(o,a){function r(e){try{c(i.next(e))}catch(e){a(e)}}function s(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,s)}c((i=i.apply(e,t||[])).next())}))};class Ce{constructor(e){this.scriptLoader=e,this.window=window}getPayPalFastlaneSdk(e,t,n){return be(this,void 0,void 0,(function*(){if(!this.window.paypalFastlaneSdk){const i=this.getPayPalFastlaneSdkConfiguration(e,t,n);if(yield this.loadPayPalSdk(i),!this.window.paypalFastlaneSdk)throw new E}return this.window.paypalFastlaneSdk}))}getPayPalGooglePaySdk(e,t,n,i){return be(this,void 0,void 0,(function*(){if(!this.window.paypalGooglePay||i){const i=this.getPayPalGooglePaySdkScriptConfigOrThrow(e,t,n);yield this.loadPayPalSdk(i)}if(!this.window.paypalGooglePay)throw new E;return this.window.paypalGooglePay}))}getPayPalApmsSdk(e,t){return be(this,void 0,void 0,(function*(){if(!this.window.paypalApms){const n=this.getPayPalApmSdkConfiguration(e,t);if(yield this.loadPayPalSdk(n),!this.window.paypalApms)throw new E}return this.window.paypalApms}))}getPayPalMessages(e,t){return be(this,void 0,void 0,(function*(){if(!this.window.paypalMessages){const n=this.getPayPalSdkMessagesConfiguration(e,t);yield this.loadPayPalSdk(n)}if(!this.window.paypalMessages)throw new E;return this.window.paypalMessages}))}loadPayPalSdk({options:e,attributes:t}){return be(this,void 0,void 0,(function*(){const n=this.transformConfig(e),i=this.transformConfig(t),o=`https://www.paypal.com/sdk/js?${new URLSearchParams(n).toString()}`;yield this.scriptLoader.loadScript(o,{async:!0,attributes:i})}))}getPayPalFastlaneSdkConfiguration(e,t,n){const{clientToken:i,initializationData:o}=e;if(!o||!o.clientId)throw new z(D.MissingPaymentMethod);const{intent:a,clientId:r,merchantId:s,attributionId:c}=o;return{options:{"client-id":r,"merchant-id":s,commit:!0,components:["fastlane","three-domain-secure"],currency:t,intent:a},attributes:{"data-client-metadata-id":n.replace(/-/g,""),"data-namespace":"paypalFastlaneSdk","data-partner-attribution-id":c,"data-sdk-client-token":i}}}getPayPalGooglePaySdkScriptConfigOrThrow(e,t,n=!0){const{clientToken:i,initializationData:o}=e;if(!o||!o.clientId)throw new z(D.MissingPaymentMethod);const{intent:a,clientId:r,merchantId:s,buyerCountry:c,attributionId:d,isHostedCheckoutEnabled:l,isDeveloperModeApplicable:u}=o,h=l||n;return{options:Object.assign({"client-id":r,"merchant-id":s,commit:h,components:["googlepay"],currency:t,intent:a},u&&{"buyer-country":c}),attributes:{"data-partner-attribution-id":d,"data-client-token":i,"data-namespace":"paypalGooglePay"}}}getPayPalApmSdkConfiguration(e,t){const{initializationData:n}=e;if(!n||!n.clientId)throw new z(D.MissingPaymentMethod);const{intent:i,clientId:o,merchantId:a,buyerCountry:r,attributionId:s,isDeveloperModeApplicable:c,availableAlternativePaymentMethods:d=[],enabledAlternativePaymentMethods:l=[]}=n,u=this.filterFundingOptions(l),h=this.filterFundingOptions(d.filter((e=>!l.includes(e))));return{options:Object.assign({"client-id":o,"merchant-id":a,"enable-funding":u.length>0?u:void 0,"disable-funding":h.length>0?h:void 0,commit:!0,components:["buttons","payment-fields"],currency:t,intent:i},c&&{"buyer-country":r}),attributes:{"data-partner-attribution-id":s,"data-namespace":"paypalApms"}}}getPayPalSdkMessagesConfiguration(e,t){const{initializationData:n}=e;if(!n||!n.clientId)throw new z(D.MissingPaymentMethod);const{clientId:i,merchantId:o,attributionId:a,isDeveloperModeApplicable:r,buyerCountry:s}=n;return{options:Object.assign({"client-id":i,"merchant-id":o,components:["messages"],currency:t},r&&{"buyer-country":s}),attributes:{"data-namespace":"paypalMessages","data-partner-attribution-id":a}}}filterFundingOptions(e){const t=["klarna"];return e?e.filter((e=>!t.includes(e))):[]}transformConfig(e){let t={};return Object.keys(e).forEach((n=>{const i=e[n];null==i||""===i||Array.isArray(i)&&0===i.length||(t=Object.assign(Object.assign({},t),{[n]:Array.isArray(i)?i.join(","):i}))})),t}}var Se=function(e,t,n,i){return new(n||(n=Promise))((function(o,a){function r(e){try{c(i.next(e))}catch(e){a(e)}}function s(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,s)}c((i=i.apply(e,t||[])).next())}))};class Ie extends ne{constructor(e,t){super("googlepay_bigcommerce_payments",e),this.payPalSdkHelper=t,this.service=e}initialize(e,t,n){const i=Object.create(null,{initialize:{get:()=>super.initialize},getPaymentMethod:{get:()=>super.getPaymentMethod}});var o,a,r,s,c;return Se(this,void 0,void 0,(function*(){const d=null!==(a=null===(o=this.service.getState().getStoreConfig())||void 0===o?void 0:o.currency.code)&&void 0!==a?a:n;if(!d)throw new z(D.MissingPaymentMethod);yield i.initialize.call(this,e,t,d);const l=i.getPaymentMethod.call(this);if(!l.initializationData)throw new z(D.MissingPaymentMethod);Pe(l);const u=yield this.payPalSdkHelper.getPayPalGooglePaySdk(l,d);this.googlepayConfig=yield u.Googlepay().config();const{allowedPaymentMethods:h}=this.googlepayConfig;this.setGatewayIdentifier(null===(c=null===(s=null===(r=h[0])||void 0===r?void 0:r.tokenizationSpecification)||void 0===s?void 0:s.parameters)||void 0===c?void 0:c.gateway)}))}getPaymentGatewayParameters(){if(this.googlepayConfig){const{allowedPaymentMethods:e}=this.googlepayConfig,{gatewayMerchantId:t}=e[0].tokenizationSpecification.parameters;return{gateway:this.getGatewayIdentifier(),gatewayMerchantId:t}}return{gateway:this.getGatewayIdentifier()}}mapToExternalCheckoutData(e){const t=Object.create(null,{mapToExternalCheckoutData:{get:()=>super.mapToExternalCheckoutData}});return Se(this,void 0,void 0,(function*(){const n=yield t.mapToExternalCheckoutData.call(this,e);return n.nonce=btoa(n.nonce),n}))}}B((e=>new ue(e,new ge(me(),new Ie(e,new Ce((0,a.vQ)())),(0,o.createRequestSender)(),(0,i.createFormPoster)()))),[{id:"googlepay_bigcommerce_payments"}]),B((e=>{const t=(0,o.createRequestSender)();return new ue(e,new ge(me(),new ne("adyen",e),t,(0,i.createFormPoster)()))}),[{id:"googlepayadyenv2"}]),B((e=>{const t=(0,o.createRequestSender)();return new ue(e,new ge(me(),new ne("adyen",e),t,(0,i.createFormPoster)()))}),[{id:"googlepayadyenv3"}]);class Oe extends ne{constructor(e){super("authorizenet",e)}mapToExternalCheckoutData(e){const t=Object.create(null,{mapToExternalCheckoutData:{get:()=>super.mapToExternalCheckoutData}});return n=this,o=function*(){const n=yield t.mapToExternalCheckoutData.call(this,e);return n.nonce=btoa(n.nonce),n},new((i=void 0)||(i=Promise))((function(e,t){function a(e){try{s(o.next(e))}catch(e){t(e)}}function r(e){try{s(o.throw(e))}catch(e){t(e)}}function s(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(a,r)}s((o=o.apply(n,[])).next())}));var n,i,o}getPaymentGatewayParameters(){const e=this.getGooglePayInitializationData();return function(e){if(!function(e){return"paymentGatewayId"in e}(e))throw new z(D.MissingPaymentMethod)}(e),{gateway:this.getGatewayIdentifier(),gatewayMerchantId:e.paymentGatewayId}}}B((e=>new ue(e,new ge(me(),new Oe(e),(0,o.createRequestSender)(),(0,i.createFormPoster)()))),[{id:"googlepayauthorizenet"}]);const ke=e=>"object"==typeof e&&null!==e&&"body"in e;var Ae;!function(e){e.Json="application/json",e.JsonV1="application/vnd.bc.v1+json"}(Ae||(Ae={}));const Te=Ae;function Ee(e){if(!function(e){return"checkoutcomkey"in e}(e))throw new z(D.MissingPaymentMethod)}var Me=function(e,t,n,i){return new(n||(n=Promise))((function(o,a){function r(e){try{c(i.next(e))}catch(e){a(e)}}function s(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,s)}c((i=i.apply(e,t||[])).next())}))};class De extends ne{constructor(e,t){super("checkoutltd",e),this._requestSender=t}processAdditionalAction(e){return new Promise(((t,n)=>{if(ke(e)&&function(e){var t;if("object"!=typeof e||null===e)return!1;const n=e;return"string"==typeof(null===(t=n.three_ds_result)||void 0===t?void 0:t.acs_url)&&"string"==typeof n.three_ds_result.code}(e.body)&&"three_d_secure_required"===e.body.three_ds_result.code)return window.location.assign(e.body.three_ds_result.acs_url);n(e)}))}mapToExternalCheckoutData(e){const t=Object.create(null,{mapToExternalCheckoutData:{get:()=>super.mapToExternalCheckoutData}});return Me(this,void 0,void 0,(function*(){const n=yield t.mapToExternalCheckoutData.call(this,e);let i;try{i=JSON.parse(n.nonce)}catch(e){throw new j("Unable to parse response from Google Pay.")}return function(e){if(!function(e){return"object"==typeof e&&null!==e&&"protocolVersion"in e&&"signature"in e&&"signedMessage"in e}(e))throw new z(D.MissingPaymentToken)}(i),n.nonce=yield this._tokenize(i),n}))}getPaymentGatewayParameters(){const e=this.getGooglePayInitializationData();return Ee(e),{gateway:this.getGatewayIdentifier(),gatewayMerchantId:e.checkoutcomkey}}_tokenize(e){return Me(this,void 0,void 0,(function*(){const t=this.getPaymentMethod().config.testMode?"https://api.sandbox.checkout.com/tokens":"https://api.checkout.com/tokens",n=this.getGooglePayInitializationData();Ee(n);const{body:i}=yield this._requestSender.post(t,{credentials:!1,body:{type:"googlepay",token_data:e},headers:{Authorization:n.checkoutcomkey,"Content-Type":Te.Json,"X-XSRF-TOKEN":null}});return i.token}))}}B((e=>{const t=(0,o.createRequestSender)();return new ue(e,new ge(me(),new De(e,t),t,(0,i.createFormPoster)()))}),[{id:"googlepaycheckoutcom"}]);class Ne extends ne{constructor(e){super("cybersource",e)}mapToExternalCheckoutData(e){const t=Object.create(null,{mapToExternalCheckoutData:{get:()=>super.mapToExternalCheckoutData}});return n=this,o=function*(){const n=yield t.mapToExternalCheckoutData.call(this,e);return n.nonce=btoa(n.nonce),n},new((i=void 0)||(i=Promise))((function(e,t){function a(e){try{s(o.next(e))}catch(e){t(e)}}function r(e){try{s(o.throw(e))}catch(e){t(e)}}function s(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(a,r)}s((o=o.apply(n,[])).next())}));var n,i,o}}B((e=>new ue(e,new ge(me(),new Ne(e),(0,o.createRequestSender)(),(0,i.createFormPoster)()))),[{id:"googlepaycybersourcev2"},{id:"googlepaybnz"}]);class Re extends ne{constructor(e){super("chase",e)}mapToExternalCheckoutData(e){const t=Object.create(null,{mapToExternalCheckoutData:{get:()=>super.mapToExternalCheckoutData}});return n=this,o=function*(){const n=yield t.mapToExternalCheckoutData.call(this,e);return n.nonce=btoa(n.nonce),n},new((i=void 0)||(i=Promise))((function(e,t){function a(e){try{s(o.next(e))}catch(e){t(e)}}function r(e){try{s(o.throw(e))}catch(e){t(e)}}function s(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(a,r)}s((o=o.apply(n,[])).next())}));var n,i,o}}B((e=>new ue(e,new ge(me(),new Re(e),(0,o.createRequestSender)(),(0,i.createFormPoster)()))),[{id:"googlepayorbital"}]);class xe extends j{constructor(e){let t="Unable to submit payment for the order because the payload is invalid.";e&&(t=`${t} Make sure the following fields are provided correctly: ${e.join(", ")}.`),super(t),this.name="PaymentArgumentInvalidError"}}const Be={body:{},headers:{},status:0};class ze extends y{constructor(e,{message:t,errors:n}={}){const{body:i,headers:o,status:a}=e||Be;super(t||"An unexpected error has occurred."),this.name="RequestError",this.type="request",this.body=i,this.headers=o,this.status=a,this.errors=n||[]}}function je(e){if(!function(e){return"stripeConnectedAccount"in e&&"stripePublishableKey"in e&&"stripeVersion"in e}(e))throw new z(D.MissingPaymentMethod)}var Ge=function(e,t,n,i){return new(n||(n=Promise))((function(o,a){function r(e){try{c(i.next(e))}catch(e){a(e)}}function s(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,s)}c((i=i.apply(e,t||[])).next())}))};class Fe extends ne{constructor(e,t){super("stripe",e),this.paymentIntegrationService=e,this.scriptLoader=t}mapToExternalCheckoutData(e){const t=Object.create(null,{mapToExternalCheckoutData:{get:()=>super.mapToExternalCheckoutData}});return Ge(this,void 0,void 0,(function*(){const n=yield t.mapToExternalCheckoutData.call(this,e);let i;try{i=JSON.parse(n.nonce)}catch(e){throw new j("Unable to parse response from Google Pay.")}return function(e){if(!function(e){return"object"==typeof e&&null!==e&&"id"in e}(e))throw new z(D.MissingPaymentToken)}(i),n.nonce=i.id,n}))}getPaymentGatewayParameters(){const e=this.getGooglePayInitializationData();je(e);const{stripeVersion:t,stripePublishableKey:n,stripeConnectedAccount:i}=e;return{gateway:this.getGatewayIdentifier(),"stripe:version":t,"stripe:publishableKey":`${n}/${i}`}}processAdditionalAction(e,t){var n,i;return Ge(this,void 0,void 0,(function*(){if(!t)throw new xe(["payment"]);if(!ke(e)||"object"!=typeof(o=e.body)||null===o||!("three_ds_result"in o)||!("errors"in o))throw e;var o;const a=this.paymentIntegrationService.getState(),s=null===(n=a.getStoreConfig())||void 0===n?void 0:n.checkoutSettings.features["STRIPE-476.enable_stripe_googlepay_3ds"];if((0,r.some)(e.body.errors,{code:"three_d_secure_required"})&&s){const n=this.getGooglePayInitializationData();je(n);const{stripePublishableKey:o,stripeConnectedAccount:a}=n;this.stripeUPEClient=yield this.loadStripeJs(o,a);const r=e.body.three_ds_result.token;let s,c=!1;try{s=yield this.stripeUPEClient.confirmCardPayment(r)}catch(e){try{s=yield this.stripeUPEClient.retrievePaymentIntent(r)}catch(e){c=!0}}if(null==s?void 0:s.error){if(this._throwDisplayableStripeError(s.error),this._isCancellationError(s.error))throw new ae;throw new re}if(!(null==s?void 0:s.paymentIntent)&&!c)throw new ze;return this.paymentIntegrationService.submitPayment({methodId:t,paymentData:{nonce:(null===(i=null==s?void 0:s.paymentIntent)||void 0===i?void 0:i.id)||r}})}throw e}))}loadStripeJs(e,t){return Ge(this,void 0,void 0,(function*(){return this.stripeUPEClient?this.stripeUPEClient:this.scriptLoader.getStripeClient(e,t)}))}_isCancellationError(e){var t,n;return e&&-1!==(null===(n=null===(t=e.payment_intent.last_payment_error)||void 0===t?void 0:t.message)||void 0===n?void 0:n.indexOf("canceled"))}_throwDisplayableStripeError(e){if((0,r.includes)(["card_error","invalid_request_error","validation_error"],e.type))throw new Error(e.message)}}var Le=function(e,t,n,i){return new(n||(n=Promise))((function(o,a){function r(e){try{c(i.next(e))}catch(e){a(e)}}function s(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,s)}c((i=i.apply(e,t||[])).next())}))};class qe{constructor(e,t=window){this.scriptLoader=e,this.stripeWindow=t}getStripeClient(e,t,n){return Le(this,void 0,void 0,(function*(){let i=this.stripeWindow.bcStripeClient;return i||(i=(yield this.load())(e,{stripeAccount:t,locale:n,betas:["payment_element_beta_2","alipay_pm_beta_1","link_default_integration_beta_1","shipping_address_element_beta_1","address_element_beta_1"],apiVersion:"2020-03-02;alipay_beta=v1;link_beta=v1"}),Object.assign(this.stripeWindow,{bcStripeClient:i})),i}))}load(){return Le(this,void 0,void 0,(function*(){if(this.stripeWindow.Stripe||(yield this.scriptLoader.loadScript("https://js.stripe.com/v3/")),!this.stripeWindow.Stripe)throw new E;return this.stripeWindow.Stripe}))}}B((e=>new ue(e,new ge(me(),new Fe(e,new qe((0,a.vQ)())),(0,o.createRequestSender)(),(0,i.createFormPoster)()))),[{id:"googlepaystripe"},{id:"googlepaystripeupe"},{id:"googlepaystripeocs"}]);class Ue extends ne{constructor(e){super("worldpay",e)}mapToExternalCheckoutData(e){const t=Object.create(null,{mapToExternalCheckoutData:{get:()=>super.mapToExternalCheckoutData}});return n=this,o=function*(){const n=yield t.mapToExternalCheckoutData.call(this,e);return n.nonce=btoa(n.nonce),n},new((i=void 0)||(i=Promise))((function(e,t){function a(e){try{s(o.next(e))}catch(e){t(e)}}function r(e){try{s(o.throw(e))}catch(e){t(e)}}function s(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(a,r)}s((o=o.apply(n,[])).next())}));var n,i,o}}B((e=>new ue(e,new ge(me(),new Ue(e),(0,o.createRequestSender)(),(0,i.createFormPoster)()))),[{id:"googlepayworldpayaccess"}]);function Ve(){const{navigator:e}=window;let t;return t=e.language?e.language:e.userLanguage,{color_depth:window.screen.colorDepth||24,java_enabled:"function"==typeof e.javaEnabled&&e.javaEnabled(),language:t,screen_height:window.screen.height,screen_width:window.screen.width,time_zone_offset:(new Date).getTimezoneOffset().toString()}}var He=function(e,t,n,i){return new(n||(n=Promise))((function(o,a){function r(e){try{c(i.next(e))}catch(e){a(e)}}function s(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,s)}c((i=i.apply(e,t||[])).next())}))};class We extends ne{constructor(e,t){super("worldlinena",e),this.formPoster=t}extraPaymentData(){return He(this,void 0,void 0,(function*(){return Promise.resolve({browser_info:Ve()})}))}processAdditionalAction(e){return He(this,void 0,void 0,(function*(){if(!function(e){return ke(e)&&(t=e.body,(0,r.isObject)(t)&&"object"==typeof t&&"errors"in t&&"three_ds_result"in t&&(0,r.isArray)(t.errors)&&(0,r.some)(t.errors,{code:"three_d_secure_required"}));var t}(e))throw e;const{three_ds_result:t}=e.body,{acs_url:n,payer_auth_request:i,merchant_data:o}=t||{};if(!n||!i||!o)throw new xe(["formUrl","threeDSSessionData","creq"]);return new Promise((e=>{this.formPoster.postForm(n,{threeDSSessionData:i,creq:o},e,"_top")}))}))}}B((e=>new ue(e,new ge(me(),new We(e,(0,i.createFormPoster)()),(0,o.createRequestSender)(),(0,i.createFormPoster)()))),[{id:"googlepaytdonlinemart"}]);class Ye{constructor(e,t,n=window){this._scriptLoader=e,this._stylesheetLoader=t,this._window=n}load(e){var t,n,i,o,a;return i=this,a=function*(){if(yield Promise.all([this._stylesheetLoader.loadStylesheet(`https://checkoutshopper-${null!==(t=e.environment)&&void 0!==t?t:""}.adyen.com/checkoutshopper/sdk/3.10.1/adyen.css`,{prepend:!1,attributes:{integrity:"sha384-8ofgICZZ/k5cC5N7xegqFZOA73H9RQ7H13439JfAZW8Gj3qjuKL2isaTD3GMIhDE",crossorigin:"anonymous"}}),this._scriptLoader.loadScript(`https://checkoutshopper-${null!==(n=e.environment)&&void 0!==n?n:""}.adyen.com/checkoutshopper/sdk/3.10.1/adyen.js`,{async:!0,attributes:{integrity:"sha384-wG2z9zSQo61EIvyXmiFCo+zB3y0ZB4hsrXVcANmpP8HLthjoQJQPBh7tZKJSV8jA",crossorigin:"anonymous"}})]),!this._window.AdyenCheckout)throw new E;return new this._window.AdyenCheckout(e)},new((o=void 0)||(o=Promise))((function(e,t){function n(e){try{s(a.next(e))}catch(e){t(e)}}function r(e){try{s(a.throw(e))}catch(e){t(e)}}function s(t){var i;t.done?e(t.value):(i=t.value,i instanceof o?i:new o((function(e){e(i)}))).then(n,r)}s((a=a.apply(i,[])).next())}))}}function Je(e){return"object"==typeof e&&null!==e&&"errors"in e&&Array.isArray(e.errors)&&"code"in e.errors[0]&&"string"==typeof e.errors[0].code&&"provider_data"in e&&"object"==typeof e.provider_data}var Qe=function(e,t,n,i){return new(n||(n=Promise))((function(o,a){function r(e){try{c(i.next(e))}catch(e){a(e)}}function s(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,s)}c((i=i.apply(e,t||[])).next())}))};class Ke extends ne{constructor(e,t){super("adyen",e),this._scriptLoader=t,this._service=e}initialize(e,t,n){const i=Object.create(null,{initialize:{get:()=>super.initialize},getPaymentMethod:{get:()=>super.getPaymentMethod}});return Qe(this,void 0,void 0,(function*(){yield i.initialize.call(this,e,t,n);const o=i.getPaymentMethod.call(this),a=this._service.getState().getStoreConfig();if(!a)throw new z(D.MissingCheckoutConfig);return this._adyenClient=yield this._scriptLoader.load({environment:o.config.testMode?"test":"live",locale:a.storeProfile.storeLanguage}),Promise.resolve()}))}getNonce(e){const t=Object.create(null,{getNonce:{get:()=>super.getNonce},getPaymentMethod:{get:()=>super.getPaymentMethod}});return Qe(this,void 0,void 0,(function*(){const n=yield t.getNonce.call(this,e),i=t.getPaymentMethod.call(this);return JSON.stringify({type:i.method,googlePayToken:n,browser_info:Ve()})}))}processAdditionalAction(e){return Qe(this,void 0,void 0,(function*(){if(!ke(e)||!Je(e.body))throw e;const t=yield this._handleAction(e.body.provider_data);try{return yield this._service.submitPayment(t)}catch(e){return this.processAdditionalAction(e)}}))}_handleAction(e){return new Promise(((t,n)=>{const i=JSON.parse(e.action);this._getAdyenClient().createFromAction(i,{onAdditionalDetails:e=>{const n={methodId:i.paymentMethodType,paymentData:{nonce:JSON.stringify(e.data)}};t(n)},size:"05",onError:e=>n(e)}).mount("body"),n(new ae)}))}_getAdyenClient(){if(!this._adyenClient)throw new S(p.PaymentNotInitialized);return this._adyenClient}}class Ze extends y{constructor(){super("The current order does not need to be finalized at this stage."),this.name="OrderFinalizationNotRequiredError",this.type="order_finalization_not_required"}}const Xe={size:70,color:"#d9d9d9",backgroundColor:"#ffffff"},$e={position:"fixed","background-color":"rgba(0, 0, 0, 0.4)","z-index":"1000"},et="embedded-checkout-loading-indicator-rotation";class tt{constructor(e){this.styles=Object.assign(Object.assign({},Xe),e&&e.styles),this.containerStyles=Object.assign({},e&&e.containerStyles),this.defineAnimation(),this.container=this.buildContainer(),this.indicator=this.buildIndicator(),this.container.appendChild(this.indicator)}show(e){if(e){const t=document.getElementById(e);if(!t)throw new Error("Unable to attach the loading indicator because the parent ID is not valid.");t.appendChild(this.container)}this.container.style.visibility="visible",this.container.style.opacity="1"}hide(){const e=()=>{this.container.style.visibility="hidden",this.container.removeEventListener("transitionend",e)};this.container.addEventListener("transitionend",e),this.container.style.opacity="0"}buildContainer(){const e=document.createElement("div");return e.style.display="block",e.style.bottom="0",e.style.left="0",e.style.height="100%",e.style.width="100%",e.style.position="absolute",e.style.right="0",e.style.top="0",e.style.transition="all 250ms ease-out",e.style.opacity="0",this.setStyleAttribute(e,this.containerStyles),e}buildIndicator(){const e=document.createElement("div");return e.style.display="block",e.style.width=`${this.styles.size}px`,e.style.height=`${this.styles.size}px`,e.style.borderRadius=`${this.styles.size}px`,e.style.border="solid 1px",e.style.borderColor=`${this.styles.backgroundColor} ${this.styles.backgroundColor} ${this.styles.color} ${this.styles.color}`,e.style.margin="0 auto",e.style.position="absolute",e.style.left="0",e.style.right="0",e.style.top="50%",e.style.transform="translateY(-50%) rotate(0deg)",e.style.transformStyle="preserve-3d",e.style.animation=`${et} 500ms infinite cubic-bezier(0.69, 0.31, 0.56, 0.83)`,e}setStyleAttribute(e,t){Object.keys(t).forEach((n=>{e.style.setProperty(n,t[n])}))}defineAnimation(){var e;if(document.getElementById(et))return;const t=document.createElement("style");t.id=et,null===(e=document.head)||void 0===e||e.appendChild(t),t.sheet instanceof CSSStyleSheet&&t.sheet.insertRule(`\n                @keyframes ${et} {\n                    0% { transform: translateY(-50%) rotate(0deg); }\n                    100% { transform: translateY(-50%) rotate(360deg); }\n                }\n            `,0)}}var nt=function(e,t,n,i){return new(n||(n=Promise))((function(o,a){function r(e){try{c(i.next(e))}catch(e){a(e)}}function s(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,s)}c((i=i.apply(e,t||[])).next())}))};class it{constructor(e,t){this._paymentIntegrationService=e,this._googlePayPaymentProcessor=t,this._loadingIndicator=new tt({containerStyles:$e})}initialize(e){var t;return nt(this,void 0,void 0,(function*(){if(!(null==e?void 0:e.methodId)||!de(e.methodId))throw new j('Unable to proceed because "methodId" is not a valid key.');this._methodId=e.methodId;const n=e[this._getMethodId()];if(!(null==n?void 0:n.walletButton))throw new j("Unable to proceed without valid options.");const{walletButton:i,loadingContainerId:o}=n,a=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(i=Object.getOwnPropertySymbols(e);o<i.length;o++)t.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(e,i[o])&&(n[i[o]]=e[i[o]])}return n}(n,["walletButton","loadingContainerId"]);this._loadingIndicatorContainer=o,yield this._paymentIntegrationService.loadPaymentMethod(this._getMethodId());const r=this._paymentIntegrationService.getState().getPaymentMethodOrThrow(this._getMethodId());yield this._googlePayPaymentProcessor.initialize((()=>r),this._getGooglePayClientOptions(null===(t=r.initializationData)||void 0===t?void 0:t.storeCountry)),this._addPaymentButton(i,a)}))}execute({payment:e}){return nt(this,void 0,void 0,(function*(){if(!(null==e?void 0:e.methodId))throw new xe(["payment"]);yield this._paymentIntegrationService.submitOrder();const t=yield this._googlePayPaymentProcessor.getNonce(e.methodId),n=yield this._googlePayPaymentProcessor.extraPaymentData();try{yield this._paymentIntegrationService.submitPayment(Object.assign(Object.assign({},e),{paymentData:Object.assign({nonce:t},n)}))}catch(t){yield this._googlePayPaymentProcessor.processAdditionalAction(t,e.methodId)}}))}finalize(){return Promise.reject(new Ze)}deinitialize(){var e;return this._clickListener&&(null===(e=this._paymentButton)||void 0===e||e.removeEventListener("click",this._clickListener)),this._paymentButton=void 0,this._clickListener=void 0,this._methodId=void 0,Promise.resolve()}_addPaymentButton(e,t){if(this._paymentButton)return;const n=document.getElementById(e);if(!n)throw new j("Unable to proceed without a walletButton.");this._paymentButton=n,this._clickListener=this._handleClick(t),this._paymentButton.addEventListener("click",this._clickListener)}_handleClick({onPaymentSelect:e,onError:t}){return n=>nt(this,void 0,void 0,(function*(){n.preventDefault();try{yield this._googlePayPaymentProcessor.initializeWidget(),yield this._interactWithPaymentSheet()}catch(e){let n=e;if(this._toggleLoadingIndicator(!1),ce(e)){if("CANCELED"===e.statusCode)throw new ae;n=new re(JSON.stringify(e))}throw null==t||t(new re("An error occurred while requesting your Google Pay payment details.")),n}null==e||e()}))}_interactWithPaymentSheet(){return nt(this,void 0,void 0,(function*(){const e=yield this._googlePayPaymentProcessor.showPaymentSheet();this._toggleLoadingIndicator(!0);const t=this._googlePayPaymentProcessor.mapToBillingAddressRequestBody(e);t&&(yield this._paymentIntegrationService.updateBillingAddress(t)),yield this._googlePayPaymentProcessor.setExternalCheckoutXhr(this._getMethodId(),e),yield this._paymentIntegrationService.loadCheckout(),yield this._paymentIntegrationService.loadPaymentMethod(this._getMethodId()),this._toggleLoadingIndicator(!1)}))}_getMethodId(){return V(this._methodId,(()=>new S(p.PaymentNotInitialized)))}_getIsSignedInOrThrow(){return nt(this,void 0,void 0,(function*(){try{return!!(yield this._googlePayPaymentProcessor.getNonce(this._getMethodId()))}catch(e){if(e instanceof z&&e.subtype===D.MissingPaymentToken)return!1;throw e}}))}_handleOfferTrigger(e){return nt(this,void 0,void 0,(function*(){let t=!1,n="Sign in to Google Pay first to apply or remove promo codes.";try{t=yield this._getIsSignedInOrThrow()}catch(e){e instanceof z&&(n=e.message)}if(t){const{newOfferInfo:t,error:n}=yield this._googlePayPaymentProcessor.handleCoupons(e);return{newOfferInfo:t,error:n}}return{error:{reason:X.OFFER_INVALID,message:n,intent:$.OFFER}}}))}_getGooglePayClientOptions(e){return{paymentDataCallbacks:{onPaymentDataChanged:({callbackTrigger:t,offerData:n})=>nt(this,void 0,void 0,(function*(){const i=this._paymentIntegrationService.getState().getStoreConfigOrThrow().checkoutSettings.features["PI-2875.googlepay_coupons_handling"]||!1;if(t!==$.INITIALIZE&&(!i||t!==$.OFFER))return;const{offerChangeTriggers:o}=this._googlePayPaymentProcessor.getCallbackTriggers(),{newOfferInfo:a,error:s}=o.includes(t)?yield this._handleOfferTrigger(n):{},c=s;yield this._paymentIntegrationService.loadCheckout();const{getCheckoutOrThrow:d,getCartOrThrow:l}=this._paymentIntegrationService.getState(),{code:u,decimalPlaces:h}=l().currency,y=(0,r.round)(d().outstandingBalance,h).toFixed(h);return Object.assign(Object.assign({newTransactionInfo:Object.assign(Object.assign({},e&&{countryCode:e}),{currencyCode:u,totalPriceStatus:Q.FINAL,totalPrice:y})},a&&{newOfferInfo:a}),c&&{error:c})}))}}}_toggleLoadingIndicator(e){e&&this._loadingIndicatorContainer?this._loadingIndicator.show(this._loadingIndicatorContainer):this._loadingIndicator.hide()}}const ot=B((e=>new it(e,new ge(me(),new Ke(e,new Ye((0,a.vQ)(),(0,a._U)())),(0,o.createRequestSender)(),(0,i.createFormPoster)()))),[{id:"googlepayadyenv2"}]);class at{constructor(e,t,n=window){this._scriptLoader=e,this._stylesheetLoader=t,this._window=n}load(e){var t,n,i,o,a;return i=this,a=function*(){if(yield Promise.all([this._stylesheetLoader.loadStylesheet(`https://checkoutshopper-${null!==(t=e.environment)&&void 0!==t?t:""}.adyen.com/checkoutshopper/sdk/5.71.1/adyen.css`,{prepend:!1,attributes:{integrity:"sha384-5MvB4RnzvviA3VBT4KYABZ4HXNZG5LRqREEgd41xt/pf/QvKmsj2O9GuNuywRXx9",crossorigin:"anonymous"}}),this._scriptLoader.loadScript(`https://checkoutshopper-${null!==(n=e.environment)&&void 0!==n?n:""}.adyen.com/checkoutshopper/sdk/5.71.1/adyen.js`,{async:!0,attributes:{integrity:"sha384-yvY2yFNR4WqIjPqP9MzjI+gJimmaJnAvj4rLHKvgJbgFD5fMuf8zIJrFJOW8Lhhf",crossorigin:"anonymous"}})]),!this._window.AdyenCheckout)throw new E;return yield this._window.AdyenCheckout(e)},new((o=void 0)||(o=Promise))((function(e,t){function n(e){try{s(a.next(e))}catch(e){t(e)}}function r(e){try{s(a.throw(e))}catch(e){t(e)}}function s(t){var i;t.done?e(t.value):(i=t.value,i instanceof o?i:new o((function(e){e(i)}))).then(n,r)}s((a=a.apply(i,[])).next())}))}}var rt=function(e,t,n,i){return new(n||(n=Promise))((function(o,a){function r(e){try{c(i.next(e))}catch(e){a(e)}}function s(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,s)}c((i=i.apply(e,t||[])).next())}))};class st extends ne{constructor(e,t){super("adyen",e),this._scriptLoader=t,this._service=e}initialize(e,t,n){const i=Object.create(null,{initialize:{get:()=>super.initialize},getPaymentMethod:{get:()=>super.getPaymentMethod}});return rt(this,void 0,void 0,(function*(){yield i.initialize.call(this,e,t,n);const o=i.getPaymentMethod.call(this),a=this._service.getState().getStoreConfig();if(!a)throw new z(D.MissingCheckoutConfig);return this._adyenClient=yield this._scriptLoader.load({environment:o.config.testMode?"test":"live",locale:a.storeProfile.storeLanguage}),Promise.resolve()}))}processAdditionalAction(e){return rt(this,void 0,void 0,(function*(){if(!ke(e)||!Je(e.body))throw e;const t=yield this._handleAction(e.body.provider_data);try{return yield this._service.submitPayment(t)}catch(e){return this.processAdditionalAction(e)}}))}getNonce(e){const t=Object.create(null,{getNonce:{get:()=>super.getNonce},getPaymentMethod:{get:()=>super.getPaymentMethod}});return rt(this,void 0,void 0,(function*(){const n=yield t.getNonce.call(this,e),i=t.getPaymentMethod.call(this);return JSON.stringify({type:i.method,googlePayToken:n,browser_info:Ve()})}))}_handleAction(e){return new Promise(((t,n)=>{const i=JSON.parse(e.action);this._getAdyenClient().createFromAction(i,{onAdditionalDetails:e=>{const n={methodId:i.paymentMethodType,paymentData:{nonce:JSON.stringify(e.data)}};t(n)},size:"05",onError:e=>n(e)}).mount("body"),n(new ae)}))}_getAdyenClient(){if(!this._adyenClient)throw new S(p.PaymentNotInitialized);return this._adyenClient}}const ct=B((e=>new it(e,new ge(me(),new st(e,new at((0,a.vQ)(),(0,a._U)())),(0,o.createRequestSender)(),(0,i.createFormPoster)()))),[{id:"googlepayadyenv3"}]),dt=B((e=>new it(e,new ge(me(),new Oe(e),(0,o.createRequestSender)(),(0,i.createFormPoster)()))),[{id:"googlepayauthorizenet"}]),lt=B((e=>{const t=(0,o.createRequestSender)();return new it(e,new ge(me(),new De(e,t),t,(0,i.createFormPoster)()))}),[{id:"googlepaycheckoutcom"}]),ut=B((e=>new it(e,new ge(me(),new Ne(e),(0,o.createRequestSender)(),(0,i.createFormPoster)()))),[{id:"googlepaycybersourcev2"},{id:"googlepaybnz"}]),ht=B((e=>new it(e,new ge(me(),new Re(e),(0,o.createRequestSender)(),(0,i.createFormPoster)()))),[{id:"googlepayorbital"}]),yt=B((e=>new it(e,new ge(me(),new Fe(e,new qe((0,a.vQ)())),(0,o.createRequestSender)(),(0,i.createFormPoster)()))),[{id:"googlepaystripe"},{id:"googlepaystripeupe"},{id:"googlepaystripeocs"}]),gt=B((e=>new it(e,new ge(me(),new Ue(e),(0,o.createRequestSender)(),(0,i.createFormPoster)()))),[{id:"googlepayworldpayaccess"}]),pt=B((e=>{const t=(0,o.createRequestSender)(),n=window,r=new h(e),s=new T(new x((0,a.vQ)(),n,r));return new it(e,new ge(me(),new oe(e,s),t,(0,i.createFormPoster)()))}),[{id:"googlepaybraintree"}]),mt="This API endpoint is for internal use only and may change in the future";var ft,wt;!function(e){e.Approved="APPROVED",e.PayerActionRequired="PAYER_ACTION_REQUIRED"}(ft||(ft={})),function(e){e.AUTHORIZE="authorize",e.CAPTURE="capture"}(wt||(wt={}));var Pt=function(e,t,n,i){return new(n||(n=Promise))((function(o,a){function r(e){try{c(i.next(e))}catch(e){a(e)}}function s(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,s)}c((i=i.apply(e,t||[])).next())}))};class vt extends it{constructor(e,t,n,i){super(e,t),this._payPalCommerceSdk=n,this._requestSender=i}execute({payment:e}){return Pt(this,void 0,void 0,(function*(){if(!(null==e?void 0:e.methodId))throw new xe(["payment"]);const t=this._paymentIntegrationService.getState(),n=t.getCartOrThrow().id,{initializationData:i}=t.getPaymentMethodOrThrow(this._getMethodId()),{orderId:o}=yield this.getOrderId(n),{card_information:a}=i||{},r=yield this._googlePayPaymentProcessor.getNonce(e.methodId),s={tokenizationData:{type:"PAYMENT_GATEWAY",token:atob(r)},info:{cardNetwork:(null==a?void 0:a.type)||"",cardDetails:(null==a?void 0:a.number)||""},type:"CARD"};yield this.confirmOrder(o,s),yield this._paymentIntegrationService.submitOrder();try{const t={formattedPayload:{method_id:e.methodId,paypal_account:{order_id:o}}};yield this._paymentIntegrationService.submitPayment({methodId:e.methodId,paymentData:t})}catch(e){yield this._googlePayPaymentProcessor.processAdditionalAction(e)}}))}confirmOrder(e,t){return Pt(this,void 0,void 0,(function*(){const n=this._paymentIntegrationService.getState(),i=n.getPaymentMethodOrThrow(this._getMethodId());if(!i.initializationData)throw new z(D.MissingPaymentMethod);const o=n.getCartOrThrow().currency.code,a=yield this._payPalCommerceSdk.getPayPalGooglePaySdk(i,o,!0),{status:r}=yield a.Googlepay().confirmOrder({orderId:e,paymentMethodData:t});if(r===ft.PayerActionRequired)return yield a.Googlepay().initiatePayerAction({orderId:e}),Promise.resolve();if(r!==ft.Approved)throw new j("Payment is not approved.");return Promise.resolve()}))}getOrderId(e){return Pt(this,void 0,void 0,(function*(){const t={cartId:e,shouldSaveInstrument:!1},{body:n}=yield this._requestSender.post("/api/storefront/payments/googlepaypaypalcommercecheckout",{headers:Object.assign({"X-API-INTERNAL":mt,"Content-Type":Te.Json},he),body:t});return n}))}}const _t=B((e=>{const t=new we((0,a.vQ)());return new vt(e,new ge(me(),new _e(e,t),(0,o.createRequestSender)(),(0,i.createFormPoster)()),t,(0,o.createRequestSender)())}),[{id:"googlepaypaypalcommerce"}]);var bt,Ct;!function(e){e.Approved="APPROVED",e.PayerActionRequired="PAYER_ACTION_REQUIRED"}(bt||(bt={})),function(e){e.AUTHORIZE="authorize",e.CAPTURE="capture"}(Ct||(Ct={}));var St=function(e,t,n,i){return new(n||(n=Promise))((function(o,a){function r(e){try{c(i.next(e))}catch(e){a(e)}}function s(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,s)}c((i=i.apply(e,t||[])).next())}))};class It extends it{constructor(e,t,n,i){super(e,t),this._payPalSdkHelper=n,this._requestSender=i}execute({payment:e}){return St(this,void 0,void 0,(function*(){if(!(null==e?void 0:e.methodId))throw new xe(["payment"]);const t=this._paymentIntegrationService.getState(),n=t.getCartOrThrow().id,{initializationData:i}=t.getPaymentMethodOrThrow(this._getMethodId()),{orderId:o}=yield this.getOrderId(n),{card_information:a}=i||{},r=yield this._googlePayPaymentProcessor.getNonce(e.methodId),s={tokenizationData:{type:"PAYMENT_GATEWAY",token:atob(r)},info:{cardNetwork:(null==a?void 0:a.type)||"",cardDetails:(null==a?void 0:a.number)||""},type:"CARD"};yield this.confirmOrder(o,s),yield this._paymentIntegrationService.submitOrder();try{const t={formattedPayload:{method_id:e.methodId,paypal_account:{order_id:o}}};yield this._paymentIntegrationService.submitPayment({methodId:e.methodId,paymentData:t})}catch(e){yield this._googlePayPaymentProcessor.processAdditionalAction(e)}}))}confirmOrder(e,t){return St(this,void 0,void 0,(function*(){const n=this._paymentIntegrationService.getState(),i=n.getPaymentMethodOrThrow(this._getMethodId());if(!i.initializationData)throw new z(D.MissingPaymentMethod);const o=n.getCartOrThrow().currency.code,a=yield this._payPalSdkHelper.getPayPalGooglePaySdk(i,o,!0),{status:r}=yield a.Googlepay().confirmOrder({orderId:e,paymentMethodData:t});if(r===bt.PayerActionRequired)return yield a.Googlepay().initiatePayerAction({orderId:e}),Promise.resolve();if(r!==bt.Approved)throw new j("Payment is not approved.");return Promise.resolve()}))}getOrderId(e){return St(this,void 0,void 0,(function*(){const t={cartId:e,shouldSaveInstrument:!1},{body:n}=yield this._requestSender.post("/api/storefront/payments/googlepay_bigcommerce_paymentscheckout",{headers:Object.assign({"X-API-INTERNAL":mt,"Content-Type":Te.Json},he),body:t});return n}))}}const Ot=B((e=>{const t=new Ce((0,a.vQ)());return new It(e,new ge(me(),new Ie(e,t),(0,o.createRequestSender)(),(0,i.createFormPoster)()),t,(0,o.createRequestSender)())}),[{id:"googlepay_bigcommerce_payments"}]),kt=B((e=>new it(e,new ge(me(),new We(e,(0,i.createFormPoster)()),(0,o.createRequestSender)(),(0,i.createFormPoster)()))),[{id:"googlepaytdonlinemart"}]);class At extends y{constructor(e){super(e||"Not implemented."),this.name="NotImplementedError",this.type="not_implemented"}}var Tt=function(e,t,n,i){return new(n||(n=Promise))((function(o,a){function r(e){try{c(i.next(e))}catch(e){a(e)}}function s(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,s)}c((i=i.apply(e,t||[])).next())}))};class Et{constructor(e,t){this._paymentIntegrationService=e,this._googlePayPaymentProcessor=t}initialize(e){var t;return Tt(this,void 0,void 0,(function*(){if(!(null==e?void 0:e.methodId)||!de(e.methodId))throw new j('Unable to proceed because "methodId" is not a valid key.');this._methodId=e.methodId;const n=e[this._getMethodId()];if(!n)throw new j("Unable to proceed without valid options.");let i,o=this._paymentIntegrationService.getState();try{i=o.getPaymentMethodOrThrow(this._getMethodId())}catch(e){o=yield this._paymentIntegrationService.loadPaymentMethod(this._getMethodId()),i=o.getPaymentMethodOrThrow(this._getMethodId())}try{yield this._googlePayPaymentProcessor.initialize((()=>i),this._getGooglePayClientOptions(null===(t=i.initializationData)||void 0===t?void 0:t.storeCountry))}catch(e){return}this._addPaymentButton(n)}))}signIn(){return Promise.reject(new At('In order to sign in via Google Pay, the shopper must click on "Google Pay" button.'))}signOut(){var e;return Tt(this,void 0,void 0,(function*(){const t=null===(e=this._paymentIntegrationService.getState().getPaymentId())||void 0===e?void 0:e.providerId;t&&(yield this._googlePayPaymentProcessor.signOut(t))}))}executePaymentMethodCheckout(e){var t;return null===(t=null==e?void 0:e.continueWithCheckoutCallback)||void 0===t||t.call(e),Promise.resolve()}deinitialize(){var e;return null===(e=this._paymentButton)||void 0===e||e.remove(),this._paymentButton=void 0,this._methodId=void 0,Promise.resolve()}_getGooglePayClientOptions(e){return{paymentDataCallbacks:{onPaymentDataChanged:({callbackTrigger:t,shippingAddress:n,shippingOptionData:i,offerData:o})=>Tt(this,void 0,void 0,(function*(){const{availableTriggers:a,addressChangeTriggers:r,shippingOptionsChangeTriggers:s,offerChangeTriggers:c}=this._googlePayPaymentProcessor.getCallbackTriggers();if(!a.includes(t))return;const d=r.includes(t)?yield this._googlePayPaymentProcessor.handleShippingAddressChange(n):void 0;s.includes(t)&&(yield this._googlePayPaymentProcessor.handleShippingOptionChange(i.id));const{newOfferInfo:l,error:u}=c.includes(t)?yield this._googlePayPaymentProcessor.handleCoupons(o):{},h=u;yield this._paymentIntegrationService.loadCheckout();const y=this._googlePayPaymentProcessor.getTotalPrice(),{code:g}=this._paymentIntegrationService.getState().getCartOrThrow().currency;return Object.assign(Object.assign(Object.assign({newTransactionInfo:Object.assign(Object.assign({},e&&{countryCode:e}),{currencyCode:g,totalPriceStatus:Q.FINAL,totalPrice:y})},d&&{newShippingOptionParameters:d}),l&&{newOfferInfo:l}),h&&{error:h})}))}}}_addPaymentButton({container:e,buttonColor:t,buttonType:n,onClick:i,onError:o}){var a;this._paymentButton=null!==(a=this._paymentButton)&&void 0!==a?a:this._googlePayPaymentProcessor.addPaymentButton(e,{buttonColor:null!=t?t:"default",buttonType:null!=n?n:"plain",onClick:this._handleClick(o,i)})}_handleClick(e,t){return n=>Tt(this,void 0,void 0,(function*(){n.preventDefault(),t&&"function"==typeof t&&t();try{yield this._googlePayPaymentProcessor.initializeWidget(),yield this._interactWithPaymentSheet()}catch(t){let n=t;if(ce(t)){if("CANCELED"===t.statusCode)throw new ae;n=new re(JSON.stringify(t))}throw null==e||e(new re("An error occurred while requesting your Google Pay payment details.")),n}}))}_interactWithPaymentSheet(){return Tt(this,void 0,void 0,(function*(){const e=yield this._googlePayPaymentProcessor.showPaymentSheet(),t=this._googlePayPaymentProcessor.mapToBillingAddressRequestBody(e),n=this._googlePayPaymentProcessor.mapToShippingAddressRequestBody(e),i="/embedded-checkout"===window.location.pathname?this._paymentIntegrationService.getState().getStoreConfigOrThrow().links.siteLink:void 0;t&&(yield this._paymentIntegrationService.updateBillingAddress(t)),n&&(yield this._paymentIntegrationService.updateShippingAddress(n)),yield this._googlePayPaymentProcessor.setExternalCheckoutForm(this._getMethodId(),e,i)}))}_getMethodId(){return V(this._methodId,(()=>new S(p.PaymentNotInitialized)))}}const Mt=B((e=>{const t=(0,o.createRequestSender)();return new Et(e,new ge(me(),new ne("adyen",e),t,(0,i.createFormPoster)()))}),[{id:"googlepayadyenv2"}]),Dt=B((e=>{const t=(0,o.createRequestSender)();return new Et(e,new ge(me(),new ne("adyen",e),t,(0,i.createFormPoster)()))}),[{id:"googlepayadyenv3"}]),Nt=B((e=>new Et(e,new ge(me(),new Oe(e),(0,o.createRequestSender)(),(0,i.createFormPoster)()))),[{id:"googlepayauthorizenet"}]),Rt=B((e=>{const t=(0,o.createRequestSender)();return new Et(e,new ge(me(),new De(e,t),t,(0,i.createFormPoster)()))}),[{id:"googlepaycheckoutcom"}]),xt=B((e=>new Et(e,new ge(me(),new Ne(e),(0,o.createRequestSender)(),(0,i.createFormPoster)()))),[{id:"googlepaycybersourcev2"}]),Bt=B((e=>new Et(e,new ge(me(),new Ne(e),(0,o.createRequestSender)(),(0,i.createFormPoster)()))),[{id:"googlepaybnz"}]),zt=B((e=>new Et(e,new ge(me(),new Re(e),(0,o.createRequestSender)(),(0,i.createFormPoster)()))),[{id:"googlepayorbital"}]),jt=B((e=>new Et(e,new ge(me(),new Fe(e,new qe((0,a.vQ)())),(0,o.createRequestSender)(),(0,i.createFormPoster)()))),[{id:"googlepaystripe"},{id:"googlepaystripeocs"}]),Gt=B((e=>new Et(e,new ge(me(),new Fe(e,new qe((0,a.vQ)())),(0,o.createRequestSender)(),(0,i.createFormPoster)()))),[{id:"googlepaystripeupe"}]),Ft=B((e=>new Et(e,new ge(me(),new Ue(e),(0,o.createRequestSender)(),(0,i.createFormPoster)()))),[{id:"googlepayworldpayaccess"}]),Lt=B((e=>{const t=(0,o.createRequestSender)(),n=window,r=new h(e),s=new T(new x((0,a.vQ)(),n,r));return new Et(e,new ge(me(),new oe(e,s),t,(0,i.createFormPoster)()))}),[{id:"googlepaybraintree"}]),qt=B((e=>new Et(e,new ge(me(),new _e(e,new we((0,a.vQ)())),(0,o.createRequestSender)(),(0,i.createFormPoster)()))),[{id:"googlepaypaypalcommerce"}]),Ut=B((e=>new Et(e,new ge(me(),new Ie(e,new Ce((0,a.vQ)())),(0,o.createRequestSender)(),(0,i.createFormPoster)()))),[{id:"googlepay_bigcommerce_payments"}]),Vt=B((e=>new Et(e,new ge(me(),new We(e,(0,i.createFormPoster)()),(0,o.createRequestSender)(),(0,i.createFormPoster)()))),[{id:"googlepaytdonlinemart"}]);var Ht=n(70355),Wt=n(63582);var Yt=n(25657);class Jt extends Yt.A{constructor(e){var t,n;super({name:"EMBEDDED_CHECKOUT_UNSUPPORTED_ERROR",message:e}),t=this,n=Jt.prototype,Object.setPrototypeOf?Object.setPrototypeOf(t,n):function(e){return"__proto__"in e}(t)&&(t.__proto__=n)}}var Qt=n(19285);const Kt=(0,Qt.A)((e=>{const{language:t,onUnhandledError:n}=e;if(function(e=document.location.pathname){return"/embedded-checkout"==`/${e.split("/")[1]}`}())return n(new Jt(t.translate("embedded_checkout.unsupported_error",{methods:"googlepay"}))),null;const i=[Mt,Dt,Nt,Rt,xt,Bt,zt,jt,Gt,Ft,Lt,qt,Ut,Vt];return Ht.createElement(Wt.A,Object.assign({checkoutButtonContainerClass:"google-pay-top-button",integrations:i},e))}),[{id:"googlepayadyenv2"},{id:"googlepayadyenv3"},{id:"googlepayauthorizenet"},{id:"googlepaybnz"},{id:"googlepaybraintree"},{id:"googlepaypaypalcommerce"},{id:"googlepaycheckoutcom"},{id:"googlepaycybersourcev2"},{id:"googlepayorbital"},{id:"googlepaystripe"},{id:"googlepaystripeupe"},{id:"googlepayworldpayaccess"},{id:"googlepaytdonlinemart"},{id:"googlepaystripeocs"}]);var Zt=n(31635),Xt=n(28058),$t=n(97802);const en=(0,Qt.A)((e=>{var{checkoutService:t,method:n,onUnhandledError:i}=e,o=(0,Zt.__rest)(e,["checkoutService","method","onUnhandledError"]);const a=(0,Ht.useCallback)((e=>{const o=e=>(0,Zt.__awaiter)(void 0,void 0,void 0,(function*(){try{yield t.deinitializePayment({gatewayId:n.gateway,methodId:n.id}),yield t.initializePayment(Object.assign(Object.assign({},e),{gatewayId:n.gateway,methodId:n.id}))}catch(e){e instanceof Error&&i(e)}})),a="checkout-app",r=Object.assign(Object.assign({},e),{integrations:[ot,ct,dt,lt,ut,ht,yt,gt,pt,_t,Ot,kt],[Xt.A.AdyenV2GooglePay]:{loadingContainerId:a,walletButton:"walletButton",onError:i,onPaymentSelect:()=>o(r)},[Xt.A.AdyenV3GooglePay]:{loadingContainerId:a,walletButton:"walletButton",onError:i,onPaymentSelect:()=>o(r)},[Xt.A.AuthorizeNetGooglePay]:{loadingContainerId:a,walletButton:"walletButton",onError:i,onPaymentSelect:()=>o(r)},[Xt.A.BNZGooglePay]:{loadingContainerId:a,walletButton:"walletButton",onError:i,onPaymentSelect:()=>o(r)},[Xt.A.BigCommercePaymentsGooglePay]:{loadingContainerId:a,walletButton:"walletButton",onError:i,onPaymentSelect:()=>o(r)},[Xt.A.BraintreeGooglePay]:{loadingContainerId:a,walletButton:"walletButton",onError:i,onPaymentSelect:()=>o(r)},[Xt.A.PayPalCommerceGooglePay]:{loadingContainerId:a,walletButton:"walletButton",onError:i,onPaymentSelect:()=>o(r)},[Xt.A.StripeGooglePay]:{loadingContainerId:a,walletButton:"walletButton",onError:i,onPaymentSelect:()=>o(r)},[Xt.A.StripeUPEGooglePay]:{loadingContainerId:a,walletButton:"walletButton",onError:i,onPaymentSelect:()=>o(r)},[Xt.A.CybersourceV2GooglePay]:{loadingContainerId:a,walletButton:"walletButton",onError:i,onPaymentSelect:()=>o(r)},[Xt.A.OrbitalGooglePay]:{loadingContainerId:a,walletButton:"walletButton",onError:i,onPaymentSelect:()=>o(r)},[Xt.A.CheckoutcomGooglePay]:{loadingContainerId:a,walletButton:"walletButton",onError:i,onPaymentSelect:()=>o(r)},[Xt.A.WorldpayAccessGooglePay]:{loadingContainerId:a,walletButton:"walletButton",onError:i,onPaymentSelect:()=>o(r)},[Xt.A.TdOnlineMartGooglePay]:{loadingContainerId:a,walletButton:"walletButton",onError:i,onPaymentSelect:()=>o(r)},[Xt.A.StripeOCSGooglePay]:{loadingContainerId:a,walletButton:"walletButton",onError:i,onPaymentSelect:()=>o(r)}});return t.initializePayment(r)}),[t,n,i]);return Ht.createElement($t.A,Object.assign({},o,{buttonId:"walletButton",deinitializePayment:t.deinitializePayment,initializePayment:a,method:n,shouldShowEditButton:!0,signOutCustomer:t.signOutCustomer}))}),[{id:Xt.A.AdyenV2GooglePay},{id:Xt.A.AdyenV3GooglePay},{id:Xt.A.AuthorizeNetGooglePay},{id:Xt.A.BNZGooglePay},{id:Xt.A.BraintreeGooglePay},{id:Xt.A.PayPalCommerceGooglePay},{id:Xt.A.BigCommercePaymentsGooglePay},{id:Xt.A.CheckoutcomGooglePay},{id:Xt.A.CybersourceV2GooglePay},{id:Xt.A.OrbitalGooglePay},{id:Xt.A.StripeGooglePay},{id:Xt.A.StripeUPEGooglePay},{id:Xt.A.WorldpayAccessGooglePay},{id:Xt.A.TdOnlineMartGooglePay},{id:Xt.A.StripeOCSGooglePay}])},19285:(e,t,n)=>{n.d(t,{A:()=>o});var i=n(70355);function o(e,t){return Object.assign((t=>i.createElement(e,Object.assign({},t))),{resolveIds:t})}},25657:(e,t,n)=>{n.d(t,{A:()=>i});class i extends Error{constructor({data:e={},message:t="",title:n="",name:o=""}){super(),"function"==typeof Error.captureStackTrace?Error.captureStackTrace(this,i):this.stack=(new Error).stack,this.data=e,this.message=t,this.name=o,this.title=n,this.type="custom"}}},63582:(e,t,n)=>{n.d(t,{A:()=>a});var i=n(31635),o=n(70355);const a=(0,n(19285).A)((({checkoutService:{deinitializeCustomer:e,initializeCustomer:t},checkoutButtonContainerClass:n,containerId:a,methodId:r,onUnhandledError:s,onWalletButtonClick:c,additionalInitializationOptions:d,integrations:l})=>((0,o.useEffect)((()=>((0,i.__awaiter)(void 0,void 0,void 0,(function*(){try{yield t({methodId:r,integrations:l,[r]:Object.assign({container:a,onUnhandledError:s,onClick:()=>c(r)},d)})}catch(e){"function"==typeof s&&e instanceof Error&&s(e)}})),()=>{(0,i.__awaiter)(void 0,void 0,void 0,(function*(){try{yield e({methodId:r})}catch(e){"function"==typeof s&&e instanceof Error&&s(e)}}))})),[]),o.createElement("div",{className:n,"data-test":a,id:a}))),[])},97802:(e,t,n)=>{n.d(t,{A:()=>_});var i=n(31635),o=n(69440),a=n(70355),r=n(39981),s=n(91182),c=n(22437);const d=(e="",t="****")=>e.includes("*")?e:`${t} ${e}`,l=e=>{if((e=>{if("object"==typeof e&&null!==e){if("card_information"in e&&"object"==typeof e.card_information&&null!==e.card_information&&"number"in e.card_information&&"type"in e.card_information)return!0;if("cardData"in e&&"object"==typeof e.cardData&&null!==e.cardData&&"accountMask"in e.cardData&&"cardType"in e.cardData&&"expMonth"in e.cardData&&"expYear"in e.cardData)return!0;if("accountNum"in e&&"accountMask"in e&&"expDate"in e)return!0}return!1})(e)){if(e.card_information)return{accountMask:d(e.card_information.number),cardType:e.card_information.type};if(e.cardData)return{accountMask:d(e.cardData.accountMask),cardType:e.cardData.cardType,expiryMonth:e.cardData.expMonth,expiryYear:e.cardData.expYear};if(e.accountNum){const{card:t}=(0,c.number)(e.accountNum);return{accountMask:d(e.accountMask),expiryMonth:e.expDate&&e.expDate.substr(0,2),expiryYear:e.expDate&&e.expDate.substr(2,2),cardType:t?t.niceType:""}}}};var u,h=n(72769),y=n(76049),g=n(49655),p=n(28058);!function(e){e.ApplePay="applepay",e.Barclaycard="barclaycard",e.CreditCard="credit-card",e.GooglePay="googlepay",e.PayWithGoogle="paywithgoogle",e.Masterpass="masterpass",e.MultiOption="multi-option",e.Paypal="paypal",e.PaypalCredit="paypal-credit",e.PaypalVenmo="paypal-venmo",e.VisaCheckout="visa-checkout"}(u||(u={}));const m=u;function f(e){return t=>{let n=function(e){return t=>{const n={[p.A.Affirm]:e.translate("payment.affirm_name_text"),[p.A.Afterpay]:e.translate("payment.afterpay_name_text"),[p.A.AmazonPay]:e.translate("payment.amazon_name_text"),[p.A.Bolt]:e.translate("payment.bolt_name_text"),[p.A.Clearpay]:e.translate("payment.clearpay_name_text"),[m.GooglePay]:e.translate("payment.google_pay_name_text"),[p.A.Klarna]:e.translate("payment.klarna_name_text"),[m.Paypal]:e.translate("payment.paypal_name_text"),[m.PaypalCredit]:e.translate("payment.paypal_credit_name_text"),[m.VisaCheckout]:e.translate("payment.vco_name_text")};return n[t.id]||n[t.method]}}(e)(t);return n&&t.method!==m.MultiOption||(n=t.config.displayName),n||(n=(0,o.capitalize)((0,o.get)(t,"initializationData.paymentData.cardData.digital_wallet_type")||t.method||t.id)),n}}const w=({method:e,onSignOut:t})=>{const{language:n}=(0,y.Y)();return a.createElement("div",{className:"signout-link"},a.createElement(g.A,{id:"remote.sign_out_before_action"})," ",a.createElement("a",{href:"#",onClick:(0,h.A)(t)},a.createElement(g.A,{data:{providerName:f(n)(e)},id:"remote.sign_out_action"}))," ",a.createElement(g.A,{id:"remote.sign_out_after_action"}))},P=({accountMask:e,cardName:t,cardType:n,expiryMonth:i,expiryYear:o,shouldShowEditButton:r,editButtonClassName:s,editButtonLabel:c,buttonId:d,method:l,onSignOut:u})=>a.createElement(a.Fragment,null,!!t&&a.createElement("p",{"data-test":"payment-method-wallet-card-name"},a.createElement("strong",null,a.createElement(g.A,{id:"payment.credit_card_name_label"}),":")," ",t),!!e&&!!n&&a.createElement("p",{"data-test":"payment-method-wallet-card-type"},a.createElement("strong",null,`${n}:`)," ",e),!!i&&!!o&&a.createElement("p",{"data-test":"payment-method-wallet-card-expiry"},a.createElement("strong",null,a.createElement(g.A,{id:"payment.credit_card_expiration_date_label"}),":")," ",`${i}/${o}`),!!r&&a.createElement("p",null,a.createElement("a",{className:s,href:"#",id:d,onClick:(0,h.A)()},c||a.createElement(g.A,{id:"remote.select_different_card_action"}))),a.createElement(w,{method:l,onSignOut:u})),v=({buttonId:e,method:t,signInButtonClassName:n,signInButtonLabel:i})=>{const{language:o}=(0,y.Y)();return a.createElement("a",{className:n,href:"#",id:e,onClick:(0,h.A)()},i||a.createElement(g.A,{data:{providerName:f(o)(t)},id:"remote.sign_in_action"}))},_=({paymentForm:e,buttonId:t,editButtonClassName:n,editButtonLabel:c,isInitializing:d=!1,method:u,shouldShowEditButton:h,signInButtonClassName:y,signInButtonLabel:g,signOutCustomer:p,deinitializePayment:m,initializePayment:f,onSignOut:w=o.noop,onSignOutError:_=o.noop,onUnhandledError:b=o.noop})=>{const{checkoutState:{data:{getBillingAddress:C,getCheckout:S,isPaymentDataRequired:I}}}=(0,r.Q)(),O=C(),k=S();if(!O||!k)throw new Error("Unable to get checkout");const A=l(u.initializationData),T=(0,o.some)(k.payments,{providerId:u.id}),E=A&&[O.firstName,O.lastName].join(" "),M=()=>{const{disableSubmit:t}=e,n=I();l(u.initializationData)||!n?t(u,!1):t(u,!0)},D=(0,a.useCallback)((()=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){try{yield p({methodId:u.id}),w(),window.location.reload()}catch(e){_(e)}}))),[p,u.id,w,_]);return(0,a.useEffect)((()=>((0,i.__awaiter)(void 0,void 0,void 0,(function*(){M();try{yield f({gatewayId:u.gateway,methodId:u.id})}catch(e){b(e)}})),()=>{(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{disableSubmit:t}=e;t(u,!1);try{yield m({gatewayId:u.gateway,methodId:u.id})}catch(e){b(e)}}))})),[]),(0,a.useEffect)((()=>{M()})),a.createElement(s.A,{hideContentWhenLoading:!0,isLoading:d},a.createElement("div",{className:"paymentMethod paymentMethod--walletButton"},T?a.createElement(P,Object.assign({},A,{buttonId:t,cardName:E,editButtonClassName:n,editButtonLabel:c,method:u,onSignOut:D,shouldShowEditButton:h})):a.createElement(v,{buttonId:t,method:u,signInButtonClassName:y,signInButtonLabel:g})))}}}]);
//# sourceMappingURL=4576-7110806c.js.map